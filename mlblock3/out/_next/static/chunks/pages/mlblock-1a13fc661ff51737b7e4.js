(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{13212:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return L}});var s=i(30266),n=i(809),a=i.n(n),r=i(10914),o=i(5152),h=i(67294),l=i(99401),u=i(85893),p=(0,o.default)((function(){return i.e(257).then(i.t.bind(i,34210,23))}),{loading:function(){return(0,u.jsx)(u.Fragment,{children:"Loading"})},ssr:!1,loadableGenerated:{webpack:function(){return[34210]},modules:["../components/Sketch.tsx -> react-p5"]}}),c=function(t){(0,h.useEffect)((function(){(0,s.Z)(a().mark((function t(){var e,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([i.e(391),i.e(784)]).then(i.t.bind(i,55391,23));case 2:return e=t.sent.default,t.next=5,i.e(727).then(i.t.bind(i,42778,23));case 5:s=t.sent.default,console.log(e,s);case 7:case"end":return t.stop()}}),t)})))(),console.log("didMount"),document.oncontextmenu=function(){return!1}}),[]);var e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{id:"p5-content",className:"fileContainer"}),(0,u.jsx)(p,{setup:function(t,i){var s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,n=t;n.scaleFunc=function(t){console.log("scaleFunc",t),t.scale},n.postSetup=function(){console.log("(post) setup...."),n.container=n.select("#p5-content"),n.container.style("height","100%"),n.container.style("width","100%"),n.canvas=n.createCanvas(n.windowWidth,n.windowHeight),n.canvas.parent("p5-content")},n.drawScreen=function(){n.background(204)},n.windowResized=function(){n.resizeCanvas(n.windowWidth,n.windowHeight),n.resetMatrix(),n.drawScreen(),e.windowResized()},n.touchStarted=function(t){t.preventDefault(),t.stopImmediatePropagation(),2==t.touches.length?(n.mouseX=(t.touches[0].clientX+t.touches[1].clientX)/2,n.mouseY=(t.touches[0].clientY+t.touches[1].clientY)/2,e.touchStartScale(t.scale)):e.mousePressed()},n.touchMoved=function(t){console.log(t),2==t.touches.length?(n.mouseX=(t.touches[0].clientX+t.touches[1].clientX)/2,n.mouseY=(t.touches[0].clientY+t.touches[1].clientY)/2,e.touchScale(t.scale)):e.mouseDragged()},n.touchEnded=function(){e.mouseReleased()},n.mouseMoved=function(){e.mouseMoved()},n.mousePressed=function(){s.test(navigator.userAgent)||e.mousePressed()},n.mouseReleased=function(){s.test(navigator.userAgent)||e.mouseReleased()},n.mouseWheel=function(t){e.mouseWheel(t)},n.mouseDragged=function(){s.test(navigator.userAgent)||e.mouseDragged()},n.keyPressed=function(t){e.keyPressed(t)},n.canvas=n.createCanvas(n.windowWidth,n.windowHeight),n.canvas.parent("p5-content"),console.log("Set MLX...."),e.setup(),e.mainCanvas=n.canvas},draw:function(t){e.process(),e.update(),e.draw()},preload:function(t){var i=t;(e=new l.MLX(i)).myFont=i.loadFont("assets/fonts/Kanit-Regular.ttf"),console.log(">>",e.myFont),e.imgChecked=i.loadImage("assets/check.png"),e.imgCheckedBox=i.loadImage("assets/checkbox.png"),e.imgUncheckedBox=i.loadImage("assets/uncheck.png"),e.imgDropdown=i.loadImage("assets/dropdown.png"),e.imgPlay=i.loadImage("assets/play.png"),console.log("preload....",t)},mousePressed:function(t){console.log("mouse"),e.mousePressed()}})]})};new(i(30950)._k)({supportedChainIds:[56,97]});function m(t,e){return t.getSigner(e).connectUnchecked()}var d=i(2804),g=i(13911),v=i(52503),f=i(92809),x=i(97501),y=i.n(x);function E(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?E(Object(i),!0).forEach((function(e){(0,f.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var w=function(){var t=(0,s.Z)(a().mark((function t(e){var i,s,n,r,o,h=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=h.length>1&&void 0!==h[1]?h[1]:{},S(i),s=_({},i),n=k(s),"function"!==typeof e){t.next=10;break}return t.next=7,e(n);case 7:r=t.sent,t.next=11;break;case 10:throw new Error('"signer" argument should be a function that returns a signature eg: "msg => web3.eth.personal.sign(msg, <YOUR_ADDRESS>)"');case 11:if("string"===typeof r){t.next=13;break}throw new Error('"signer" argument should be a function that returns a signature string (Promise<string>)');case 13:return o=y().encode(JSON.stringify({signature:r,body:n})),t.abrupt("return",o);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=function(t){for(var e in t){var i=t[e];if("Expire-Date"===e)throw new Error('Please do not rewrite "Expire-Date" field');if("Web3-Token-Version"===e)throw new Error('Please do not rewrite "Web3-Token-Version" field');if("string"!==typeof i)throw new Error("Body can only contain string values")}},k=function(t){var e=[];for(var i in t)e.push("".concat(i,": ").concat(t[i]));return e.join("\n")},b=i(22751),C=i(4947),T=i.n(C),I=i(20758),M=i.n(I),R={sign:w,verify:function(t){if(!t||!t.length)throw new Error("Token required.");try{var e=y().decode(t)}catch(m){throw new Error("Token malformed (must be base64 encoded)")}if(!e||!e.length)throw new Error("Token malformed (must be base64 encoded)");try{var i=JSON.parse(e),s=i.body,n=i.signature}catch(m){throw new Error("Token malformed (unparsable JSON)")}if(!s||!s.length)throw new Error("Token malformed (empty message)");if(!n||!n.length)throw new Error("Token malformed (empty signature)");var a=b.toBuffer("0x"+M()(s)),r=b.hashPersonalMessage(a),o=b.toBuffer(n),h=b.fromRpcSig(o),l=b.ecrecover(r,h.v,h.r,h.s),u=b.publicToAddress(l),p=b.bufferToHex(u),c=T()(s);if(c["expire-date"]&&new Date(c["expire-date"])<new Date)throw new Error("Token expired");return{address:p.toLowerCase(),body:c}}},P=function(t){return fetch(t).then((function(t){return t.json()}))},L=function(){var t,e=(0,v.ZP)("/api/users",P),i=(e.data,e.error,(0,r.Ge)().library),n=(0,d.useRecoilValue)(g.S),o=n.chainId,l=n.account;return(0,h.useEffect)((function(){console.log("account",l,o),console.log("library",i)}),[l,o,i]),(0,h.useEffect)((function(){i&&(t=m(i,l),(0,s.Z)(a().mark((function e(){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.sign(function(){var e=(0,s.Z)(a().mark((function e(i){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.signMessage(i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{text:"Hello World"});case 2:i=e.sent,console.log("token :>",i);case 4:case"end":return e.stop()}}),e)})))()),console.log(">> signer",t,i)}),[t,i]),(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(c,{})})}},98143:function(t){t.exports="\n\nfrom Maix import GPIO, I2S,  FFT\nimport image, lcd, math ,sensor\nfrom fpioa_manager import fm\nimport KPU as kpu\nimport time\nfrom machine import Timer\nfrom Maix import GPIO\nfrom fpioa_manager import fm\nfrom board import board_info\nimport ulab as np\nfrom machine import UART\nrepl = UART.repl_uart()\n\nsensor.reset()\nsensor.set_pixformat(sensor.RGB565)\nsensor.set_framesize(sensor.QVGA)\nsensor.set_windowing((192,192))\nsensor.skip_frames(time = 2000)\n\nimg = image.Image(size=(128,128))\nsample_rate = 5000\nsample_points = 1024\nfft_points = 512\nhist_x_num = 128\n\nfm.register(13,fm.fpioa.I2S0_IN_D0)\nfm.register(14,fm.fpioa.I2S0_WS)\nfm.register(15,fm.fpioa.I2S0_SCLK)\n\nrx = I2S(I2S.DEVICE_0)\nrx.channel_config(rx.CHANNEL_0, rx.RECEIVER, align_mode = I2S.STANDARD_MODE)\nrx.set_sample_rate(sample_rate)\n\nimgc = img\nmax_index_b = 0\nmax_index_b_b = 0\ndef on_timer(timer):\n    global imgc\n    global max_index_b\n    global max_index_b_b\n    tong1 = time.ticks()\n    imgc = img.to_rainbow(1)\n    lcd.display(imgc)\n    imgxc = sensor.snapshot()\n    imgc = imgc.resize(192,192)\n    imgxc.draw_image(imgc, 0,0)\n    del imgc\n\ndef hsv_to_rgb(h, s, v):\n    if s == 0.0:\n        return int(v), int(v), int(v)\n    i = int(h*6.0) # XXX assume int() truncates!\n    f = (h*6.0) - i\n    p = v*(1.0 - s)\n    q = v*(1.0 - s*f)\n    t = v*(1.0 - s*(1.0-f))\n    i = i%6\n    if i == 0:\n        return int(v), int(t), int(p)\n    if i == 1:\n        return int(q), int(v), int(p)\n    if i == 2:\n        return int(p), int(v), int(t)\n    if i == 3:\n        return int(p), int(q), int(v)\n    if i == 4:\n        return int(t), int(p), int(v)\n    if i == 5:\n        return int(v), int(p), int(q)\n\n\ntim = Timer(Timer.TIMER0, Timer.CHANNEL0, mode=Timer.MODE_PERIODIC, period=300, unit=Timer.UNIT_MS, callback=on_timer, arg=on_timer, start=False, priority=1, div=0)\n\nlcd.init()\nlcd.rotation(2)\n\n#tim.start()\n\ndata_b = 0\nh_hoe = 10000\ncodex_b= 0\nfft_amp_b = None\n#print(\"Hello\")\nwhile True:\n    audio = rx.record(sample_points)\n    fft_res = FFT.run(audio.to_bytes(),fft_points)\n    fft_amp = FFT.amplitude(fft_res)\n    codex = np.array(fft_amp)\n    data = np.sum(codex * codex, axis=1)\n    # if data < h_hoe and data_b > h_hoe :\n    data_b  = data\n    codex_b = codex\n    fft_amp_b = bytearray(fft_amp)\n    repl.write(b'Vx'+fft_amp_b)\n    #lcd.display(img)\n    #for i in range(0,fft_points):\n         #c = fft_amp[i]*5;\n         #ttt = hsv_to_rgb(int(c),255,int(c))\n         #progressPercent = i / fft_points;\n         #y = progressPercent * 128;\n         #a = img.draw_rectangle(0,128-int(y),1,1,ttt,1,True)\n\n\n    for i in range(0,fft_points):\n         c = fft_amp[i]*5;\n         ttt = hsv_to_rgb(int(c),255,int(c))\n        #  print(ttt)\n         progressPercent = i / fft_points;\n         y = progressPercent * 128;\n         a = img.draw_rectangle(0,128-int(y),1,1,ttt,1,True)\n         #print(c,y)\n        #ctx.rect(ctx.width - speed, ctx.height - y, speed, ctx.height / spectrum.length);\n    img_tmp = img.cut(0,0,127,128)\n    #img_tmp.copy(img, 0, 0, 128, 128, -1, 0, 128, 128);\n    img.draw_image(img_tmp, 1,0)\n    lcd.display(img)\n\n    fft_amp.clear()\n    time.sleep(0.016)\n\n"},99401:function(t,e,i){var s=i(2553),n=i(62012),a=i(77945),r=a.mlxVideoCapture,o=a.mlxDrawCanvas,h=a.mlxMouseInput,l=a.mlxImage,u=a.mlxVideoPixels,p=a.mlxCSVFileInput,c=i(81502).mlxRTCVideo,m=i(46120),d=m.mlxElement,g=(m.mlxElementInput,m.mlxElementModel,m.mlxElementOutput,m.mlxElementLocakableOutput,m.mlxLabel),v=m.mlxOscillator,f=m.mlxConsoleLog,x=m.mlxSpeech,y=m.mlxAudioInput,E=m.mlxSoundAmplitude,_=m.mlxFFTSpectrum,w=m.mlxSpectrogram,S=m.mlxNatsSoundTensor,k=m.mlxTextInput,b=i(95592).mlxElementSoundViz,C=i(37905),T=(C.mlxImageClassifier,C.mlxMobileNet),I=C.mlxSoundCommand18w,M=C.mlxDoodleNet,R=C.mlxPoseNet,P=C.mlxHandPose,L=C.mlxFaceAPI,N=C.mlxYolo,D=C.mlxUNET,W=C.mlxParticle,B=i(56856).mlxCorgiDudeAudio,A=i(29719),H=(A.mlxFeatureExtractor,A.mlxMobileNetFeatureExtractor),O=A.mlxMobileNetClassifier,z=A.mlxMobileNetRegressor,F=i(34488),V=F.mlxKNNClassifier,X=F.mlxConfusionMatrix,Y=i(628),G=Y.mlxLicensePlateDetector,Z=Y.mlxFaceMaskDetector,U=Y.mlxCorgiDudeCamera2,j=Y.mlxCorgiDudeMobileNetClassifier,J=Y.mlxCorgiDudeMobileNetRegressor,K=Y.mlxCorgiDudeIDE,q=Y.mlxCorgiDudeMobileNet,Q=i(86050),tt=Q.mlxMQTT,et=Q.mlxNETPIE2020,it=Q.mlxBlynk,st=Q.mlxSerialPort,nt=i(87501),at=nt.mlxFlowFilter,rt=nt.mlxFlowMerge,ot=nt.mlxJSEditor,ht=i(88062),lt=(ht.mlxNeuralNetwork,ht.mlxNeuralNetworkClassifier),ut=ht.mlxNeuralNetworkRegressor,pt=i(75184).mlxQuickDraw,ct=i(12783),mt=ct.mlxGamePad,dt=ct.mlxSnakeGame,gt=ct.mlxPongGame,vt=ct.mlxBreakoutGame,ft=i(8896).mlxScaventureHunt,xt=i(45699).mlxJungleJumper,yt=i(41911).mlxSortingFactory,Et=i(57868).mlxNoseArtist,_t=i(35946).mlxNoseArtistMobile,wt=i(68768).mlxMaskGame,St=i(60369).mlxBubbleTeaGame,kt=i(75537).mlxBoatParking,bt=i(20190).mlxCleanOceanGame,Ct=i(79226),Tt=Ct.mlxUI_Init,It=(Ct.mlxUI,Ct.uiFrame),Mt=Ct.uiHorizontalSlider,Rt=Ct.uiVerticalSlider,Pt=Ct.uiTextInput,Lt=Ct.uiRadioBox,Nt=Ct.uiSelect,Dt=Ct.uiCommand,Wt=Ct.uiDropdown,Bt=(Ct.uiSubMenu,Ct.uiCheckedMenu),At=(Ct.uiSelectMenu,Ct.uiSeparator),Ht=(Ct.uiGapSeparator,Ct.uiMenu),Ot=Ct.uiLabel,zt=Ct.uiImage,Ft=Ct.uiCanvas,Vt=Ct.uiGraph,Xt=function(){"use strict";function t(e){s(this,t),this.p5=e,this.myFont=null,Tt(this,e),this.mlxCaptionHeight=24,this.mlxCornerSize=8,this.mlxPadding=10,this.mlxLinkSize=10,this.mlxNavBarHeight=e.select("#p5-content").elt.offsetTop,this.mlxElements=[],this.elMoving=null,this.elSizing=null,this.elDragging=null,this.elLinkMoving=null,this.elLinkTarget=null,this.popup=[],this.mainCanvas=null,this.currentProcess=null,this.startProcessIndex=0,this.fullScreenElement=null,this.maximizedElement=null,this.labelElement=null,this.focusedElement=null,this.userTranslateX=0,this.userTranslateY=0,this.userScaleX=0,this.userScaleY=0,this.userScale=1,this.panning=!1,this.pos=0,this.mouseX=0,this.mouseY=0,this.isMaximize=!1,this.registeredMlxElement=[{cmd:"Video Capture",className:r,type:"VideoCapture"},{cmd:"RTC Video Capture",className:c,type:"RTCVideo"},{cmd:"Image Segmentation (UNET)",className:D,type:"UNET"},{cmd:"Video Pixels",className:u,type:"VideoPixels"},{cmd:"Image",className:l,type:"Image"},{cmd:"Canvas",className:o,type:"DrawCanvas"},{cmd:"2D Coordinate",className:h,type:"2DCoord"},{cmd:"CSV File",className:p,type:"CSVFile"},{cmd:"Text Input",className:k,type:"TextInput"},{cmd:"MobileNet",className:T,type:"MobileNet"},{cmd:"DoodleNet",className:M,type:"DoodleNet"},{cmd:"PoseNet",className:R,type:"PoseNet"},{cmd:"Speech Command",className:I,type:"SpeechCommand"},{cmd:"FaceAPI",className:L,type:"FaceAPI"},{cmd:"HandPose",className:P,type:"HandPose"},{cmd:"YOLO",className:N,type:"YoLo"},{cmd:"Particle Generator",className:W,type:"Particle"},{cmd:"MobileNet Feature Extractor",className:H,type:"MobileNetFeatureExtractor"},{cmd:"MobileNet Classifier",className:O,type:"MobileNetClassifier"},{cmd:"MobileNet Regressor",className:z,type:"MobileNetRegressor"},{cmd:"KNN Classifier",className:V,type:"KNNClassifier"},{cmd:"Confusion Matrix",className:X,type:"ConfusionMatrix"},{cmd:"Neural Network (Classifier)",className:lt,type:"NeuralNetworkClassifier"},{cmd:"Neural Network (Regressor)",className:ut,type:"NeuralNetworkRegressor"},{cmd:"Label",className:g,type:"Label"},{cmd:"Speech",className:x,type:"Speech"},{cmd:"Oscillator",className:v,type:"Oscillator"},{cmd:"Snake Game",className:dt,type:"SnakeGame"},{cmd:"Doodle QuickDraw",className:pt,type:"DoodleQuickDraw"},{cmd:"Scaventure Hunt",className:ft,type:"ScaventureHunt"},{cmd:"Nose Artist",className:Et,type:"NoseArtistGame"},{cmd:"Nose Artist(Mobile)",className:_t,type:"NoseArtistMobileGame"},{cmd:"Mask(Mobile)",className:wt,type:"MaskGame"},{cmd:"Jungle Jumper",className:xt,type:"JungleJumperGame"},{cmd:"Sorting Factory",className:yt,type:"SortingFactoryGame"},{cmd:"Game Pad",className:mt,type:"GamePad"},{cmd:"Console Log",className:f,type:"ConsoleLog"},{cmd:"Sound Amplitude",className:E,type:"SoundAmplitude"},{cmd:"FFT Spectrum",className:_,type:"FFT"},{cmd:"Sound Viz",className:b,type:"FFT"},{cmd:"Spectrogram",className:w,type:"Spectrogram"},{cmd:"Nat's Sound Tensor",className:S,type:"NatsSoundTensor"},{cmd:"Audio Input",className:y,type:"Audio"},{cmd:"Pong Game",className:gt,type:"PongGame"},{cmd:"Breakout Game",className:vt,type:"BreakoutGame"},{cmd:"We Love BubbleTea",className:St,type:"BubbleTeaGame"},{cmd:"Boat Parking",className:kt,type:"BoatParkingGame"},{cmd:"Clean the Ocean",className:bt,type:"CleanTheOceanGame"},{cmd:"Face Mask Detection",className:Z,type:"FaceMask"},{cmd:"LicensePlate",className:G,type:"LicensePlate"},{cmd:"CorgiDude Video Capture",className:U,type:"CorgiDudeCamera"},{cmd:"CorgiDude Audio Input",className:B,type:"CorgiDudeAudio"},{cmd:"CorgiDude MobileNet",className:q,type:"CorgiDudeMobileNet"},{cmd:"CorgiDude MobileNet Classifier",className:j,type:"CorgiDudeMobileNetClassifier"},{cmd:"CorgiDude MobileNet Regressor",className:J,type:"CorgiDudeMobileNetRegressor"},{cmd:"CorgiDude Micropython IDE",className:K,type:"CorgiDudeIDE"},{cmd:"MQTT",className:tt,type:"MQTT"},{cmd:"NETPIE 2020",className:et,type:"NETPIE2020"},{cmd:"Blynk",className:it,type:"Blynk"},{cmd:"Flow Editor",className:ot,type:"JSEditor"},{cmd:"Serial Port",className:st,type:"SerialPort"},{cmd:"Filter",className:at,type:"FLowFilter"},{cmd:"Merge",className:rt,type:"FlowMerge"}]}return n(t,[{key:"setup",value:function(){console.log("mlx.setup()"),this.createMainMenu(),this.normalizeWindow()}},{key:"hideNavBar",value:function(){}},{key:"showNavBar",value:function(){}},{key:"maximizeWindow",value:function(){this.isMaximize=!0,this.hideNavBar(),window.dispatchEvent(new Event("resize"))}},{key:"normalizeWindow",value:function(){this.isMaximize=!1,this.showNavBar()}},{key:"getLinkColor",value:function(t){return"image"==t?this.p5.color(255,192,192):"tensor"==t?this.p5.color(128,255,255):"flatarray"==t?this.p5.color(128,255,128):"audio"==t?this.p5.color(255,255,128):"results"==t?this.p5.color(192,192,255):this.p5.color(255)}},{key:"fullscreen",value:function(t){var e=this.p5.fullscreen();return e=!e,this.p5.fullscreen(e),this.fullScreenElement=e?t:null,e}},{key:"windowResized",value:function(){this.p5.fullscreen()||this.fullScreenElement&&(this.fullScreenElement.endFullScreen(),this.fullScreenElement=null),this.maximizedElement&&this.maximizedElement.scaleContentToFillSize(!1),this.onScreenLabel&&(this.onScreenLabel.size(this.p5.windowWidth,44),this.onScreenLabel.position(0,window.innerHeight-44))}},{key:"removeElement",value:function(t){t.clearLinkTo(),t.inElement&&t.inElement.clearLinkTo();var e=this.mlxElements.indexOf(t);t.remove(),this.mlxElements.splice(e,1)}},{key:"addElement",value:function(t,e,i){if(console.log("modelRefClass",t),!(t.prototype instanceof d))return console.log("NOT member of mlxElement",d),!1;console.log("Create",t);var s=new t(this);return s.x=e-s.w/2,s.y=i-this.mlxCaptionHeight/2,this.mlxElements.push(s),s}},{key:"createLabel",value:function(t,e,i,s,n,a){return new Ot(t,e,i,s,n,a)}},{key:"createTextInput",value:function(t,e,i,s,n,a,r,o){return new Pt(t,e,i,s,n,a,r,o)}},{key:"createRadioOption",value:function(t,e,i,s,n,a,r){return new Lt(t,e,i,s,n,a,r)}},{key:"createSelectOption",value:function(t,e,i,s,n,a,r){return new Nt(t,e,i,s,n,a,r)}},{key:"createSeperator",value:function(t,e,i,s,n){return new At(t,e,i,s,n)}},{key:"createButton",value:function(t,e,i,s,n,a,r){return new Dt(t,e,i,s,n,a,r)}},{key:"createCheckBox",value:function(t,e,i,s,n,a,r,o){return new Bt(t,e,i,s,n,a,r,o)}},{key:"createDropdownButton",value:function(t,e,i,s,n,a,r,o){return new Wt(t,e,i,s,n,a,r,o)}},{key:"createVerticalSlider",value:function(t,e,i,s,n,a,r,o,h){return new Rt(t,e,i,s,n,a,r,o,h)}},{key:"createHorizontalSlider",value:function(t,e,i,s,n,a,r,o,h){return new Mt(t,e,i,s,n,a,r,o,h)}},{key:"createImage",value:function(t,e,i,s,n,a){return new zt(t,e,i,s,n,a)}},{key:"createCanvas",value:function(t,e,i,s,n){return new Ft(t,e,i,s,n)}},{key:"createGraph",value:function(t,e,i,s,n){return new Vt(t,e,i,s,n)}},{key:"createFrame",value:function(t,e,i,s,n){return new It(t,e,i,s,n)}},{key:"createMenu",value:function(t,e,i){var s=new Ht(t,e,i);return s._adjustChildrenWidth(),s}},{key:"hidePopup",value:function(){for(var t=this.popup.length-1;t>=0;t--){this.popup[t].hidden=!0,this.popup.splice(t,1)}}},{key:"process",value:function(){if(!this.currentProcess){if(this.startProcessIndex>=this.mlxElements.length)for(t in this.startProcessIndex=0,this.mlxElements)this.mlxElements[t].alreadyRunInLoop=!1;for(var t=this.startProcessIndex;t<this.mlxElements.length;t++)if("Input"==this.mlxElements[t].category){this.currentProcess=this.mlxElements[t],this.startProcessIndex=t+1;break}if(!this.currentProcess)for(t in this.startProcessIndex=0,this.mlxElements)this.mlxElements[t].alreadyRunInLoop=!1}if(this.currentProcess){if(!this.currentProcess.process())return void(this.currentProcess=null);if(this.currentProcess.outElement)this.currentProcess.outElement.inElement==this.currentProcess?this.currentProcess=this.currentProcess.outElement:this.currentProcess=null;else{for(t in this.mlxElements)this.mlxElements[t].alreadyRunInLoop=!1;this.currentProcess=null,this.startProcessIndex>=this.mlxElements.length&&(this.startProcessIndex=0)}}else this.startProcessIndex>=this.mlxElements.length&&(this.startProcessIndex=0)}},{key:"update",value:function(){for(var t in this.mlxElements)this.mlxElements[t].update(this.p5),this.mlxElements[t].updateUI(this.p5);this.mainMenu&&this.mainMenu._update(),this.labelElement&&this.onScreenLabel&&this.onScreenLabel.html(this.labelElement.text)}},{key:"statusOut",value:function(t){this.onScreenLabel&&this.onScreenLabel.html(t)}},{key:"addMlxElementCmd",value:function(t){this.calculateMousePos(),this.hidePopup(),console.log("==== got command=====",t);var e=this.registeredMlxElement.find((function(e){return e.cmd==t.text}));e&&this.addElement(e.className,this.mouseX,this.mouseY)}},{key:"getElementIndex",value:function(t){for(var e in this.mlxElements){if(this.mlxElements[e]==t)return parseInt(e)}return-1}},{key:"saveWorkspace",value:function(t){this.hidePopup(),console.log("Save workspace");var e=[];for(var i in this.mlxElements){var s=this.mlxElements[i].save();e.push(s)}console.log(e),showSaveDialog("workspace","data",e,t,(function(){console.log("Saved")}))}},{key:"removeAllElements",value:function(){for(var t=this.mlxElements.length-1;t>=0;t--){var e=this.mlxElements[t];this.removeElement(e)}}},{key:"doLoadWorkspace",value:function(t){var e=this;this.removeAllElements();var i=function(i){var s=t[i];console.log("elData",s);var n=e.registeredMlxElement.find((function(t){return t.type==s.type}));(console.log("targetClass",n),n)&&e.addElement(n.className,s.x,s.y).load(s)};for(var s in t)i(s);for(var n in t){var a=t[n];-1!=a.outElementIndex&&this.mlxElements[n].linkTo(this.mlxElements[a.outElementIndex]),-1!=a.outExtraElementIndex&&this.mlxElements[n].linkToExtra(this.mlxElements[a.outExtraElementIndex])}}},{key:"loadWorkspace",value:function(){var t=this;this.hidePopup(),console.log("Load workspace"),showOpenDialog("workspace","data",(function(e){if(e&&e.data){var i=JSON.parse(e.data);console.log("Open",i),t.doLoadWorkspace(i)}}))}},{key:"loadExamples",value:function(t){var e=this;this.hidePopup(),this.removeAllElements(),this.loadFile("example","data",t.text,(function(t){console.log(t);var i=JSON.parse(t.data);console.log("Open",i),e.doLoadWorkspace(i)}))}},{key:"loadFile",value:function(t,e,i,s){$.ajax("/files/load",{method:"POST",data:{type:t,dataType:e,filename:i},success:function(t,e,i){console.log("data: "+t.data),s(t.data)},error:function(t,e,i){console.log("error"),console.log(t.status),console.log(t.statusText),console.log(t)},complete:function(){}})}},{key:"loadFileByUUID",value:function(t,e){$.ajax("/files/loaduuid",{method:"POST",data:{uuid:t},success:function(t,i,s){console.log("data: "+t.data),e(t.data)},error:function(t,e,i){console.log("error"),console.log(t.status),console.log(t.statusText),console.log(t)},complete:function(){}})}},{key:"createMainMenu",value:function(){var t=this;if(!this.mainMenu){this.mainMenu=this.createMenu(null,0,0),this.mainMenu.hidden=!0;var e=this.mainMenu.addSubmenu("Workspace");e.subMenu.addCommand("New",(function(e){t.hidePopup(),t.removeAllElements()})),e.subMenu.addSeparator(),e.subMenu.addCommand("Load Workspace",(function(e){return t.loadWorkspace(e)})),e.subMenu.addCommand("Save Workspace",(function(e){return t.saveWorkspace(!1)})),e.subMenu.addSeparator(),e.subMenu.addCommand("Share Workspace",(function(e){return t.saveWorkspace(!0)})),e.subMenu.addSeparator(),e.subMenu.addCheckedMenu("Maximize",0,(function(e,i){t.hidePopup(),i?t.maximizeWindow():t.normalizeWindow()})),this.mainMenu.addGapSeparator();var i=this.mainMenu.addSubmenu("Input");i.subMenu.addCommand("Video Capture",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("RTC Video Capture",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("Image",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("Canvas",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("CSV File",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addSeparator(),i.subMenu.addCommand("Audio Input",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("Speech Command",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addSeparator(),i.subMenu.addCommand("Video Pixels",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("2D Coordinate",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addSeparator(),i.subMenu.addCommand("Text Input",(function(e){return t.addMlxElementCmd(e)})),i.subMenu.addCommand("Game Pad",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator();var s=this.mainMenu.addSubmenu("Pre-trained Model");s.subMenu.addCommand("MobileNet",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addCommand("DoodleNet",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addCommand("PoseNet",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addCommand("HandPose",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addCommand("FaceAPI",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addCommand("YOLO",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addSeparator(),s.subMenu.addCommand("Image Segmentation (UNET)",(function(e){return t.addMlxElementCmd(e)})),s.subMenu.addSeparator(),s.subMenu.addCommand("Face Mask Detection",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator(),this.mainMenu.addSubmenu("Filters/Converters").subMenu.addCommand("Particle Generator",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator();var n=this.mainMenu.addSubmenu("Flow Control");n.subMenu.addCommand("Merge",(function(e){return t.addMlxElementCmd(e)})),n.subMenu.addCommand("Filter",(function(e){return t.addMlxElementCmd(e)})),n.subMenu.addSeparator(),n.subMenu.addCommand("Flow Editor",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator();var a=this.mainMenu.addSubmenu("Output");a.subMenu.addCommand("Label",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Speech",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Oscillator",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Sound Amplitude",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("FFT Spectrum",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Sound Viz",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Spectrogram",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Confusion Matrix",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Nat's Sound Tensor",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addSeparator(),a.subMenu.addCommand("Console Log",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addSeparator(),a.subMenu.addCommand("MQTT",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("NETPIE 2020",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Serial Port",(function(e){return t.addMlxElementCmd(e)})),a.subMenu.addCommand("Blynk",(function(e){return t.addMlxElementCmd(e)}));var r=this.mainMenu.addSubmenu("Games");r.subMenu.addCommand("Snake Game",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Scaventure Hunt",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Nose Artist",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Nose Artist(Mobile)",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Jungle Jumper",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("We Love BubbleTea",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Boat Parking",(function(e){return t.addMlxElementCmd(e)})),r.subMenu.addCommand("Clean the Ocean",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator();var o=this.mainMenu.addSubmenu("Transfer Learning");o.subMenu.addCommand("MobileNet Classifier",(function(e){return t.addMlxElementCmd(e)})),o.subMenu.addCommand("MobileNet Regressor",(function(e){return t.addMlxElementCmd(e)})),o.subMenu.addSeparator(),o.subMenu.addCommand("MobileNet Feature Extractor",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator(),this.mainMenu.addSubmenu("Machine Learning Algorithm").subMenu.addCommand("KNN Classifier",(function(e){return t.addMlxElementCmd(e)}));var h=this.mainMenu.addSubmenu("Deep Learning");h.subMenu.addCommand("Neural Network (Classifier)",(function(e){return t.addMlxElementCmd(e)})),h.subMenu.addCommand("Neural Network (Regressor)",(function(e){return t.addMlxElementCmd(e)})),this.mainMenu.addSeparator();var l=this.mainMenu.addSubmenu("CorgiDude");l.subMenu.addCommand("CorgiDude Audio Input",(function(e){return t.addMlxElementCmd(e)})),l.subMenu.addCommand("CorgiDude Video Capture",(function(e){return t.addMlxElementCmd(e)})),l.subMenu.addSeparator(),l.subMenu.addCommand("CorgiDude Micropython IDE",(function(e){return t.addMlxElementCmd(e)})),l.subMenu.addSeparator(),l.subMenu.addCommand("CorgiDude MobileNet",(function(e){return t.addMlxElementCmd(e)})),l.subMenu.addSeparator(),l.subMenu.addCommand("CorgiDude MobileNet Classifier",(function(e){return t.addMlxElementCmd(e)})),l.subMenu.addCommand("CorgiDude MobileNet Regressor",(function(e){return t.addMlxElementCmd(e)}))}}},{key:"draw",value:function(){if(this.p5.resetMatrix(),this.calculateMousePos(),this.fullScreenElement||this.maximizedElement)this.maximizedElement?this.p5.background(204):this.p5.background(0);else for(var t in this.focusedElement?this.p5.background(0):this.p5.background(204),this.p5.translate(this.userScaleX,this.userScaleY),this.p5.scale(this.userScale),this.p5.translate(-this.userScaleX,-this.userScaleY),this.p5.translate(this.userTranslateX,this.userTranslateY),this.mlxElements)this.mlxElements[t].drawLink(this.p5);if(null==this.maximizedElement){if(this.focusedElement)this.focusedElement.draw(this.p5),this.focusedElement.drawUI(this.p5),this.focusedElement.drawUITop(this.p5);else for(var t in this.mlxElements)this.fullScreenElement&&this.fullScreenElement!=this.mlxElements[t]||(this.mlxElements[t].draw(this.p5),this.mlxElements[t].drawUI(this.p5),this.mlxElements[t].drawInputLink(this.p5),this.mlxElements[t].drawOutputLink(this.p5),this.mlxElements[t].drawUITop(this.p5));this.fullScreenElement||this.mainMenu&&this.mainMenu._draw(this.p5)}else this.maximizedElement.draw(this.p5)}},{key:"calculateMousePos",value:function(){this.mouseX=this.p5.mouseX/this.userScale-this.userScaleX/this.userScale+this.userScaleX-this.userTranslateX,this.mouseY=this.p5.mouseY/this.userScale-this.userScaleY/this.userScale+this.userScaleY-this.userTranslateY}},{key:"mousePressed",value:function(){this.calculateMousePos();for(var t=this.popup.length-1;t>=0;t--){var e=this.popup[t];if(e.isHitElement(this.mouseX,this.mouseY))return void e.mousePressed();var i=null;if(e.parent&&(i=e.parent),e.hidden=!0,this.popup.splice(t,1),i&&i.activateUI&&i.activateUI(),i&&i.isHitElement(this.mouseX,this.mouseY))return;if(0==t){if(!i)return;if(i.isHitMenuButton(this.mouseX,this.mouseY))return}}for(t=this.mlxElements.length-1;t>=0;t--){var s=this.mlxElements[t];if(s.isHitMenuButton(this.mouseX,this.mouseY))return this.bringToTop(s),void s.toggleMenu();if(s.isHitInputLink(this.mouseX,this.mouseY))return this.elLinkMoving=s.inElement,s.inElement.linkMoving=!0,void s.inElement.clearLinkTo();if(s.isHitOutputLink(this.mouseX,this.mouseY))return s.linkMoving=!0,void(this.elLinkMoving=s);if(s.isHitCaptionBar(this.mouseX,this.mouseY))return this.bringToTop(s),this.elMoving=s,s.isHighlight=!0,this.pmouseX=this.mouseX,void(this.pmouseY=this.mouseY);if(s.isHitSizer(this.mouseX,this.mouseY))return this.elSizing=s,s.isHighlight=!0,this.pmouseX=this.mouseX,void(this.pmouseY=this.mouseY);if(s.isHitElement(this.mouseX,this.mouseY))return void(s.needMouse&&(this.elDragging=s,s.mousePressed()))}this.p5.mouseButton===this.p5.RIGHT||3==this.p5.touches.length?(console.log("Right button pressed"),console.log(this.mainMenu),this.mainMenu&&(this.mainMenu.xx=this.mouseX,this.mainMenu.xx+this.mainMenu.w>this.p5.width-10&&(this.mainMenu.xx=this.p5.width-this.mainMenu.w-10),this.mainMenu.yy=this.mouseY,this.mainMenu.yy+this.mainMenu.h>this.p5.height-50&&(this.mainMenu.yy=this.p5.height-this.mainMenu.h-50),this.mainMenu.hidden=!1,this.popup.push(this.mainMenu))):this.p5.mouseButton===this.p5.LEFT&&(this.panning=!0)}},{key:"bringToTop",value:function(t){var e=this.mlxElements.indexOf(t);e>=0&&(this.mlxElements.splice(e,1),this.mlxElements.push(t))}},{key:"touchStartScale",value:function(t){this.startUserScale=this.userScale,this.userScaleX=this.p5.mouseX,this.userScaleY=this.p5.mouseY}},{key:"touchScale",value:function(t){for(var e in this.userScale=this.startUserScale*t,this.userScale<.1&&(this.userScale=.1),this.userScale>10&&(this.userScale=10),this.userTranslateX+=this.p5.mouseX-this.p5.pmouseX,this.userTranslateY+=this.p5.mouseY-this.p5.pmouseY,this.pmouseX=this.mouseX,this.pmouseY=this.mouseY,this.mlxElements){var i=this.mlxElements[e];if(i.isHitElement(this.mouseX,this.mouseY))return void(i.needMouse&&i.mouseWheel(event))}}},{key:"mouseWheel",value:function(t){for(var e in this.p5.keyIsDown(this.p5.SHIFT)&&(this.userScaleX=this.p5.mouseX,this.userScaleY=this.p5.mouseY,this.pos+=t.delta,this.userScale=1+this.pos/100,this.userScale<.1&&(this.userScale=.1),this.userScale>10&&(this.userScale=10)),this.mlxElements){var i=this.mlxElements[e];if(i.isHitElement(this.mouseX,this.mouseY))return void(i.needMouse&&i.mouseWheel(t))}}},{key:"mouseReleased",value:function(){if(this.calculateMousePos(),this.panning)this.panning=!1;else if(this.popup.length)this.popup[this.popup.length-1].mouseReleased();else{if(this.elLinkMoving){for(var t in this.elLinkMoving.linkMoving=!1,this.elLinkTarget&&(this.elLinkTarget.isHighlight=!1,this.elLinkTarget=null),this.mlxElements){var e=this.mlxElements[t];if(e.isHitElement(this.mouseX,this.mouseY)&&e!=this.elLinkMoving&&(this.elLinkMoving.outType===e.inType||"all"==e.inType||e.inType.includes(",")&&e.inType.split(",").includes(this.elLinkMoving.outType))){if(!e.inElement){this.elLinkMoving.linkTo(e);break}if(e.allowExtraInElement){this.elLinkMoving.linkToExtra(e);break}}}this.elLinkMoving=null}this.elMoving&&(this.elMoving.isHighlight=!1,this.elMoving=null),this.elSizing&&(this.elSizing.isHighlight=!1,this.elSizing=null),this.elDragging&&(this.elDragging.mouseReleased(),this.elDragging=null)}}},{key:"mouseMoved",value:function(){if(this.calculateMousePos(),this.popup.length)for(var t=this.popup.length-1;t>=0;t--){this.popup[t].mouseMoved()}this.elDragging&&this.elDragging.mouseMoved()}},{key:"mouseDragged",value:function(){if(this.calculateMousePos(),this.panning)return this.userTranslateX+=this.p5.mouseX-this.p5.pmouseX,void(this.userTranslateY+=this.p5.mouseY-this.p5.pmouseY);if(this.popup.length)this.popup[this.popup.length-1].mouseDragged();else{if(this.elLinkMoving){for(var t in this.mlxElements){var e=this.mlxElements[t];if(e.isHitElement(this.mouseX,this.mouseY)&&e!=this.elLinkMoving&&!e.inElement)return void((this.elLinkMoving.outType===e.inType||"all"==e.inType||e.inType.includes(",")&&e.inType.split(",").includes(this.elLinkMoving.outType))&&(this.elLinkTarget&&(this.elLinkTarget.isHighlight=!1),this.elLinkTarget=e,this.elLinkTarget.isHighlight=!0))}this.elLinkTarget&&(this.elLinkTarget.isHighlight=!1,this.elLinkTarget=null)}this.elMoving&&(this.elMoving.x+=this.mouseX-this.pmouseX,this.elMoving.y+=this.mouseY-this.pmouseY,this.elMoving.setPosition(this.elMoving.x,this.elMoving.y),this.pmouseX=this.mouseX,this.pmouseY=this.mouseY),this.elSizing&&this.elSizing.resizeByMouse(),this.elDragging&&this.elDragging.mouseDragged()}}},{key:"keyPressed",value:function(t){this.p5.keyCode===this.p5.ESCAPE&&(this.focusedElement&&(console.log("Exit Focus Element"),this.userScaleX=0,this.userScaleY=0,this.userScale=1,this.focusedElement.removeFocus(),this.focusedElement=null),this.isMaximize&&(this.maximizedElement?this.maximizedElement.lockMaximize||this.maximizedElement.exitMaximize():this.normalizeWindow()))}}]),t}();t.exports={MLX:Xt}},75537:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput),m=(p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Boat Parking",n.category="Output",n.type="BoatParkingGame",n.inType="posenet",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=854,n.canvas_w=854,n.canvas_h=560,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.canvas_w/2+2*n.mlx.mlxPadding,n.h=n.canvas_h/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w/2,n.canvas_h/2),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.pose=[],n.skeletons=[],n.posNose=[],n.posLeftWrist=[],n.posRightWrist=[],n.posLeftElbow=[],n.posRightElbow=[],n.prevLeftElbowPos=null,n.prevRightElbowPos=null,n.gameMode="SETUP",n.gameLevel,n.MIN_L_ANGLE,n.MIN_R_ANGLE,n.MAX_L_ANGLE,n.MAX_R_ANGLE,n.SPEED=62,n.INITIAL_RELEASE_TIME=6e3,n.RELESEBOX_CONDITION_1=1600,n.RELESEBOX_CONDITION_2=2600,n.RELESEBOX_CONDITION_3=3700,n.HP=5,n.SCORE=0,n.ALLOWED_CALIBRATE_MOVING_PIXEL=40,n.CV_SIZE_W=854,n.CV_SIZE_H=560,n.BOX_W=101,n.BOX_H=80,n.ui_calibrate,n.ui_game,n.boxes=[],n.font,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_logo=this.p5.loadImage("assets_game/mlxBoatParking/logo.png"),this.img_marker_red=this.p5.loadImage("assets_game/mlxBoatParking/p_marker_red.png"),this.img_marker=this.p5.loadImage("assets_game/mlxBoatParking/p_marker_black.png"),this.img_mask=this.p5.loadImage("assets_game/mlxBoatParking/mask.png"),this.img_step1=this.p5.loadImage("assets_game/mlxBoatParking/step2.png"),this.img_step2=this.p5.loadImage("assets_game/mlxBoatParking/step3.png"),this.img_bg=this.p5.loadImage("assets_game/mlxBoatParking/bg.png"),this.img_heart=this.p5.loadImage("assets_game/mlxBoatParking/heart.png"),this.img_box_b1=this.p5.loadImage("assets_game/mlxBoatParking/b1.png"),this.img_box_b2=this.p5.loadImage("assets_game/mlxBoatParking/b2.png"),this.img_box_b3=this.p5.loadImage("assets_game/mlxBoatParking/b3.png"),this.img_box_b4=this.p5.loadImage("assets_game/mlxBoatParking/b4.png"),this.img_box_bf=this.p5.loadImage("assets_game/mlxBoatParking/bf.png"),this.img_box_r1=this.p5.loadImage("assets_game/mlxBoatParking/r1.png"),this.img_box_r2=this.p5.loadImage("assets_game/mlxBoatParking/r2.png"),this.img_box_r3=this.p5.loadImage("assets_game/mlxBoatParking/r3.png"),this.img_box_r4=this.p5.loadImage("assets_game/mlxBoatParking/r4.png"),this.img_box_rf=this.p5.loadImage("assets_game/mlxBoatParking/rf.png"),this.img_box_y1=this.p5.loadImage("assets_game/mlxBoatParking/y1.png"),this.img_box_y2=this.p5.loadImage("assets_game/mlxBoatParking/y2.png"),this.img_box_y3=this.p5.loadImage("assets_game/mlxBoatParking/y3.png"),this.img_box_y4=this.p5.loadImage("assets_game/mlxBoatParking/y4.png"),this.img_box_yf=this.p5.loadImage("assets_game/mlxBoatParking/yf.png"),this.img_buoy1=this.p5.loadImage("assets_game/mlxBoatParking/buoy1.png"),this.img_buoy2=this.p5.loadImage("assets_game/mlxBoatParking/buoy2.png"),this.img_buoy3=this.p5.loadImage("assets_game/mlxBoatParking/buoy3.png"),this.img_buoy4=this.p5.loadImage("assets_game/mlxBoatParking/buoy4.png"),this.img_rock1=this.p5.loadImage("assets_game/mlxBoatParking/rock1.png"),this.img_rock2=this.p5.loadImage("assets_game/mlxBoatParking/rock2.png"),this.img_right=this.p5.loadImage("assets_game/mlxBoatParking/right.png"),this.img_wrong=this.p5.loadImage("assets_game/mlxBoatParking/wrong.png"),this.img_heart=this.p5.loadImage("assets_game/mlxBoatParking/heart.png"),this.img_heart_empty=this.p5.loadImage("assets_game/mlxBoatParking/heart_empty.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxBoatParking/waittoconnect.png"),this.font=this.p5.loadFont("assets_game/mlxBoatParking/FFFFORWA.TTF"),this.sound_beep=this.p5.loadSound("assets_game/mlxBoatParking/beep.mp3"),this.sound_changepoint=this.p5.loadSound("assets_game/mlxBoatParking/beep.mp3"),this.sound_ok=this.p5.loadSound("assets_game/mlxBoatParking/ok.mp3"),this.sound_falldown=this.p5.loadSound("assets_game/mlxBoatParking/falldown.mp3"),this.sound_correct=this.p5.loadSound("assets_game/mlxBoatParking/correct.mp3"),this.sound_movebridge=this.p5.loadSound("assets_game/mlxBoatParking/movebridge.mp3"),this.sound_wrong=this.p5.loadSound("assets_game/mlxBoatParking/wrong.mp3"),this.sound_over=this.p5.loadSound("assets_game/mlxBoatParking/gameover.mp3"),this.sound_yes=this.p5.loadSound("assets_game/mlxBoatParking/yes.mp3"),this.sound_no=this.p5.loadSound("assets_game/mlxBoatParking/no.mp3"),this.sound_start=this.p5.loadSound("assets_game/mlxBoatParking/music.mp3"),this.sound_wave=this.p5.loadSound("assets_game/mlxBoatParking/wave.mp3")}},{key:"setup",value:function(){this.imageListY=[this.img_box_y1,this.img_box_y2,this.img_box_y3,this.img_box_y4,this.img_box_yf],this.imageListB=[this.img_box_b1,this.img_box_b2,this.img_box_b3,this.img_box_b4,this.img_box_bf],this.imageListR=[this.img_box_r1,this.img_box_r2,this.img_box_r3,this.img_box_r4,this.img_box_rf],this.imgBuoy=[this.img_buoy1,this.img_buoy2,this.img_buoy3,this.img_buoy4],this.Buoy=[],this.Buoy[0]=new d(this,24,101,0),this.Buoy[1]=new d(this,94,101,1),this.Buoy[2]=new d(this,165,101,2),this.Buoy[3]=new d(this,24,231,1),this.Buoy[4]=new d(this,94,231,2),this.Buoy[5]=new d(this,165,231,0),this.Buoy[6]=new d(this,24,360,2),this.Buoy[7]=new d(this,94,360,0),this.Buoy[8]=new d(this,165,360,1),this.Buoy[9]=new d(this,24,487,0),this.Buoy[10]=new d(this,94,487,1),this.Buoy[11]=new d(this,165,487,2),this.ui_calibrate=new f(this),this.ui_game=new v(this),this.precanvas.textFont(this.font)}},{key:"doProcess",value:function(){return this.poses=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture?(this.gameConnected||(this.ui_calibrate.calibrateStep="step1",this.gameMode="SETUP",this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.canvas_w,0)),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop(),"SETUP"==this.gameMode?this.ui_calibrate.draw():this.ui_game.draw()):(this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop(),this.gameConnected=!1),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.canvas_w,this.canvas_h),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.canvas_w;var t=(this.h-110)/this.canvas_h;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.canvas_w*this.fullscreen_scale,this.canvas_h*this.fullscreen_scale)}},{key:"getKeypoints",value:function(){if(null!=this.poses)for(var t=0,e=0,i=0,s=0,n=0,a=0;a<this.poses.length;a++){if(null==this.poses[a].pose)return;var r=this.poses[a].pose.keypoints,o=r[0];if(o.score>.1&&t<o.score){var h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posNose[0]=this.p5.createVector(h,o.position.y),t=o.score}if((o=r[7]).score>.1&&e<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posLeftElbow[0]=this.p5.createVector(h,o.position.y),e=o.score}if((o=r[8]).score>.1&&i<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posRightElbow[0]=this.p5.createVector(h,o.position.y),i=o.score}if((o=r[10]).score>.1&&n<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posRightWrist[0]=this.p5.createVector(h,o.position.y),n=o.score}if((o=r[9]).score>.1&&s<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posLeftWrist[0]=this.p5.createVector(h,o.position.y),s=o.score}}}},{key:"degree",value:function(t,e){var i=this.p5.degrees(this.p5.atan2(e.y-t.y,e.x-t.x));return i<0&&(i+=360),i<270&&(i+=360),i}},{key:"distance",value:function(t,e){return this.p5.sqrt(this.p5.pow(e.x-t.x,2)+this.p5.pow(e.y-t.y,2))}},{key:"checkRaiseHand",value:function(){return null!=this.posRightElbow[0]&&null!=this.posLeftElbow[0]&&null!=this.posNose[0]&&null!=this.prevLeftElbowPos&&null!=this.prevRightElbowPos&&((this.degree(this.posNose[0],this.posRightElbow[0])>=300||this.degree(this.posNose[0],this.posRightElbow[0])<=380)&&this.degree(this.posNose[0],this.posLeftElbow[0])<=600&&this.degree(this.posNose[0],this.posLeftElbow[0])>=520&&this.distance(this.posLeftElbow[0],this.prevLeftElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL&&this.distance(this.posRightElbow[0],this.prevRightElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL)}},{key:"checkLowerHand",value:function(){return null!=this.posRightElbow[0]&&null!=this.posLeftElbow[0]&&null!=this.posNose[0]&&null!=this.prevLeftElbowPos&&null!=this.prevRightElbowPos&&(this.posNose[0].y<=this.posLeftWrist[0].y&&this.posNose[0].y<=this.posRightWrist[0].y&&this.posLeftWrist[0].y<this.posLeftElbow[0].y&&this.posRightWrist[0].y<this.posRightElbow[0].y&&this.distance(this.posLeftElbow[0],this.prevLeftElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL&&this.distance(this.posRightElbow[0],this.prevRightElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL)}},{key:"gotPoses",value:function(t){this.poses=t}},{key:"modelReady",value:function(){}}]),i}(c)),d=function(){"use strict";function t(e,i,n,a){s(this,t),this.parent=e,this.x=i,this.y=n,this.time=200,this.index=a}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.translate(this.x,this.y),this.parent.precanvas.image(this.parent.imgBuoy[this.index],0,0),this.time-=this.parent.p5.deltaTime,this.time<0&&(this.time=200,this.index++,this.index>=4&&(this.index=0)),this.parent.precanvas.pop()}}]),t}(),g=function(){"use strict";function t(e,i,n){s(this,t),this.parent=e,this.xPos=[224,634],this.yPos=[204,342,475],this.originPlatform=i,this.targetPlatform=n,this.imageList=this.parent.imageListY,1==this.targetPlatform?this.imageList=this.parent.imageListB:2==this.targetPlatform&&(this.imageList=this.parent.imageListR),this.myImage=this.imageList[this.parent.p5.random([0,1,2,3])],this.x=0,this.y=0,this.onBridge=!1,this.onTarget=!1,this.drop=!1,this.bridgeWidth=this.xPos[1]-this.xPos[0],this.checked=!1,this.correct=0,this.deleteTime=2e3,this.delete=!1}return n(t,[{key:"draw",value:function(){this.delete||(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.drop||(this.x+=this.parent.p5.floor(this.parent.SPEED*(this.parent.p5.deltaTime/1e3)),this.x>this.parent.CV_SIZE_W+this.parent.BOX_W/2&&(this.delete=!0),this.x<this.xPos[0]?(this.parent.precanvas.translate(this.x,this.yPos[this.originPlatform]),this.parent.precanvas.image(this.myImage,-this.parent.BOX_W/2,-this.parent.BOX_H,this.parent.BOX_W,this.parent.BOX_H)):this.x>=this.xPos[0]&&!this.onBridge&&!this.onTarget?this.parent.ui_game.selectedPointL==this.originPlatform?(this.onBridge=!0,this.parent.precanvas.translate(this.x,this.calculateHeight()),this.parent.precanvas.image(this.myImage,-this.parent.BOX_W/2,-this.parent.BOX_H,this.parent.BOX_W,this.parent.BOX_H)):(this.drop=!0,this.parent.sound_falldown.play(),this.y=this.yPos[this.originPlatform],this.myImage=this.imageList[4],this.parent.HP--,this.parent.HP<=0&&(this.parent.gameMode="OVER",this.parent.sound_over.play())):this.x>=this.xPos[0]&&this.onBridge&&!this.onTarget?(this.parent.precanvas.translate(this.x,this.calculateHeight()),this.parent.precanvas.image(this.myImage,-this.parent.BOX_W/2,-this.parent.BOX_H,this.parent.BOX_W,this.parent.BOX_H),this.x>=this.xPos[1]&&(this.onTarget=!0,this.originPlatform=this.parent.ui_game.selectedPointR)):(this.parent.precanvas.translate(this.x,this.yPos[this.originPlatform]),this.parent.precanvas.image(this.myImage,-this.parent.BOX_W/2,-this.parent.BOX_H,this.parent.BOX_W,this.parent.BOX_H),1==this.correct?this.parent.precanvas.image(this.parent.img_right,-21,-42,42,42):2==this.correct&&this.parent.precanvas.image(this.parent.img_wrong,-21,-42,42,42),!this.checked&&this.x<this.parent.CV_SIZE_W-70&&this.targetPlatform==this.originPlatform?(this.correct=1,this.parent.sound_correct.play(),this.parent.SCORE++,this.checked=!0):!this.checked&&this.x<this.parent.CV_SIZE_W-70&&this.targetPlatform!=this.originPlatform&&(this.parent.sound_wrong.play(),this.correct=2,this.parent.HP--,this.parent.HP<=0&&(this.parent.gameMode="OVER",this.parent.sound_over.play()),this.checked=!0))),this.drop&&(this.parent.precanvas.translate(this.x,this.y),this.parent.precanvas.imageMode(this.parent.precanvas.CORNER),this.parent.precanvas.image(this.myImage,-this.parent.BOX_W/2,-this.parent.BOX_H,this.parent.BOX_W,this.parent.BOX_H),this.deleteTime-=this.parent.p5.deltaTime,this.deleteTime<0&&(this.delete=!0)),this.parent.precanvas.pop())}},{key:"calculateHeight",value:function(){var t=(this.x-this.xPos[0])/this.bridgeWidth;return this.yPos[this.parent.ui_game.selectedPointL]+t*(this.yPos[this.parent.ui_game.selectedPointR]-this.yPos[this.parent.ui_game.selectedPointL])}}]),t}(),v=function(){"use strict";function t(e){s(this,t),this.parent=e,this.leftPos=[this.parent.p5.createVector(224,204),this.parent.p5.createVector(224,342),this.parent.p5.createVector(224,475)],this.rightPos=[this.parent.p5.createVector(634,204),this.parent.p5.createVector(634,342),this.parent.p5.createVector(634,475)],this.previousPointL=2,this.previousPointR=2,this.alpha_2=0,this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.degreeL=null,this.degreeR=null,this.nextBox=new g(this.parent,this.parent.p5.random([0,1,2]),this.parent.p5.random([0,1,2])),this.releasebox=this.parent.INITIAL_RELEASE_TIME}return n(t,[{key:"draw",value:function(){this.getCurrentAngle(),this.calculateCurrentSelectedPoint(),this.drawBackground();for(var t=0;t<this.parent.Buoy.length;t++)this.parent.Buoy[t].draw();this.parent.precanvas.push(),this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(30,0,5),this.parent.precanvas.text("SCORE: "+this.parent.SCORE,20,30);for(t=0;t<5;t++)this.parent.precanvas.imageMode(this.parent.p5.CENTER),t<this.parent.HP?this.parent.precanvas.image(this.parent.img_heart,this.parent.CV_SIZE_W-30-54*t,28):this.parent.precanvas.image(this.parent.img_heart_empty,this.parent.CV_SIZE_W-30-54*t,28);this.parent.precanvas.pop(),this.parent.precanvas.push(),this.parent.precanvas.stroke(25,151,200),this.parent.precanvas.drawingContext.setLineDash([5,15]),this.parent.precanvas.strokeWeight(10),this.parent.precanvas.line(this.leftPos[this.selectedPointL].x,this.leftPos[this.selectedPointL].y,this.rightPos[this.selectedPointR].x,this.rightPos[this.selectedPointR].y),this.parent.precanvas.pop();var e=this.parent.boxes;if("INTRO"==this.parent.gameMode)this.drawIntro();else if("PLAY"==this.parent.gameMode){if(this.parent.SCORE<15?this.parent.SPEED=65:this.parent.SCORE<35?this.parent.SPEED=90:this.parent.SCORE<50?this.parent.SPEED=100:this.parent.SCORE<70&&(this.parent.SPEED=115),this.releasebox-=this.parent.p5.deltaTime,this.releasebox<0)if(0==e.length)console.log("boxes.length == 0"),this.releasebox=this.parent.INITIAL_RELEASE_TIME,e[e.length]=this.nextBox,this.nextBox=new g(this.parent,this.parent.p5.random([0,1,2]),this.parent.p5.random([0,1,2]));else{console.log("boxes.length:"+e.length);var i=this.parent.p5.random([0,1,2]);if(1==i)this.releasebox=this.parent.RELESEBOX_CONDITION_1-(this.parent.SPEED-65)/50*850,e[e.length]=this.nextBox,this.nextBox=new g(this.parent,e[e.length-1].originPlatform,e[e.length-1].targetPlatform);else if(2==i){this.releasebox=this.parent.RELESEBOX_CONDITION_2-(this.parent.SPEED-65)/50*1200,e[e.length]=this.nextBox;for(var s=this.parent.p5.random([0,1,2]),n=this.parent.p5.random([0,1,2]);e[e.length-1].originPlatform==n;)s=this.parent.p5.random([0,1,2]),n=this.parent.p5.random([0,1,2]);this.nextBox=new g(this.parent,n,this.parent.p5.random([0,1,2]))}else{this.releasebox=this.parent.RELESEBOX_CONDITION_3-(this.parent.SPEED-65)/50*1500,e[e.length]=this.nextBox;for(s=this.parent.p5.random([0,1,2]),n=this.parent.p5.random([0,1,2]);e[e.length-1].originPlatform==n||e[e.length-1].targetPlatform==s;)s=this.parent.p5.random([0,1,2]),n=this.parent.p5.random([0,1,2]);this.nextBox=new g(this.parent,n,s)}}for(t=0;t<e.length;t++)e[t].draw();this.drawMarkerPoint()}else"OVER"==this.parent.gameMode&&(this.drawOver(),this.drawMarkerPoint())}},{key:"initialRangeCalculate",value:function(){var t=this.parent.MAX_L_ANGLE-this.parent.MIN_L_ANGLE,e=this.parent.MAX_R_ANGLE-this.parent.MIN_R_ANGLE;this.upperL=.8*t+this.parent.MIN_L_ANGLE,this.lowerL=.35*t+this.parent.MIN_L_ANGLE,this.upperR=this.parent.MAX_R_ANGLE-.8*e,this.lowerR=this.parent.MAX_R_ANGLE-.35*e}},{key:"calculateCurrentSelectedPoint",value:function(){this.selectedPointL=1,this.degreeL>this.upperL?this.selectedPointL=0:this.degreeL<this.lowerL&&(this.selectedPointL=2),this.selectedPointR=1,this.degreeR<this.upperR?this.selectedPointR=0:this.degreeR>this.lowerR&&(this.selectedPointR=2),this.previousPointL!=this.selectedPointL&&this.parent.sound_movebridge.play(),this.previousPointR!=this.selectedPointR&&this.parent.sound_movebridge.play(),this.previousPointL=this.selectedPointL,this.previousPointR=this.selectedPointR}},{key:"getCurrentAngle",value:function(){null==this.degreeL&&(this.degreeL=this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),null==this.degreeR&&(this.degreeR=this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.degreeL=(this.degreeL+this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0]))/2,this.degreeR=(this.degreeR+this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0]))/2}},{key:"drawBackground",value:function(){this.parent.precanvas.push(),this.parent.precanvas.fill(0,200),this.parent.precanvas.rect(0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_bg,0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.parent.precanvas.strokeWeight(10),this.parent.precanvas.stroke(25,151,200),this.parent.precanvas.drawingContext.setLineDash([5,15]),this.parent.precanvas.line(0,204,223,204),this.parent.precanvas.line(0,342,223,342),this.parent.precanvas.line(0,475,223,475),this.parent.precanvas.pop()}},{key:"drawMarkerPoint",value:function(){for(var t=0;t<3;t++)this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),t==this.selectedPointL?this.parent.precanvas.image(this.parent.img_marker_red,this.leftPos[t].x,this.leftPos[t].y):this.parent.precanvas.image(this.parent.img_marker,this.leftPos[t].x,this.leftPos[t].y),t==this.selectedPointR?this.parent.precanvas.image(this.parent.img_marker_red,this.rightPos[t].x,this.rightPos[t].y):this.parent.precanvas.image(this.parent.img_marker,this.rightPos[t].x,this.rightPos[t].y),this.parent.precanvas.pop()}},{key:"drawIntro",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_logo,this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H/2),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.alpha_2+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.fill(255,170,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_2))),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(25,0,5),this.parent.precanvas.text("Raise both hands to Start !!",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70),this.parent.precanvas.pop(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.beepSoundTime-=this.parent.p5.deltaTime,this.checkingCountDown<=2001&&(this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.parent.precanvas.push(),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(80,0,5),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.parent.p5.floor(this.checkingCountDown/1e3)+1,this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H/2),this.parent.precanvas.pop(),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.parent.gameMode="PLAY",this.parent.sound_start.play())):(this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])}},{key:"drawOver",value:function(){this.parent.precanvas.push(),this.alpha_2+=this.parent.p5.deltaTime/50%20,this.parent.precanvas.fill(255,170,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_2))),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(28,0,5),this.parent.precanvas.text("Raise both hands to try again !!",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70),this.parent.precanvas.pop(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.beepSoundTime-=this.parent.p5.deltaTime,this.checkingCountDown<=2001&&(this.parent.precanvas.push(),this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(80,0,5),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.parent.p5.floor(this.checkingCountDown/1e3)+1,this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H/2),this.parent.precanvas.pop(),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.checkingCountDown<0&&(this.checkingCountDown=3e3,this.parent.sound_yes.play(),this.parent.HP=5,this.parent.SCORE=0,this.parent.boxes=[],this.releasebox=this.parent.INITIAL_RELEASE_TIME,this.beepSoundTime=1e3,this.parent.gameMode="PLAY",this.parent.sound_start.play())):(this.parent.precanvas.push(),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.parent.precanvas.fill(255,234,0),this.setTextSizeStrokeWeight(40,0,5),this.parent.precanvas.text("GAME OVER",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H/2),this.parent.precanvas.pop(),this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),f=function(){"use strict";function t(e){s(this,t),this.parent=e,this.calibrateStep="step1",this.checkingCountDown=3e3,this.beepSoundTime=1e3}return n(t,[{key:"draw",value:function(){"SETUP"==this.parent.gameMode&&(this.parent.precanvas.push(),this.drawSetupText(),this.parent.precanvas.pop())}},{key:"drawSetupText",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_mask,0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.parent.precanvas.fill(255),this.parent.precanvas.rect(20,this.parent.CV_SIZE_H-120,this.parent.CV_SIZE_W-40,100,15),"step1"==this.calibrateStep?(this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(25,0,5),this.checkingCountDown>=2001?this.parent.precanvas.text("stand 2 m. from camera and raise both hands",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70):(this.parent.precanvas.text("Stay still ("+(this.parent.p5.int(this.checkingCountDown/1e3)+1)+" sec.)",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70),this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.beepSoundTime-=this.parent.p5.deltaTime,this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.parent.precanvas.image(this.parent.img_step1,20,this.parent.CV_SIZE_H-120-231,263,231),this.ratio_w=this.parent.canvas_w/this.parent.inElement.inElement.videoWidth,this.ratio_h=this.parent.canvas_h/this.parent.inElement.inElement.videoHeight,this.drawElbowMarker(),this.drawNoseMarker(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.parent.MAX_L_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.parent.MIN_R_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0])),this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.calibrateStep="step2")):(this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])):"step2"==this.calibrateStep&&(this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(25,0,5),this.checkingCountDown>=2001?this.parent.precanvas.text("Lower both elbows",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70):(this.parent.precanvas.text("Stay still ("+(this.parent.p5.int(this.checkingCountDown/1e3)+1)+" sec.)",this.parent.CV_SIZE_W/2,this.parent.CV_SIZE_H-70),this.beepSoundTime-=this.parent.p5.deltaTime,this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.CV_SIZE_W,this.parent.CV_SIZE_H),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.parent.precanvas.image(this.parent.img_step2,20,this.parent.CV_SIZE_H-120-225,228,225),this.ratio_w=this.parent.canvas_w/this.parent.inElement.inElement.videoWidth,this.ratio_h=this.parent.canvas_h/this.parent.inElement.inElement.videoHeight,this.drawElbowMarker(),this.drawWristMarker(),this.parent.checkLowerHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.parent.MIN_L_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.parent.MAX_R_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0])),this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.parent.gameMode="INTRO",this.parent.ui_game.initialRangeCalculate(),this.parent.sound_wave.loop(),this.parent.sound_wave.play())):(this.checkingCountDown,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])),this.parent.precanvas.pop()}},{key:"drawElbowMarker",value:function(){null!=this.parent.posLeftElbow[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posLeftElbow[0].x*this.ratio_w,this.parent.posLeftElbow[0].y*this.ratio_h,0,0),this.parent.precanvas.pop()),null!=this.parent.posRightElbow[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posRightElbow[0].x*this.ratio_w,this.parent.posRightElbow[0].y*this.ratio_h,0,0),this.parent.precanvas.pop())}},{key:"drawWristMarker",value:function(){null!=this.parent.posLeftWrist[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posLeftWrist[0].x*this.ratio_w,this.parent.posLeftWrist[0].y*this.ratio_h,0,0),this.parent.precanvas.pop()),null!=this.parent.posRightWrist[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posRightWrist[0].x*this.ratio_w,this.parent.posRightWrist[0].y*this.ratio_h,0,0),this.parent.precanvas.pop())}},{key:"drawNoseMarker",value:function(){null!=this.parent.posNose[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h,0,0),this.parent.precanvas.stroke(255,0,0),this.parent.precanvas.strokeWeight(10),null!=this.parent.posLeftElbow[0]&&this.parent.precanvas.line(this.parent.posLeftElbow[0].x*this.ratio_w,this.parent.posLeftElbow[0].y*this.ratio_h,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h),null!=this.parent.posRightElbow[0]&&this.parent.precanvas.line(this.parent.posRightElbow[0].x*this.ratio_w,this.parent.posRightElbow[0].y*this.ratio_h,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h),this.parent.precanvas.pop())}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}();t.exports={mlxBoatParking:m}},60369:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput),m=(p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).gameMode="INTRO",n.gameModeEnd="TIMEUP",n.title="We Love BubbleTea",n.category="Output",n.type="BubbleTeaGame",n.inType="tensor",n.outType="results",n.needMouse=!1,n.cv_width=854,n.cv_height=560,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.cv_width/2+2*n.mlx.mlxPadding,n.h=n.cv_height/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.cv_width/2,n.cv_height/2),n.canvas=n.offScreen.offScreen,n.canvas.imageMode(n.p5.CORNER),n.precanvas=n.p5.createGraphics(n.cv_width,n.cv_height),n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_waiting=this.p5.loadImage("assets_game/mlxBubbleTea/waiting.png"),this.img_logo=this.p5.loadImage("assets_game/mlxBubbleTea/logo.png"),this.img_b1=this.p5.loadImage("assets_game/mlxBubbleTea/b_1.png"),this.img_b2=this.p5.loadImage("assets_game/mlxBubbleTea/b_2.png"),this.img_b3=this.p5.loadImage("assets_game/mlxBubbleTea/b_3.png"),this.img_b4=this.p5.loadImage("assets_game/mlxBubbleTea/b_4.png"),this.img_b5=this.p5.loadImage("assets_game/mlxBubbleTea/b_5.png"),this.img_b6=this.p5.loadImage("assets_game/mlxBubbleTea/b_6.png"),this.img_direction=this.p5.loadImage("assets_game/mlxBubbleTea/direction.png"),this.img_clock=this.p5.loadImage("assets_game/mlxBubbleTea/clock.png"),this.img_heart=this.p5.loadImage("assets_game/mlxBubbleTea/heart.png"),this.img_t1=this.p5.loadImage("assets_game/mlxBubbleTea/btea_1.png"),this.img_t2=this.p5.loadImage("assets_game/mlxBubbleTea/btea_2.png"),this.img_t3=this.p5.loadImage("assets_game/mlxBubbleTea/btea_3.png"),this.img_t4=this.p5.loadImage("assets_game/mlxBubbleTea/btea_4.png"),this.img_t5=this.p5.loadImage("assets_game/mlxBubbleTea/btea_5.png"),this.img_t6=this.p5.loadImage("assets_game/mlxBubbleTea/btea_6.png"),this.img_t7=this.p5.loadImage("assets_game/mlxBubbleTea/btea_7.png"),this.img_t8=this.p5.loadImage("assets_game/mlxBubbleTea/btea_8.png"),this.img_w1=this.p5.loadImage("assets_game/mlxBubbleTea/wall1.png"),this.img_w2=this.p5.loadImage("assets_game/mlxBubbleTea/wall2.png"),this.img_w3=this.p5.loadImage("assets_game/mlxBubbleTea/wall3.png"),this.img_w4=this.p5.loadImage("assets_game/mlxBubbleTea/wall4.png"),this.img_sugar=this.p5.loadImage("assets_game/mlxBubbleTea/sugarcube.png"),this.img_mouth_open=this.p5.loadImage("assets_game/mlxBubbleTea/mouth_open.png"),this.img_mouth_close=this.p5.loadImage("assets_game/mlxBubbleTea/mouth_close.png"),this.img_mouth_hold=this.p5.loadImage("assets_game/mlxBubbleTea/mouth_hold.png"),this.font=this.p5.loadFont("assets_game/mlxBubbleTea/FFFFORWA.TTF"),this.sound_okay=this.p5.loadSound("assets_game/mlxBubbleTea/okay.mp3"),this.sound_yum=this.p5.loadSound("assets_game/mlxBubbleTea/yum.mp3"),this.sound_hurt=this.p5.loadSound("assets_game/mlxBubbleTea/hurt.mp3"),this.sound_beep=this.p5.loadSound("assets_game/mlxBubbleTea/beep.mp3"),this.sound_sugar=this.p5.loadSound("assets_game/mlxBubbleTea/sugar.mp3"),this.sound_timebeep=this.p5.loadSound("assets_game/mlxBubbleTea/timebeep.mp3"),this.sound_applause=this.p5.loadSound("assets_game/mlxBubbleTea/applause.mp3"),this.sound_burp=this.p5.loadSound("assets_game/mlxBubbleTea/burp.mp3"),this.sound_jingle=this.p5.loadSound("assets_game/mlxBubbleTea/jingle.mp3"),this.sound_powerup=this.p5.loadSound("assets_game/mlxBubbleTea/powerup.mp3")}},{key:"setup",value:function(){this.teaimage=[this.img_t1,this.img_t2,this.img_t3,this.img_t4,this.img_t5,this.img_t6,this.img_t7,this.img_t8,this.img_sugar],this.mouth=new v(this),this.lipTop=this.p5.createVector(0,0),this.lipBottom=this.p5.createVector(0,0),this.noseTip=this.p5.createVector(0,0),this.isMouthClose=!1,this.mouthRecover=0,this.prevMouthCloseStatus=!1,this.timeLimit=0,this.alpha_1=0,this.precanvas.textFont(this.font),this.teas=[],this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],111,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0),this.walls=[],this.spring=.05,this.gravity=0,this.friction=-1,console.log("Some Game Graphics usage under Premium Freepik License(Commercial License) from Freepik.com")}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.cv_width,this.cv_width),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.cv_width;var t=(this.h-110)/this.cv_height;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.cv_width*this.fullscreen_scale,this.cv_height*this.fullscreen_scale)}},{key:"draw",value:function(t){if(this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture){if(this.gameConnected||(this.gameMode="INTRO",this.teas.splice(0,this.teas.length),this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],111,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0),this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.cv_width,0)),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.cv_width,this.cv_height),this.precanvas.pop(),this.calculateMouthPos(),"PLAY"==this.gameMode)this.precanvas.push(),this.precanvas.imageMode(this.p5.CENTER),this.mouth.draw(),this.drawTeas(),this.drawWalls(),this.drawGameUI(),this.precanvas.pop();else if("INTRO"==this.gameMode)this.precanvas.push(),this.precanvas.imageMode(this.p5.CENTER),this.precanvas.image(this.img_b1,this.cv_width/2,this.cv_height/2),this.precanvas.image(this.img_direction,this.cv_width/2,this.cv_height/2+154+53+5),this.precanvas.push(),this.alpha_1+=t.deltaTime/50%50,this.precanvas.tint(255,255*t.abs(t.sin(t.TWO_PI/50*this.alpha_1))),this.precanvas.image(this.img_logo,this.cv_width/2,this.cv_height/2),this.precanvas.pop(),this.mouth.draw(),this.drawTeas(),this.precanvas.pop();else if("START"==this.gameMode)this.precanvas.push(),this.precanvas.imageMode(t.CENTER),this.precanvas.textSize(22),this.precanvas.image(this.img_b2,this.cv_width/2,this.cv_height/2,0),this.mouth.draw(),this.drawTeas(),this.precanvas.pop();else if("END"==this.gameMode){this.precanvas.push(),this.precanvas.imageMode(this.p5.CENTER),this.precanvas.textSize(22);var e=this.img_b3;"TIMEUP"==this.gameModeEnd?e=this.img_b6:"DIE"==this.gameModeEnd?e=this.img_b5:"WIN"==this.gameModeEnd&&(e=this.img_b4),this.precanvas.image(e,this.cv_width/2,this.cv_height/2,0),this.mouth.draw(),this.drawTeas(),this.precanvas.pop()}}else this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.cv_width,this.cv_height),this.precanvas.pop(),this.gameConnected=!1;this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"drawGameUI",value:function(){this.precanvas.push(),this.timeLimit<0&&(this.gameMode="END",this.gameModeEnd="TIMEUP",this.sound_burp.play(),this.walls.splice(0,this.walls.length),this.teas.splice(0,this.teas.length),this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],110,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0)),this.precanvas.imageMode(this.p5.CENTER);for(var t=0;t<this.live;t++)this.precanvas.image(this.img_heart,this.cv_width-55*t-30,30);if(this.precanvas.strokeWeight(2),this.precanvas.textSize(22),this.precanvas.stroke(0),this.precanvas.textAlign(this.p5.RIGHT,this.p5.CENTER),this.precanvas.fill(255),this.precanvas.text("Tea Left: "+this.teaCountdown,this.cv_width-220,55,210,50),this.precanvas.textAlign(this.p5.LEFT,this.p5.CENTER),this.precanvas.text("LEVEL "+this.level,5,this.cv_height-55,210,50),this.timeCountdown>0){this.precanvas.push(),this.precanvas.textAlign(this.p5.CENTER,this.p5.CENTER),this.precanvas.strokeWeight(5),this.precanvas.stroke(0),this.precanvas.fill(255,255,0),this.precanvas.textSize(70);var e=this.p5.int(this.timeCountdown/1e3);this.timeCountdown<1e3&&(this.precanvas.fill(241,148,42),e="Eat them ALL!!"),this.precanvas.text(e,0,0,this.cv_width,this.cv_height),this.precanvas.pop(),this.timeCountdown-=this.p5.deltaTime,this.freezeTime-=this.p5.deltaTime,this.freezeTime<0&&(this.sound_beep.play(),this.freezeTime=1e3)}else this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_clock,5,5,52,48),this.precanvas.strokeWeight(2),this.precanvas.stroke(0),this.timeLimit<1e4?(this.precanvas.fill(255,0,0),this.freezeTime-=this.p5.deltaTime,this.freezeTime<0&&(this.sound_timebeep.play(),this.freezeTime=1e3)):this.precanvas.fill(255,255,0),this.precanvas.textSize(30),this.precanvas.textAlign(this.p5.LEFT,this.p5.CENTER),this.timeLimit-=this.p5.deltaTime,this.precanvas.text(this.p5.floor(this.timeLimit/1e3)+1,62,5,100,48);this.precanvas.pop()}},{key:"drawWalls",value:function(){for(var t=0;t<this.walls.length;t++)this.walls[t].collide(),this.walls[t].draw()}},{key:"setupLevel1",value:function(){this.timeLimit=9e4,this.timeCountdown=4e3,this.teaCountdown=10,this.sugarCountdown=4,this.freezeTime=1e3,this.live=3,this.level=1,this.spring=.006,this.setupTeas()}},{key:"setupLevel2",value:function(){this.timeLimit=9e4,this.timeCountdown=4e3,this.teaCountdown=10,this.sugarCountdown=6,this.freezeTime=1e3,this.live=3,this.level=2,this.spring=.009,this.setupTeas(),this.walls.splice(0,this.walls.length),this.walls[0]=new d(this,147,113,122,110,this.img_w2),this.walls[1]=new d(this,615,324,122,110,this.img_w2)}},{key:"setupLevel3",value:function(){this.timeLimit=9e4,this.timeCountdown=4e3,this.teaCountdown=12,this.sugarCountdown=6,this.freezeTime=1e3,this.live=3,this.level=3,this.setupTeas(),this.spring=.01,this.walls.splice(0,this.walls.length),this.walls[0]=new d(this,147,85,88,88,this.img_w3),this.walls[1]=new d(this,147,367,88,88,this.img_w3),this.walls[2]=new d(this,647,85,88,88,this.img_w3),this.walls[3]=new d(this,647,367,88,88,this.img_w3),this.walls[4]=new d(this,327,246,194,40,this.img_w3)}},{key:"setupLevel4",value:function(){this.timeLimit=9e4,this.timeCountdown=4e3,this.teaCountdown=12,this.sugarCountdown=7,this.freezeTime=1e3,this.live=3,this.level=4,this.setupTeas(),this.spring=.02,this.walls.splice(0,this.walls.length),this.walls[0]=new d(this,176,140,117,75,this.img_w4),this.walls[1]=new d(this,135,352,110,127,this.img_w4),this.walls[2]=new d(this,479,169,211,254,this.img_w4)}},{key:"setupLevel5",value:function(){this.timeLimit=9e4,this.timeCountdown=4e3,this.teaCountdown=14,this.sugarCountdown=7,this.freezeTime=1500,this.live=3,this.level=5,this.setupTeas(),this.spring=.02,this.walls.splice(0,this.walls.length),this.walls[0]=new d(this,140,108,78,78,this.img_w1),this.walls[1]=new d(this,140,341,78,78,this.img_w1),this.walls[2]=new d(this,402,457,78,78,this.img_w1),this.walls[3]=new d(this,666,346,78,78,this.img_w1),this.walls[4]=new d(this,666,108,78,78,this.img_w1),this.walls[5]=new d(this,402,24,78,78,this.img_w1),this.walls[6]=new d(this,338,262,200,35,this.img_w1)}},{key:"drawTeas",value:function(){for(var t=this.teas.length-1;t>=0;t--)this.teas[t].markForDelete?this.teas.splice(t,1):(this.teas[t].collide(),this.teas[t].move(),this.teas[t].draw())}},{key:"calculateMouthPos",value:function(){var t=this.p5.createVector(this.lipTop.x+(this.lipBottom.x-this.lipTop.x),this.lipTop.y+(this.lipBottom.y-this.lipTop.y)),e=t.x;this.inElement.inElement.flip&&(e=this.inElement.inElement.videoWidth-t.x),this.mouth.position.x=e/this.inElement.inElement.videoWidth*this.cv_width,this.mouth.position.y=t.y/this.inElement.inElement.videoHeight*this.cv_height;var i=this.p5.abs(this.p5.dist(this.noseTip.x,this.noseTip.y,this.lipTop.x,this.lipTop.y)),s=this.p5.abs(this.p5.dist(this.lipBottom.x,this.lipBottom.y,this.lipTop.x,this.lipTop.y));if(this.isMouthClose=s<i/2,this.mouthRecover>0)this.mouthRecover-=this.p5.deltaTime;else if(this.isMouthClose&&!this.prevMouthCloseStatus){var n=this.checkEat(!0);n>1&&(this.mouth.showCombo(n),this.sound_powerup.play())}else this.checkEat(!1);this.prevMouthCloseStatus=this.isMouthClose}},{key:"checkEat",value:function(t){var e=0;if(t)for(var i=0;i<this.walls.length;i++)if(this.walls[i].collideMouth())return this.sound_hurt.play(),this.mouthRecover=3e3,0;for(i=0;i<this.teas.length;i++)if(this.teas[i].intersect(this.mouth))if(t)if(1==this.teas[i].action&&this.timeCountdown<=0){if(this.teas[i].eaten=!0,this.teas[i].vx=0,this.teas[i].vy=0,this.sound_yum.play(),this.teaCountdown--,this.teaCountdown<=0){var s=113;2==this.level?s=114:3==this.level?s=115:4==this.level&&(s=116),this.gameMode="END",this.gameModeEnd="PASS",this.sound_applause.play(),5==this.level&&(this.gameModeEnd="WIN",s=110,this.sound_applause.play(),this.sound_jingle.play()),this.walls.splice(0,this.walls.length),this.teas.splice(0,this.teas.length),this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],s,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0)}e++}else 2==this.teas[i].action&&this.timeCountdown<=0?(this.teas[i].eaten=!0,this.sound_sugar.play(),this.live--,this.live<=0&&(this.gameMode="END",this.gameModeEnd="DIE",this.sound_burp.play(),this.walls.splice(0,this.walls.length),this.teas.splice(0,this.teas.length),this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],110,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0))):110==this.teas[i].action?(this.gameMode="INTRO",this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],111,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0),this.sound_okay.play()):111==this.teas[i].action?(this.gameMode="START",this.teas[0]=new g(this,this.teaimage[this.p5.int(this.p5.random(0,8))],112,this.cv_width/2+228.5-42,this.cv_height/2+154-42,null,null,0,0),this.sound_okay.play()):112==this.teas[i].action?(this.gameMode="PLAY",this.sound_okay.play(),this.setupLevel1()):113==this.teas[i].action?(this.gameMode="PLAY",this.sound_okay.play(),this.setupLevel2()):114==this.teas[i].action?(this.gameMode="PLAY",this.sound_okay.play(),this.setupLevel3()):115==this.teas[i].action?(this.gameMode="PLAY",this.sound_okay.play(),this.setupLevel4()):116==this.teas[i].action&&(this.gameMode="PLAY",this.sound_okay.play(),this.setupLevel5());else this.teas[i].hilight=!0;else this.teas[i].hilight=!1;return e}},{key:"setupTeas",value:function(){this.teas.splice(0,this.teas.length);for(var t=0;t<this.teaCountdown+this.sugarCountdown;t++){var e=this.p5.int(this.p5.random(0,8)),i=1;t>=this.teaCountdown&&(e=8,i=2);var s=1.8,n=1.8;for(1==this.level?(s=.8,n=.8):2==this.level?(s=1,n=1):3==this.level?(s=1.2,n=1.2):4==this.level&&(s=1.4,n=1.4),this.teas[t]=new g(this,this.teaimage[e],i,this.p5.random(this.cv_width),this.p5.random(this.cv_height),this.p5.random(30,70),this.teas,this.p5.random(0,s),this.p5.random(0,n));this.checkTeaInitialPos(this.teas[t]);)this.teas[t].x=this.p5.random(this.cv_width),this.teas[t].y=this.p5.random(this.cv_height)}}},{key:"checkTeaInitialPos",value:function(t){for(var e=0;e<this.walls.length;e++)if(this.walls[e].checkTeaInitialPos(t))return!0;return!1}},{key:"doProcess",value:function(){var t=this.inElement.output;return null!=t&&t.length>0&&t[0].landmarks&&t.length>0&&(this.lipTop=this.p5.createVector(t[0].landmarks.positions[62].x,t[0].landmarks.positions[62].y),this.lipBottom=this.p5.createVector(t[0].landmarks.positions[66].x,t[0].landmarks.positions[66].y),this.noseTip=this.p5.createVector(t[0].landmarks.positions[33].x,t[0].landmarks.positions[33].y)),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}}]),i}(c)),d=function(){"use strict";function t(e,i,n,a,r,o){s(this,t),this.parent=e,this.x=i,this.y=n,this.w=a,this.h=r,this.g=this.parent.p5.createGraphics(a,r),this.g.imageMode(this.parent.p5.CORNER);for(var h=0;h<this.parent.p5.ceil(a/50);h++)for(var l=0;l<this.parent.p5.ceil(r/50);l++)this.g.image(o,50*h,50*l,50,50)}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.g,this.x,this.y,this.w,this.h),this.parent.precanvas.pop()}},{key:"collideMouth",value:function(){var t=this.parent.mouth.position.x-this.parent.p5.max(this.x,this.parent.p5.min(this.parent.mouth.position.x,this.x+this.w)),e=this.parent.mouth.position.y-this.parent.p5.max(this.y,this.parent.p5.min(this.parent.mouth.position.y,this.y+this.h));return t*t+e*e<this.parent.mouth.radius*this.parent.mouth.radius}},{key:"collide",value:function(){for(var t=0;t<this.parent.teas.length;t++)if(!this.parent.teas[t].eaten&&!this.parent.teas[t].markForDelete){var e=this.parent.p5.max(this.x,this.parent.p5.min(this.parent.teas[t].x,this.x+this.w)),i=this.parent.p5.max(this.y,this.parent.p5.min(this.parent.teas[t].y,this.y+this.h)),s=this.parent.teas[t].x-e,n=this.parent.teas[t].y-i;s*s+n*n<this.parent.teas[t].radius*this.parent.teas[t].radius&&(this.x==e?(this.parent.teas[t].x=this.x-this.parent.teas[t].radius,this.parent.teas[t].vx*=this.parent.friction):this.x+this.w==e&&(this.parent.teas[t].x=this.x+this.w+this.parent.teas[t].radius,this.parent.teas[t].vx*=this.parent.friction),this.y==i?(this.parent.teas[t].y=this.y-this.parent.teas[t].radius,this.parent.teas[t].vy*=this.parent.friction):this.y+this.h==i&&(this.parent.teas[t].y=this.y+this.h+this.parent.teas[t].radius,this.parent.teas[t].vy*=this.parent.friction))}}},{key:"checkTeaInitialPos",value:function(t){var e=t.x-this.parent.p5.max(this.x,this.parent.p5.min(t.x,this.x+this.w)),i=t.y-this.parent.p5.max(this.y,this.parent.p5.min(t.y,this.y+this.h));return e*e+i*i<t.radius*t.radius}},{key:"intersect",value:function(t){var e=this.parent.p5.abs(t.x-this.x-this.w/2);if(e>this.w/2+t.radius)return!1;var i=this.parent.p5.abs(t.y-this.y-this.h/2);if(i>this.h/2+t.radius)return!1;if(e<=this.w/2||i<=this.h/2)return!0;var s=e-this.w/2,n=i-this.h/2;return s*s+n*n<=t.radius*t.radius}}]),t}(),g=function(){"use strict";function t(e,i,n,a,r,o,h,l,u){s(this,t),this.parent=e,this.img=i,this.eaten=!1,this.scaleTime=500,this.markForDelete=!1,this.action=n,2==n?(this.size=this.parent.p5.createVector(60,60),this.diameter=60,this.radius=30):(this.size=this.parent.p5.createVector(60,68),this.diameter=60,this.radius=30),this.hilight=!1,this.x=a,this.y=r,this.vx=l,this.vy=u,this.id=o,this.others=h}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.translate(this.x,this.y),this.eaten?(this.scaleTime-=this.parent.p5.deltaTime,this.parent.precanvas.scale(this.scaleTime/500),this.scaleTime<0&&(this.markForDelete=!0),this.parent.precanvas.strokeWeight(0)):this.hilight?(this.parent.precanvas.scale(1.15),this.parent.precanvas.strokeWeight(4),this.parent.precanvas.stroke(255,252,0)):this.parent.precanvas.strokeWeight(0),this.parent.precanvas.image(this.img,0,0),this.parent.precanvas.pop(),this.px=this.x,this.py=this.y}},{key:"restorePos",value:function(){this.x=this.px,this.y=this.py}},{key:"intersect",value:function(t){if(this.eaten)return!1;var e=t.position.x-this.x,i=t.position.y-this.y;return this.parent.p5.sqrt(e*e+i*i)<t.radius+this.radius}},{key:"move",value:function(){var t=this.parent.cv_width,e=this.parent.cv_height;this.vy+=this.parent.gravity,this.x+=this.vx,this.y+=this.vy,this.x+this.radius>t?(this.x=t-this.radius,this.vx*=this.parent.friction):this.x-this.radius<0&&(this.x=this.radius,this.vx*=this.parent.friction),this.y+this.radius>e?(this.y=e-this.radius,this.vy*=this.parent.friction):this.y-this.radius<0&&(this.y=this.radius,this.vy*=this.parent.friction)}},{key:"collide",value:function(){if(null!=this.others)for(var t=0;t<this.parent.teas.length;t++)if(!this.others[t].eaten&&!this.others[t].markForDelete&&this.parent.teas[t]!=this){var e=this.others[t].x-this.x,i=this.others[t].y-this.y,s=this.parent.p5.sqrt(e*e+i*i),n=this.others[t].radius+this.radius;if(s<n){var a=this.parent.p5.atan2(i,e),r=this.x+this.parent.p5.cos(a)*n,o=this.y+this.parent.p5.sin(a)*n,h=(r-this.others[t].x)*this.parent.spring,l=(o-this.others[t].y)*this.parent.spring;this.vx-=h,this.vy-=l,this.others[t].vx+=h,this.others[t].vy+=l}}}}]),t}(),v=function(){"use strict";function t(e){s(this,t),this.parent=e,this.radius=45,this.diameter=2*this.radius,this.position=this.parent.p5.createVector(0,0),this.comboCountdown=0,this.comboText1="",this.comboText2=""}return n(t,[{key:"showCombo",value:function(t){this.comboCountdown=1500;var e=3*(t-1);this.comboText1=t+" Pieces",this.comboText2="Time +"+e,this.parent.timeLimit+=e}},{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.strokeWeight(0),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.comboCountdown>0&&(this.comboCountdown-=this.parent.p5.deltaTime,this.parent.precanvas.fill(255,255,0),this.parent.precanvas.stroke(0),this.parent.precanvas.strokeWeight(2),this.parent.precanvas.textSize(12),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.parent.precanvas.text(this.comboText1,this.position.x-60,this.position.y-this.radius-45,120,25),this.parent.precanvas.text(this.comboText2,this.position.x-60,this.position.y-this.radius-20,120,25),this.parent.precanvas.image(this.parent.img_mouth_hold,this.position.x,this.position.y)),this.parent.mouthRecover>0?(this.parent.precanvas.fill(255,0,0),this.parent.precanvas.stroke(0),this.parent.precanvas.strokeWeight(2),this.parent.precanvas.textSize(12),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.parent.precanvas.text("HIT WALL!",this.position.x-60,this.position.y-this.radius-45,120,25),this.parent.precanvas.text("Recover in "+(this.parent.p5.floor(this.parent.mouthRecover/1e3)+1),this.position.x-60,this.position.y-this.radius-20,120,25),this.parent.precanvas.image(this.parent.img_mouth_hold,this.position.x,this.position.y)):this.parent.isMouthClose?(this.parent.precanvas.fill(255,0,0,60),this.parent.precanvas.circle(this.position.x,this.position.y,this.diameter),this.parent.precanvas.image(this.parent.img_mouth_close,this.position.x,this.position.y)):(this.parent.precanvas.fill(0,0,255,60),this.parent.precanvas.circle(this.position.x,this.position.y,this.diameter),this.parent.precanvas.image(this.parent.img_mouth_open,this.position.x,this.position.y)),this.parent.precanvas.pop()}}]),t}();t.exports={mlxBubbleTeaGame:m}},37905:function(t,e,i){var s=i(62012),n=i(50450),a=i(18770),r=i(2553),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput),m=p.mlxElementModel,d=(p.mlxElementOutput,p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).numResults=0,s}return i}(m)),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="MobileNet",s.title="MobileNet",s.inType="image",s.outType="results",s.h=100,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconMobileNet.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",8,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.model=ml5.imageClassifier("MobileNet",(function(){console.log("Model MobileNet is ready"),s.ready=!0,s.label.setText("Ready")})),s}return s(i,[{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.classify(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}}]),i}(d),v=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Input",s.type="SpeechCommand",s.inType="none",s.outType="results",s.title="Speech Command",s.h=100,s.createElementMenu(),s.numResults=0,s.icon=s.mlx.createImage(n(s),"/assets/iconSoundCommand.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.outputIsReady=!1;return s.model=ml5.soundClassifier("SpeechCommands18w",{probabilityThreshold:.8},(function(){console.log("SpeechCommand18w is ready"),s.ready=!0,s.label.setText("Ready")})),s.model.classify((function(t,e){t?console.error(t):(s.numResults=e.length,s.output=e,s.inElement&&(s.inElement.outputIsReady=!1),s.label.setText("".concat(s.numResults," results found")))})),s}return s(i,[{key:"doProcess",value:function(){return this.alreadyRunInLoop=!0,this.busy=!1,this.outputIsReady=!0,!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this)}}]),i}(c),f=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="DoodleNet",s.title="DoodleNet",s.inType="image",s.outType="results",s.h=100,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconDoodleNet.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.model=ml5.imageClassifier("DoodleNet",(function(){console.log("Model DoodleNet is ready"),s.ready=!0,s.label.setText("Ready")})),s}return s(i,[{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.classify(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}}]),i}(d),x=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="PoseNet",s.title="PoseNet",s.inType="image",s.outType="tensor",s.h=100,s.showKeypoints=!0,s.showSkeleton=!0,s.showNames=!1,s.allowExtraInElement=!0,s.startPose=!1,s.overlayImage={},s.outputType=2,s.createElementMenu(),s.rawData=[],s.icon=s.mlx.createImage(n(s),"/assets/iconPoseNet.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.model=ml5.poseNet((function(){console.log("Model PoseNet is ready"),s.ready=!0,s.label.setText("Ready")})),s.model.on("pose",(function(t){if(!s.startPose)return s.busy=!1,!1;if(s.numResults=t.length,1==s.outputType)s.output=t[0].pose.keypoints.map((function(t){return[t.score,t.position.x,t.position.y]}));else if(2==s.outputType){if(s.output=[],!t.length)return s.rawData=[],s.busy=!1,!1;t[0].pose.keypoints.map((function(t){s.output.push(t.score),s.output.push(t.position.x),s.output.push(t.position.y)}))}else s.output=t;s.rawData=t,s.busy=!1,s.outputIsReady=!0,s.alreadyRunInLoop=!0,s.inElement&&(s.inElement.extraDraw=n(s)),s.label.setText("".concat(s.numResults," results found"))})),s}return s(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.showKeypointsMenu=e.addCheckedMenu("Show Keypoints",this.showKeypoints,(function(e,i){t.hideMenu(),t.showKeypoints=i})),this.showSkeletonMenu=e.addCheckedMenu("Show Skeleton",this.showSkeleton,(function(e,i){t.hideMenu(),t.showSkeleton=i})),this.showNamesMenu=e.addCheckedMenu("Show Names",this.showNames,(function(e,i){t.hideMenu(),t.showNames=i})),this.showOverlayMenu=e.addCheckedMenu("Show Overlay",this.showOverlay,(function(e,i){t.hideMenu(),t.showOverlay=i})),e.addSeparator(),this.outputTypeMenu=e.addSelectMenu(["Output Raw Data","Output Keypoints Array","Output Flatten Array"],this.outputType,(function(e,i){t.hideMenu(),t.outputType=i,0==t.outputType?t.outType="posenet":(1==t.outputType||2==t.outputType)&&(t.outType="tensor")})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){for(var t in this.inElement.output&&this.inElement.outputIsReady&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.multiPose(this.inElement.output),this.startPose=!0)),this.extraInElement){var e=this.extraInElement[t];if("Image"===e.type&&e.output&&e.outputIsReady){var i=e.imageName.split(".")[0];this.overlayImage[i]=e.output}}return!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"clearResults",value:function(){this.output=null,this.startPose=!1}},{key:"doExtraDraw",value:function(t,e){if(e.output&&e.inElement){var i=[];Object.assign(i,e.rawData),t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1)),e.showKeypoints&&e.drawKeypoints(e,t,i,!1),e.showSkeleton&&e.drawSkeletons(e,t,i),e.showNames&&e.drawNames(e,t,i),e.showOverlay&&e.drawKeypoints(e,t,i,!0),t.pop()}}},{key:"draw",value:function(t){a(l(i.prototype),"draw",this).call(this,t)}},{key:"fixPoseNet",value:function(t){return 0}},{key:"drawKeypoints",value:function(t,e,i,s){for(var n=0;n<i.length;n++)for(var a=i[n].pose,r=e.dist(a.keypoints[1].position.x,a.keypoints[1].position.y,a.keypoints[2].position.x,a.keypoints[2].position.y),o=0;o<a.keypoints.length;o++){var h=a.keypoints[o];if(h.score>.2){e.fill(0,255,0),e.noStroke();var l=r/15;if(l>30&&(l=30),l<8&&(l=8),t.inElement.videoHeight>360&&(l*=t.inElement.videoHeight/360),s){if(e.push(),e.imageMode(e.CENTER),this.overlayImage[h.part]){var u=.85*r/this.overlayImage[h.part].width;e.scale(u),e.translate((t.inElement.x+t.inElement.contentX)/u,(t.inElement.y+t.inElement.contentY)/u),e.scale(t.inElement.contentScale),e.image(this.overlayImage[h.part],h.position.x/u,h.position.y/u)}e.pop()}else{e.push();this.fixPoseNet(t);0,e.translate(t.inElement.x+t.inElement.contentX,t.inElement.y+t.inElement.contentY-0),e.scale(t.inElement.contentScale),e.ellipse(h.position.x,h.position.y,l,l),e.pop()}}}}},{key:"drawSkeletons",value:function(t,e,i){for(var s=0;s<i.length;s++)for(var n=i[s].skeleton,a=0;a<n.length;a++){var r=n[a][0],o=n[a][1];e.stroke(255,0,0),e.push();var h=this.fixPoseNet(t);e.translate(t.inElement.x+t.inElement.contentX,t.inElement.y+t.inElement.contentY-h),e.scale(t.inElement.contentScale),e.line(r.position.x,r.position.y,o.position.x,o.position.y),e.pop()}}},{key:"drawNames",value:function(t,e,i){for(var s=0;s<i.length;s++)for(var n=i[s].pose,a=0;a<n.keypoints.length;a++){var r=n.keypoints[a];if(r.score>.2){e.fill(255,255,255),e.noStroke();var o=this.inElement.contentW/50;o>30&&(o=30),o<5&&(o=5),o/=t.inElement.contentScale,e.push();var h=this.fixPoseNet(t);e.translate(t.inElement.x+t.inElement.contentX,t.inElement.y+t.inElement.contentY-h),e.scale(t.inElement.contentScale),e.push(),t.inElement.flip&&(e.translate(r.position.x,0),e.scale(-1,1),e.translate(0-r.position.x,0)),e.textSize(o),e.text(r.part,r.position.x-e.textWidth(r.part)/2,r.position.y-2*o),e.pop(),e.pop()}}}},{key:"save",value:function(){var t=a(l(i.prototype),"save",this).call(this);return t.outputType=parseInt(this.outputType),t.showKeypoints=this.showKeypoints,t.showSkeleton=this.showSkeleton,t.showNames=this.showNames,t.showOverlay=this.showOverlay,t}},{key:"load",value:function(t){a(l(i.prototype),"load",this).call(this,t),t.type==this.type&&(null!=t.outputType&&(this.outputType=t.outputType,this.outputTypeMenu.setValue(this.outputType)),null!=t.showKeypoints&&(this.showKeypoints=t.showKeypoints,this.showKeypointsMenu.value=this.showKeypoints),null!=t.showSkeleton&&(this.showSkeleton=t.showSkeleton,this.showSkeletonMenu.value=this.showSkeleton),null!=t.showNames&&(this.showNames=t.showNames,this.showNamesMenu.value=this.showNames),null!=t.showOverlay&&(this.showOverlay=t.showOverlay,this.showOverlayMenu.value=this.showOverlay))}}]),i}(m),y=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="HandPose",s.title="HandPose",s.inType="image",s.outType="tensor",s.h=100,s.outputType=2,s.outputActualWidth=640,s.rawData=[],s.showKeypoints=!0,s.showSkeleton=!0,s.showBoundingBox=!1,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconHandPose.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.model=ml5.handpose((function(){console.log("Model HandPose is ready"),s.ready=!0,s.label.setText("Ready")})),s}return s(i,[{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.predict(this.inElement.output,(function(e){t.numResults=e.length,t.numResults>0?(0==t.outputType?t.output=e:1==t.outputType?t.output=e.landmarks:(t.output=[],e.length?e[0].landmarks.map((function(e){t.output.push(e[0]),t.output.push(e[1])})):t.outputIsReady=!1),t.rawData=e,t.outputIsReady=!0):(t.rawData=e,t.output=null,t.outputIsReady=!1),t.busy=!1,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.extraDraw=t),t.label.setText("".concat(t.numResults," results found"))})))),!0}},{key:"doExtraDraw",value:function(t,e){var i=this;if(e.output&&e.inElement&&e.output.length>0){var s=[];Object.assign(s,e.rawData),t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1));var n=s;t.noFill(),t.stroke(161,95,251),t.strokeWeight(2/e.inElement.contentScale),t.push(),t.translate(e.inElement.x+e.inElement.contentX,e.inElement.y+e.inElement.contentY),t.scale(e.inElement.contentW/this.outputActualWidth);for(var a=function(s){var a=n[s];if(e.showBoundingBox){var r=a.boundingBox;t.rect(r.topLeft[0],r.topLeft[1],r.bottomRight[0]-r.topLeft[0],r.bottomRight[1]-r.topLeft[1])}if(e.showKeypoints)for(var o=0;o<a.landmarks.length;o+=1){var h=a.landmarks[o];t.fill(0,255,0),t.noStroke(),t.ellipse(h[0],h[1],10,10)}if(e.showSkeleton)for(var l={thumb:[0,1,2,3,4],indexFinger:[0,5,6,7,8],middleFinger:[0,9,10,11,12],ringFinger:[0,13,14,15,16],pinky:[0,17,18,19,20]},u=Object.keys(l),p=0;p<u.length;p++){var c=l[u[p]].map((function(t){return a.landmarks[t]}));i.drawPart(t,c,!1)}},r=0;r<n.length;r++)a(r);t.pop(),t.pop()}}},{key:"drawPart",value:function(t,e,i){t.noFill(),t.stroke(255,0,0),t.beginShape();for(var s=0;s<e.length;s++){var n=e[s][0],a=e[s][1];t.vertex(n,a)}!0===i?t.endShape(t.CLOSE):t.endShape()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.showKeypointsMenu=e.addCheckedMenu("Show Keypoints",this.showKeypoints,(function(e,i){t.hideMenu(),t.showKeypoints=i})),this.showSkeletonMenu=e.addCheckedMenu("Show Skeleton",this.showSkeleton,(function(e,i){t.hideMenu(),t.showSkeleton=i})),e.addSeparator(),this.outputTypeMenu=e.addSelectMenu(["Output Raw Data","Output Keypoints Array","Output Flatten Array"],this.outputType,(function(e,i){t.hideMenu(),t.outputType=i,0==t.outputType?t.outType="\u0e49handpose":(1==t.outputType||2==t.outputType)&&(t.outType="tensor")})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}}]),i}(m),E=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Model",s.type="FaceAPI",s.title="FaceAPI",s.inType="image",s.outType="tensor",s.h=100,s.showKeypoints=!0,s.showSkeleton=!0,s.showNames=!1,s.showOverlay=!1,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconFaceAPI.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24);return s.model=ml5.faceApi({withLandmarks:!0,withDescriptors:!1},(function(){console.log("Model FaceAPI is ready"),s.ready=!0,s.label.setText("Ready")})),s}return s(i,[{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.detect(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.extraDraw=t),t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"doExtraDraw",value:function(t,e){if(e.output&&e.inElement){t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1)),t.noFill(),t.stroke(161,95,251),t.strokeWeight(2/e.inElement.contentScale);var i=e.output;t.push(),t.translate(e.inElement.x+e.inElement.contentX,e.inElement.y+e.inElement.contentY),t.scale(e.inElement.contentScale);for(var s=0;s<i.length;s++){var n=i[s].parts.mouth,a=i[s].parts.nose,r=i[s].parts.leftEye,o=i[s].parts.rightEye,h=i[s].parts.rightEyeBrow,l=i[s].parts.leftEyeBrow;e.drawPart(t,n,!0),e.drawPart(t,a,!1),e.drawPart(t,r,!0),e.drawPart(t,l,!1),e.drawPart(t,o,!0),e.drawPart(t,h,!1)}t.pop(),t.pop()}}},{key:"drawPart",value:function(t,e,i){t.beginShape();for(var s=0;s<e.length;s++){var n=e[s]._x,a=e[s]._y;t.vertex(n,a)}!0===i?t.endShape(t.CLOSE):t.endShape()}}]),i}(m),_=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="YoLo",s.title="YoLo",s.inType="image",s.outType="results",s.h=100,s.showKeypoints=!0,s.showSkeleton=!0,s.showNames=!1,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconYOLO.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.model=ml5.YOLO((function(){console.log("Model YOLO is ready"),s.ready=!0,s.label.setText("Ready")})),s}return s(i,[{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.detect(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.extraDraw=t),t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"doExtraDraw",value:function(t,e){if(e.output&&e.inElement){t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1));for(var i=e.output,s=e.inElement.contentW,n=e.inElement.contentH,a=0;a<i.length;a++){var r=i[a].normalized,o=r.x*s+e.inElement.x+e.inElement.contentX,h=r.y*n+e.inElement.y+e.inElement.contentY,l=r.width*s,u=r.height*n;t.noStroke(),t.fill(0,255,0),t.push(),e.inElement.flip&&(t.translate(o,0),t.scale(-1,1),t.translate(0-o-l,0));var p=this.inElement.contentW/40;p>30/e.inElement.contentScale&&(p=30/e.inElement.contentScale),p<5/e.inElement.contentScale&&(p=5/e.inElement.contentScale),t.textSize(p),t.text(i[a].label,o+5,h-0),t.pop(),t.noFill(),t.strokeWeight(4),t.stroke(0,255,0),t.push(),t.rect(o,h,l,u),t.pop()}t.pop()}}}]),i}(m),w=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="UNET",s.title="UNET",s.inType="image",s.outType="image",s.segmentationImage=null,s.enable=!1,s.uNet=ml5.uNet("face"),s.ready=!1,s.allowExtraInElement=!0,s.createElementMenu(),s.h=100,s.icon=s.mlx.createImage(n(s),"/assets/iconUNET.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s}return s(i,[{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.uNet.modelReady&&(this.ready=!0,this.label.setText("Ready"))}},{key:"doProcess",value:function(){var t=this;return this.outElement&&this.outputIsReady||(this.uNet.modelReady?(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.uNet.segment(this.inElement.output,(function(e,i){if(e)console.error(e);else{if(t.segmentationImage=i.backgroundMask,t.inElement){for(var s in t.inElement.replaceImage=t.segmentationImage,t.extraInElement){var n=t.extraInElement[s];if("image"===n.outType&&"Filter"==n.category&&n.filter){t.inElement.replaceImage=n.filter(t.segmentationImage);break}}for(var a in t.extraInElement){var r=t.extraInElement[a];if("image"===r.outType&&"Input"==r.category&&r.output&&r.outputIsReady){t.inElement.backgroundImage=r.output;break}}}t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0}}))):(console.log(this.uNet),this.segmentationImage=this.inElement.output,this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0)),!0}}]),i}(m),S=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Filter",s.type="Particle",s.title="Particle Generator",s.inType="none",s.outType="image",s.h=100,s.particleW=128,s.particleH=128,s.particleImage=s.p5.createGraphics(s.particleW,s.particleH),s.particles=[],s.particle_speed=.001,s.max_particles=2e3,s.particle_size=20,s.speed_limit=100,s.run=!1,s.createParticle(),s.gravity=s.p5.createVector(0,5e-5),s.then=s.now=Date.now(),s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconParticles.jpg",1,s.mlx.mlxCaptionHeight+1,198,44),s.label=s.mlx.createLabel(n(s),"Loading...",18,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.ready=!0,s.label.setText("Ready"),s}return s(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Reset",(function(e){t.hideMenu(),t.run=!1,t.createParticle()})),e.addCommand("Explode",(function(e){t.hideMenu(),t.createParticle(),t.then=t.now=Date.now(),t.run=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"createParticle",value:function(){this.particles=[];for(var t=0;t<this.particleH;t++)for(var e=0;e<this.particleW;e++){var i=this.p5.createVector(e-this.particleW/2,t-this.particleH/2).normalize(),s=this.p5.random(1,3);i.mult(s/100);var n={position:this.p5.createVector(e,t),target:i};this.particles.push(n)}}},{key:"update",value:function(){if(a(l(i.prototype),"update",this).call(this),this.run){this.now=Date.now();var t=this.now-this.then;for(var e in this.particles){var s=this.particles[e],n=p5.Vector.mult(this.gravity,t);s.target.add(n);var r=p5.Vector.mult(s.target,t);s.position.add(r)}this.then=this.now}}},{key:"filter",value:function(t){t.loadPixels(),this.particleImage.loadPixels();for(var e=t.height/this.particleH,i=t.width/this.particleW,s=0;s<this.particleH;s++)for(var n=0;n<this.particleW;n++)this.particleImage.set(n,s,[0,0,0,0]);for(var a=0,r=0;r<this.particleH;r++){for(var o=0,h=0;h<this.particleW;h++){var l=h+r*this.particleW,u=4*(o+a*t.width),p=t.pixels[u+3];if(p){var c=t.pixels[u+0],m=t.pixels[u+1],d=t.pixels[u+2];this.particleImage.set(this.particles[l].position.x,this.particles[l].position.y,[c,m,d,p])}o+=i}a+=e}return this.particleImage.updatePixels(),this.particleImage}}]),i}(m);t.exports={mlxImageClassifier:d,mlxMobileNet:g,mlxSoundCommand18w:v,mlxDoodleNet:f,mlxPoseNet:x,mlxHandPose:y,mlxFaceAPI:E,mlxYolo:_,mlxUNET:w,mlxParticle:S}},20190:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput),m=(p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Clean the Ocean",n.category="Output",n.type="CleanTheOceanGame",n.inType="posenet",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=786,n.canvas_w=786,n.canvas_h=500,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.canvas_w/2+2*n.mlx.mlxPadding,n.h=n.canvas_h/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w/2,n.canvas_h/2),n.canvas=n.offScreen.offScreen,n.canvas.imageMode(n.p5.CORNER),n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.trashImage=[],n.DEBUG=!1,n.TICKLING_TIME=800,n.BOX_SCALE=1,n.BOX_OPEN_TIME=2500,n.PIXEL_NOSE_MOVE_BETWEEN_FRAME_ALLOWED=100,n.SCALE_DIFF_ALLOW_FOR_FACE_SPACE=1.7,n.NOT_PRESENCE_FRAME_COUNT=30,n.video,n.labelDiv,n.poseNet,n.poses=[],n.results=[],n.usersOnScreen=[],n.userHistoryCount=0,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_top=this.p5.loadImage("assets_game/mlxCleanOceanGame/top.png"),this.img_base=this.p5.loadImage("assets_game/mlxCleanOceanGame/baselayer.png"),this.img_boat=this.p5.loadImage("assets_game/mlxCleanOceanGame/boat.png"),this.img_bin=this.p5.loadImage("assets_game/mlxCleanOceanGame/bin.png"),this.img_logo=this.p5.loadImage("assets_game/mlxCleanOceanGame/whalelogo.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxCleanOceanGame/waiting.png"),this.s_pickup=this.p5.loadSound("assets_game/mlxCleanOceanGame/pickup.mp3"),this.s_collect=this.p5.loadSound("assets_game/mlxCleanOceanGame/collect.mp3"),this.s_music=this.p5.loadSound("assets_game/mlxCleanOceanGame/music.mp3");for(var t=0;t<10;t++)this.trashImage[t]=this.p5.loadImage("assets_game/mlxCleanOceanGame/trash"+(t+1)+".png")}},{key:"setup",value:function(){this.gp=this.p5.createGraphics(786,500),this.wave=new g(this),this.wave2=new g(this),this.boat=new d(this),this.showLogoTime=8e3,console.log("Some Game Graphics usage under Premium Freepik License(Commercial License) from Freepik.com")}},{key:"doProcess",value:function(){return this.results=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"getKeypoints",value:function(){this.poses.length=0;for(var t=0;t<this.results.length;t++)if(this.results[t].pose.score>=.15){this.poses.push(this.results[t]);for(var e=0;e<this.poses[this.poses.length-1].pose.keypoints.length;e++)this.poses[this.poses.length-1].pose.keypoints[e].position.x*=this.gp.width/this.inElement.inElement.videoCapture.width,this.poses[this.poses.length-1].pose.keypoints[e].position.y*=this.gp.height/this.inElement.inElement.videoCapture.height}this.MatchUserFromNosePose()}},{key:"draw",value:function(t){this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture?(this.gameConnected||(this.showLogoTime=8e3,this.gameConnected=!0),this.gp.push(),this.inElement.inElement.flip&&(this.gp.scale(-1,1),this.gp.translate(0-this.canvas_w,0)),this.gp.imageMode(this.p5.CORNER),this.gp.image(this.inElement.inElement.videoCapture,0,0,this.canvas_w,this.canvas_h),this.gp.pop(),this.drawGame()):(this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop(),this.gameConnected=!1),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"drawGame",value:function(){var t=this.gp.width,e=this.gp.height;this.gp.push(),this.DEBUG&&this.drawKeypoints(),this.gp.pop(),this.gp.push(),this.gp.image(this.img_top,0,0),this.gp.image(this.img_base,0,this.img_top.height),this.gp.pop(),this.gp.push(),this.wave.draw(this.gp,!0),this.wave2.draw(this.gp,!1),this.boat.draw(this.gp);for(var i=this.usersOnScreen.length-1;i>=0;i--)for(var s=0;s<this.usersOnScreen.length;s++)if(i!=s&&this.usersOnScreen[i].currentpose==this.usersOnScreen[s].currentpose){this.usersOnScreen.splice(i,1);break}for(i=this.usersOnScreen.length-1;i>=0;i--)this.usersOnScreen[i].waitForRemoved&&this.usersOnScreen.splice(i,1);for(s=0;s<this.usersOnScreen.length;s++)this.usersOnScreen[s].draw(this.gp);this.gp.pop(),this.showLogoTime>0&&(this.gp.push(),this.showLogoTime-=this.p5.deltaTime,this.gp.imageMode(this.p5.CENTER),this.gp.image(this.img_logo,t/2,e/2),this.gp.pop(),this.showLogoTime-this.p5.deltaTime<0&&this.s_music.play()),this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.gp,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop()}},{key:"MatchUserFromNosePose",value:function(){for(var t=this.poses.map((function(t){return t})),e=0;e<this.usersOnScreen.length;e++){var i=this.usersOnScreen[e].matchUserWithPose();if(-1!=i)for(var s=0;s<t.length;s++)if(t[s]==this.poses[i]){t.splice(s,1);break}}for(e=0;e<t.length;e++)this.usersOnScreen[this.usersOnScreen.length]=new v(this,this.userHistoryCount,t[e]),this.userHistoryCount++}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.canvas_w,this.canvas_h),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.canvas_w;var t=(this.h-110)/this.canvas_h;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.canvas_w*this.fullscreen_scale,this.canvas_h*this.fullscreen_scale)}},{key:"drawKeypoints",value:function(){for(var t=0;t<this.poses.length;t++)for(var e=this.poses[t].pose,i=0;i<e.keypoints.length;i++){var s=e.keypoints[i];s.score>.05&&(this.gp.fill(255,0,0),this.gp.noStroke(),this.gp.ellipse(s.position.x,s.position.y,10,10))}}},{key:"drawSkeleton",value:function(){for(var t=0;t<this.poses.length;t++)for(var e=this.poses[t].skeleton,i=0;i<e.length;i++){var s=e[i][0],n=e[i][1];this.gp.stroke(255,0,0),this.gp.line(s.position.x,s.position.y,n.position.x,n.position.y)}}}]),i}(c)),d=function(){"use strict";function t(e){s(this,t),this.parent=e,this.p5=this.parent.p5,this.v1=this.p5.createVector(0,103-this.parent.img_boat.height/2),this.v2=this.p5.createVector(514,103-this.parent.img_boat.height/2),this.totalTime=0,this.reverse=!1}return n(t,[{key:"draw",value:function(t){if(this.totalTime+=this.p5.deltaTime,this.totalTime>1e5&&(this.reverse=!this.reverse,this.totalTime=0),t.push(),t.imageMode(this.p5.CENTER),this.reverse){var e=(this.v1.x-this.v2.x)*(this.totalTime/1e5)+this.v2.x;t.scale(-1,1),t.image(this.parent.img_boat,-e,103-this.parent.img_boat.height/2)}else{e=(this.v2.x-this.v1.x)*(this.totalTime/1e5)+this.v1.x;t.image(this.parent.img_boat,e,103-this.parent.img_boat.height/2)}t.pop()}}]),t}(),g=function(){"use strict";function t(e){s(this,t),this.parent=e,this.p5=this.parent.p5,this.amplitude=20,this.totalTime=this.p5.random(50)}return n(t,[{key:"draw",value:function(t,e){this.totalTime+=this.p5.deltaTime,t.push(),t.noStroke(),t.fill(0,60,93,80),t.beginShape();for(var i=0;i<15;i++){var s=e?15*this.p5.sin(this.totalTime/2e3*(i+1)):15*this.p5.cos(this.totalTime/2e3*(i+1));0==i||14==i?t.vertex(786/14*i,103+this.amplitude+s):t.curveVertex(786/14*i,103+this.amplitude+s)}t.vertex(900,103+this.amplitude),t.vertex(786,501),t.vertex(0,501),t.endShape(this.p5.CLOSE),t.pop()}}]),t}(),v=function(){"use strict";function t(e,i,n){s(this,t),this.parent=e,this.p5=this.parent.p5,this.userCount=i,this.ticklingTime=this.parent.TICKLING_TIME,this.number=("000"+i).substr(-3),this.currentState="NOTRECEIVED",this.currentpose=n,this.waitForRemoved=!1,this.notPresentFrameCount=this.parent.NOT_PRESENCE_FRAME_COUNT,this.nosepos=null,this.facespace=null,this.color=this.p5.color(this.p5.random(100),this.p5.random(100),this.p5.random(100)),this.trashRandom=this.p5.floor(this.p5.random(10))}return n(t,[{key:"draw",value:function(t){if(!this.waitForRemoved)if("NOTRECEIVED"==this.currentState){if(t.push(),null!=this.facespace){t.translate(this.nosepos.x,this.nosepos.y-3.5*this.facespace),t.imageMode(this.p5.CENTER);var e=6*this.facespace*this.parent.BOX_SCALE;t.image(this.parent.trashImage[this.trashRandom],0,-e/2)}t.pop();var i=this.handCollideWithBox(t);this.ticklingTime>0&&i&&(this.ticklingTime-=this.p5.deltaTime,this.parent.s_collect.play(),t.push(),t.translate(this.nosepos.x,this.nosepos.y-3.5*this.facespace),t.rectMode(this.p5.CORNER),t.noStroke(),t.fill(0,0,0),t.rect(-30,-15,60,15),t.fill(0,255,0),t.rect(-26,-12,this.ticklingTime/this.parent.TICKLING_TIME*54,9),t.pop(),this.ticklingTime<0&&(this.ticklingTime=this.parent.BOX_OPEN_TIME,this.currentState="ANIMATED",this.parent.s_pickup.play()))}else if("ANIMATED"==this.currentState){if(this.ticklingTime-=this.p5.deltaTime,t.push(),null!=this.facespace){t.translate(this.nosepos.x,this.nosepos.y-3.5*this.facespace),t.imageMode(this.p5.CENTER);e=6*this.facespace*this.parent.BOX_SCALE;t.image(this.parent.img_bin,0,-e/2)}t.pop(),this.ticklingTime<0&&(this.currentState="RECEIVED")}else"RECEIVED"==this.currentState&&(t.push(),null!=this.facespace&&(t.translate(this.nosepos.x,this.nosepos.y-5*this.facespace),t.stroke(255),t.strokeWeight(4),t.textFont("Georgia"),t.textAlign(this.p5.CENTER),t.textSize(25),t.fill(this.color),t.text("thanks for keep our Ocean Clean",-100,-35,200,70)),t.pop())}},{key:"matchUserWithPose",value:function(){var t=this.parent.gp.width;this.parent.gp.height;this.nosepos=this.p5.createVector(t-this.currentpose.pose.keypoints[0].position.x,this.currentpose.pose.keypoints[0].position.y);for(var e=this.p5.createVector(t-this.currentpose.pose.keypoints[1].position.x,this.currentpose.pose.keypoints[1].position.y),i=[],s=0;s<this.parent.poses.length;s++)i.push(this.dist(this.p5.createVector(this.nosepos.x,this.nosepos.y),this.p5.createVector(t-this.parent.poses[s].pose.keypoints[0].position.x,this.parent.poses[s].pose.keypoints[0].position.y)));var n=i.reduce((function(t,e,i,s){return e<s[t]?i:t}),0);if(i[n]<this.parent.PIXEL_NOSE_MOVE_BETWEEN_FRAME_ALLOWED){this.facespace=this.dist(this.p5.createVector(e.x,e.y),this.p5.createVector(this.nosepos.x,this.nosepos.y));var a=this.dist(this.p5.createVector(t-this.parent.poses[n].pose.keypoints[0].position.x,this.parent.poses[n].pose.keypoints[0].position.y),this.p5.createVector(t-this.parent.poses[n].pose.keypoints[1].position.x,this.parent.poses[n].pose.keypoints[1].position.y));if(this.p5.abs(a/this.facespace)<=this.parent.SCALE_DIFF_ALLOW_FOR_FACE_SPACE)return this.currentpose=this.parent.poses[n],this.notPresentFrameCount=this.parent.NOT_PRESENCE_FRAME_COUNT,n}return this.notPresentFrameCount--,this.notPresentFrameCount<=0&&(this.waitForRemoved=!0),-1}},{key:"dist",value:function(t,e){return this.p5.sqrt(this.p5.pow(e.x-t.x,2)+this.p5.pow(e.y-t.y,2))}},{key:"handCollideWithBox",value:function(t){var e=this.parent.gp.width,i=(this.parent.gp.height,null),s=null;this.currentpose.pose.keypoints[9].score>.2&&(i=this.p5.createVector(e-this.currentpose.pose.keypoints[9].position.x,this.currentpose.pose.keypoints[9].position.y),this.parent.DEBUG&&(t.push(),t.ellipseMode(this.p5.CENTER),t.ellipse(i.x,i.y,5*this.facespace,5*this.facespace),t.pop())),this.currentpose.pose.keypoints[10].score>.2&&(s=this.p5.createVector(e-this.currentpose.pose.keypoints[10].position.x,this.currentpose.pose.keypoints[10].position.y),this.parent.DEBUG&&(t.push(),t.ellipseMode(this.p5.CENTER),t.ellipse(s.x,s.y,5*this.facespace,5*this.facespace),t.pop()));var n=6*this.facespace*this.parent.BOX_SCALE,a=5*this.facespace;return this.parent.DEBUG&&(t.push(),t.rectMode(this.p5.CORNERS),t.fill(0,0,255,50),null!=this.nosepos&&t.rect(this.nosepos.x-n/2,this.nosepos.y-3.5*this.facespace-n,this.nosepos.x+n/2,this.nosepos.y-3.5*this.facespace),t.pop()),!!(null!=i&&null!=this.nosepos&&this.intersects(i.x,i.y,a,this.nosepos.x-n/2,this.nosepos.y-3.5*this.facespace-n,this.nosepos.x+n/2,this.nosepos.y-3.5*this.facespace)||null!=s&&null!=this.nosepos&&this.intersects(s.x,s.y,a,this.nosepos.x-n/2,this.nosepos.y-3.5*this.facespace-n,this.nosepos.x+n/2,this.nosepos.y-3.5*this.facespace))}},{key:"intersects",value:function(t,e,i,s,n,a,r){var o=(t<s?s:t>a?a:t)-t,h=(e<n?n:e>r?r:e)-e;return o*o+h*h<=i*i}}]),t}();t.exports={mlxCleanOceanGame:m}},628:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput),m=p.mlxElementModel,d=p.mlxElementOutput,g=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,i(29719).mlxFeatureExtractor),v=i(37905).mlxImageClassifier,x=(i(77945).mlxVideoCapture,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Model",n.type="LicensePlateDetection",n.title="License Plate Detection",n.inType="image",n.outType="results",n.h=100,n.showKeypoints=!0,n.showSkeleton=!0,n.showNames=!1,n.createElementMenu(),n.icon=n.mlx.createImage(a(n),"/assets/iconYOLO.jpg",1,n.mlx.mlxCaptionHeight+1,198,44),n.label=n.mlx.createLabel(a(n),"Loading...",18,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.model=ml5.objectDetector("corgi_yolo",{modelUrl:"/models/license_plate_detection/model.json",inputSize:[320,240]},(function(){console.log("Model is ready"),n.ready=!0,n.label.setText("Ready")})),n}return n(i,[{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.detect(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.extraDraw=t),t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"doExtraDraw",value:function(t,e){if(e.output&&e.inElement){t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1));for(var i=e.output,s=e.inElement.contentW,n=e.inElement.contentH,a=0;a<i.length;a++){var r=i[a].normalized,o=r.x*s+e.inElement.x+e.inElement.contentX,h=r.y*n+e.inElement.y+e.inElement.contentY,l=r.width*s,u=r.height*n;t.noStroke(),t.fill(0,255,0),t.push(),e.inElement.flip&&(t.translate(o,0),t.scale(-1,1),t.translate(0-o-l,0));var p=this.inElement.contentW/40;p>30/e.inElement.contentScale&&(p=30/e.inElement.contentScale),p<5/e.inElement.contentScale&&(p=5/e.inElement.contentScale),t.textSize(p),t.text(i[a].label,o+5,h-0),t.pop(),t.noFill(),t.strokeWeight(4),t.stroke(0,255,0),t.push(),t.rect(o,h,l,u),t.pop()}t.pop()}}}]),i}(m)),y=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Model",n.type="FaceMask",n.title="Face Mask Detection",n.inType="image",n.outType="results",n.h=100,n.showKeypoints=!0,n.showSkeleton=!0,n.showNames=!1,n.createElementMenu(),n.icon=n.mlx.createImage(a(n),"/assets/iconFaceMask.jpg",1,n.mlx.mlxCaptionHeight+1,198,44),n.label=n.mlx.createLabel(a(n),"Loading...",18,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.model=ml5.objectDetector("yolo",{modelUrl:"/models/facemask_detection_320x320/model.json",imageSize:[320,320],labels:["Face","FaceMask"],filterBoxesThreshold:.3,IOUThreshold:.3,classProbThreshold:.7,anchors:[[.261834,.212104],[.706821,.630488],[1.396262,1.264643],[2.507915,2.360058],[4.007944,4.34846]]},(function(){console.log("Model is ready"),n.ready=!0,n.label.setText("Ready")})),h(n,a(n))}return n(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.downloadMenu=e.addCheckedMenu("Download Model",this.flip,(function(e,i){console.log("download model"),t.hideMenu()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.model.detect(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.extraDraw=t),t.label.setText("".concat(t.numResults," results found")))})))),!0}},{key:"doExtraDraw",value:function(t,e){if(e.output&&e.inElement){t.push(),e.inElement.flip&&(t.translate(2*(e.inElement.x+e.inElement.contentX)+e.inElement.contentW,0),t.scale(-1,1));for(var i=e.output,s=e.inElement.contentW,n=e.inElement.contentH,a=0;a<i.length;a++){var r=i[a].normalized,o=r.x*s+e.inElement.x+e.inElement.contentX,h=r.y*n+e.inElement.y+e.inElement.contentY,l=r.width*s,u=r.height*n;t.rect(o,h,5,5),t.noStroke(),t.fill(0,255,0),t.push(),e.inElement.flip&&(t.translate(o,0),t.scale(-1,1),t.translate(0-o-l,0));var p=this.inElement.contentW/40;p>30/e.inElement.contentScale&&(p=30/e.inElement.contentScale),p<5/e.inElement.contentScale&&(p=5/e.inElement.contentScale),t.textSize(p),t.text(i[a].label,o+5,h-0),t.pop(),t.noFill(),t.strokeWeight(4),0==i[a].classId?t.stroke(255,0,0):t.stroke(0,255,0),t.push(),t.rect(o,h,l,u),t.pop()}t.pop()}}}]),i}(m),E=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Input",n.type="CorgiDudeCamera",n.title="CorgiDude Camera",n.inType="none",n.outType="image",n.replaceImage=null,n.contentAspectRatio=16/9,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=320,n.contentH=240,n.contentScale=1,n.setElementSizeByContentSize(),n.resizable=!1,n.flip=!1,n.needMouse=!0,n.autoMaximize=!1,n.serialObject=null,n.createElementMenu(),n.isVideoCaptureReady=!1,n.doCaptureScreen=!1,n.corgihub=window.CorgiHub.getInstance(),n.doCreateVideoCapture(),n.corgihub.register("video",n.constructor.name,n.setVideo.bind(a(n))),setTimeout((function(){n.corgihub.send({cmd:"start_camera"})}),500),console.log("video capture ready"),n.outputIsReady=!0,n.busy=!1,n.beepSound=n.p5.loadSound("/assets/shutterbeep.mp3"),n.shutterSound=n.p5.loadSound("/assets/shuttersound.mp3"),n.ready=!0,n}return n(i,[{key:"opened",value:function(){this.ready=!0}},{key:"setVideo",value:function(t){this.videoCapture.loadPixels();var e=new Uint8ClampedArray(t.data);this.videoCapture.pixels.set(e.slice(2)),this.videoCapture.updatePixels()}},{key:"doCreateVideoCapture",value:function(){this.ready&&this.videoCapture.remove();try{this.ready=!1,this.isVideoCaptureReady=!1,this.videoRawWidth=320,this.videoRawHeight=240,this.videoCapture=this.mlx.p5.createImage(this.videoRawWidth,this.videoRawHeight),this.contentAspectRatio=this.videoRawWidth/this.videoRawHeight,this.videoWidth=this.w-2*this.mlx.mlxPadding,this.videoHeight=this.videoWidth/this.contentAspectRatio,this.contentW=this.videoWidth,this.contentH=this.videoHeight,this.setElementSizeByContentSize(),this.isMaximize&&this.scaleContentToFillSize(!1),this.autoMaximize&&this.enterMaximize(),this.output=this.videoCapture}catch(t){console.log("ERROR",t),this.ready=!1}}},{key:"save",value:function(){var t=r(l(i.prototype),"save",this).call(this);return t.flip=this.flip,t.autoMaximize=this.autoMaximize,t}},{key:"load",value:function(t){r(l(i.prototype),"load",this).call(this,t),this.flip=t.flip,this.flipMenu.value=this.flip,t.autoMaximize?this.autoMaximize=t.autoMaximize:this.autoMaximize=!1,this.autoMaxMenu.value=this.autoMaximize,this.autoMaximize&&(this.lockMaximize=!0,this.enterMaximize())}},{key:"setVideoCaptureSize",value:function(){this.videoWidth=this.contentW,this.videoHeight=this.contentH,this.videoCapture.resize(this.videoWidth,this.videoHeight),console.log(this.videoWidth,this.videoHeight)}},{key:"resizeByMouse",value:function(){r(l(i.prototype),"resizeByMouse",this).call(this),this.setVideoCaptureSize()}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.setVideoCaptureSize()}},{key:"enterMaximize",value:function(){r(l(i.prototype),"enterMaximize",this).call(this)}},{key:"exitMaximize",value:function(){r(l(i.prototype),"exitMaximize",this).call(this),this.isMaximize=!1,this.maxMenu.value=!1}},{key:"captureScreen",value:function(){this.captureCountdown=2999,this.captureBeepCountdown=0,this.doCaptureScreen=!0}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.maxMenu=e.addCheckedMenu("Maximize",this.isMaximize,(function(e,i){t.hideMenu(),t.isMaximize=i,t.isMaximize?t.enterMaximize():t.exitMaximize()})),this.autoMaxMenu=e.addCheckedMenu("Auto Maximize",this.autoMaximize,(function(e,i){t.hideMenu(),t.autoMaximize=i})),e.addSeparator(),e.addCommand("Capture Canvas",(function(e){t.hideMenu(),t.captureScreen()})),e.addSeparator(),this.flipMenu=e.addCheckedMenu("Flip",this.flip,(function(e,i){t.hideMenu(),t.flip=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"remove",value:function(){this.videoCapture&&(this.videoCapture=null),this.corgihub.send({cmd:"stop_camera"}),this.corgihub.remove("video",this.constructor.name),r(l(i.prototype),"remove",this).call(this)}},{key:"doProcess",value:function(){return this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0,!0}},{key:"doDraw",value:function(t){this.backgroundImage&&t.image(this.backgroundImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH),this.replaceImage?t.image(this.replaceImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH):t.image(this.videoCapture,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH)}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),this.ready&&(this.noDraw||(t.push(),this.flip&&(t.translate(2*(this.x+this.contentX)+this.contentW,0),t.scale(-1,1)),this.doDraw(t),t.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(t,this.extraDraw),this.doCaptureScreen))if(this.captureCountdown-=t.deltaTime,this.captureCountdown>0)this.captureBeepCountdown-=t.deltaTime,this.captureBeepCountdown<0&&(null!=this.beepSound&&this.beepSound.isLoaded()&&this.beepSound.play(),this.captureBeepCountdown=1e3),t.push(),t.fill(255),t.textSize(40),t.text(t.floor(this.captureCountdown/1e3)+1,this.x+this.contentX+this.contentW-50,this.y+this.contentY,50,50),t.pop();else{null!=this.shutterSound&&this.shutterSound.isLoaded()&&this.shutterSound.play(),t.push(),t.resetMatrix(),t.translate(0,0),t.scale(1);var e=t.createGraphics(t.width,t.height);this.noDraw||(e.push(),this.flip&&(e.translate(2*(this.x+this.contentX)+this.contentW,0),e.scale(-1,1)),this.doDraw(e),e.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(e,this.extraDraw),e.get(this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH).save("myVideoCanvas.jpg"),t.pop(),this.doCaptureScreen=!1}}},{key:"mousePressed",value:function(){r(l(i.prototype),"mousePressed",this).call(this),3==this.p5.touches.length&&this.exitMaximize()}}]),i}(c),_=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Model",n.type="MobileNet",n.title="MobileNet",n.inType="image",n.outType="results",n.h=100,n.createElementMenu(),n.icon=n.mlx.createImage(a(n),"/assets/iconMobileNet.jpg",1,n.mlx.mlxCaptionHeight+1,198,44),n.label=n.mlx.createLabel(a(n),"Loading...",8,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.model=ml5.imageClassifier("http://localhost:8089/models/transfer_mb25_224/model.json",(function(){console.log("Model MobileNet is ready"),n.ready=!0,n.label.setText("Ready")})),n}return n(i,[{key:"doProcess",value:function(){var t=this;return this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),ml5.tf.tidy((function(){var e=t.inElement.output.elt;e instanceof ml5.tf.Tensor||(e=ml5.tf.browser.fromPixels(e));var i=ml5.tf.scalar(127.5),s=224,n=e.toFloat().sub(i).div(i),a=n;if(e.shape[0]!==s||e.shape[1]!==s){a=ml5.tf.image.resizeBilinear(n,[224,224],!0)}var r=a.reshape([-1,s,s,3]),o=t.model.model.execute(r,"conv_preds"),h=o.dataSync();console.log(o),console.log(h)})))),!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}}]),i}(v),w=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;s(this,i),(n=e.call(this,t)).category="Model",n.type="CorgiDudeMobileNetClassifier",n.title="CorgiDude MobileNet Classifier",n.inType="image",n.outType="results",n.w=400,n.h=100,n.createElementMenu(),n.mode="classify",n.needMouse=!0,n.classNames=["A","B","C","D","E"],n.currentClass="A",n.classes=[],n.counts=[0,0,0,0,0],n.currentClassIndex=0,n.classifier=null,n.trained=!1,n.losses=[],n.highestLoss=0,n.icon=n.mlx.createImage(a(n),"/assets/iconMobileNetClassifier.jpg",1,n.mlx.mlxCaptionHeight+1,398,44),n.label=n.mlx.createLabel(a(n),"Loading...",8,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.categoryMenu=n.mlx.createMenu(a(n),10,n.mlx.mlxCaptionHeight+44+10),n.select=n.categoryMenu.addSelectMenu(["A","B","C","D","E"],-1,(function(t,e){n.inElement&&n.inElement.output&&e>=0&&(n.currentClass=n.classNames[e],n.currentClassIndex=e)})),n.categoryMenu.w=75,n.trainLogX=95,n.trainLogY=n.mlx.mlxCaptionHeight+44+10,n.trainLogW=n.w-105,n.trainLogH=n.categoryMenu.h,console.log(n.categoryMenu.h),n.labelTrain=n.mlx.createLabel(a(n),"No training data",n.trainLogX,n.trainLogY+n.trainLogH+4,n.trainLogW,24),n.getButton=n.mlx.createButton(a(n),"add",(function(){n.inElement&&n.inElement.output&&(console.log("add",n.currentClass),n.counts[n.currentClassIndex]+=1,n.select.setTitle(n.currentClassIndex,"".concat(n.currentClass," (").concat(n.counts[n.currentClassIndex],")")),n.classifier.addImage(n.inElement.output,n.currentClass),-1==n.classes.indexOf(n.currentClass)&&n.classes.push(n.currentClass))}),10,205,75,24),n.getButton.border=!0,n.getButton.hidden=!0,n.trainButton=n.mlx.createButton(a(n),"train",(function(){if(console.log("train"),n.inElement&&n.inElement.output&&n.classifier){var t=n.features.infer(n.inElement.output,"logis").dataSync();console.log(ml5.tf.argMax(t).dataSync()),console.log(ml5.tf.max(t).dataSync())}}),n.w-72,n.h-28,68,24),n.trainButton.border=!0;try{n.features=ml5.featureExtractor("MobileNet",{numLabels:5,mobilenetURL:"http://localhost:8089/models/transfer_mb25_224/layers/model.json",graphModelURL:"http://localhost:8089/models/transfer_mb25_224/graph/model.json",embeddingLayer:"StatefulPartitionedCall/mobilenet_0.25_224/reshape_2/Reshape"},(function(){console.log("MobileNet Feature Extractor is ready"),n.ready=!0,n.label.setText("Ready (No trained data)"),console.log(n.features),n.getButton.hidden=!1}))}catch(r){console.log(r)}return n.h+=160,n.label.yy+=160,n.trainButton.yy+=160,n.classifier=n.features.classification((function(){})),n}return n(i,[{key:"doProcess",value:function(){var t=this;return!!this.trained&&(this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.classifier.classify(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0)}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready (Trained)"):this.label.setText("Ready (No trained data)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0),t.rect(this.x+this.trainLogX,this.y+this.trainLogY,this.trainLogW,this.trainLogH),!this.drawed){var e=.9*this.trainLogH/this.highestLoss,s=this.y+this.trainLogY+this.trainLogH,n=this.x+this.trainLogX,a=this.trainLogW/this.losses.length;a>10&&(a=10),t.beginShape();for(var o=0;o<this.losses.length;o++){var h=s-e*this.losses[o];t.vertex(n+o*a,h)}t.endShape()}}}]),i}(g),S=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Model",n.type="CorgiDudeMobileNetRegressor",n.title="MobileNet Regressor",n.inType="image",n.outType="results",n.w=400,n.h=100,n.createElementMenu(),n.mode="regression",n.needMouse=!0,n.currentClassIndex=0,n.trained=!1,n.losses=[],n.highestLoss=0,n.regressor=null,n.currentValue=0,n.counts=0,n.icon=n.mlx.createImage(a(n),"/assets/iconMobileNetRegressor.jpg",1,n.mlx.mlxCaptionHeight+1,398,44),n.label=n.mlx.createLabel(a(n),"Loading...",8,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.slider=n.mlx.createVerticalSlider(a(n),(function(t){n.currentValue=t}),n.currentValue,0,1,20,n.mlx.mlxCaptionHeight+44+10,15,122),n.trainLogX=95,n.trainLogY=n.mlx.mlxCaptionHeight+44+10,n.trainLogW=n.w-105,n.trainLogH=122,n.labelTrain=n.mlx.createLabel(a(n),"No training data",n.trainLogX,n.trainLogY+n.trainLogH+4,n.trainLogW,24),n.getButton=n.mlx.createButton(a(n),"add",(function(){n.inElement&&n.inElement.output&&(console.log("add",n.currentValue),n.counts+=1,n.regressor.addImage(n.inElement.output,n.currentValue),n.labelTrain.setText("".concat(n.counts," data was added.")))}),10,205,75,24),n.getButton.border=!0,n.trainButton=n.mlx.createButton(a(n),"train",(function(){console.log("train"),n.inElement&&n.inElement.output&&n.regressor&&(n.losses=[],n.highestLoss=0,n.regressor.train((function(t){t?(n.loss=t,console.log("Loss: "+n.loss),n.labelTrain.setText("Loss: "+n.loss),n.losses.push(t),t>n.highestLoss&&(n.highestLoss=t),n.drawed=!1):(console.log("Done Training! Final Loss: "+n.loss),n.labelTrain.setText("Done Training! Final Loss: "+n.loss),n.trained=!0,n.drawed=!1)})))}),n.w-72,n.h-28,68,24),n.trainButton.border=!0,n.features=ml5.featureExtractor("MobileNet",(function(){console.log("MobileNet Feature Extractor is ready"),n.ready=!0,n.label.setText("Ready (No trained data)"),console.log(n.features)})),n.h+=160,n.label.yy+=160,n.trainButton.yy+=160,n.regressor=n.features.regression((function(){console.log("Regression Ready"),n.getButton.hidden=!1})),n}return n(i,[{key:"doProcess",value:function(){var t=this;return!!this.trained&&(this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.regressor.predict(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=1,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0)}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready (Trained)"):this.label.setText("Ready (No trained data)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0),t.rect(this.x+this.trainLogX,this.y+this.trainLogY,this.trainLogW,this.trainLogH),!this.drawed){var e=.9*this.trainLogH/this.highestLoss,s=this.y+this.trainLogY+this.trainLogH,n=this.x+this.trainLogX,a=this.trainLogW/this.losses.length;a>10&&(a=10),t.beginShape();for(var o=0;o<this.losses.length;o++){var h=s-e*this.losses[o];t.vertex(n+o*a,h)}t.endShape()}}}]),i}(g),k=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="CorgiDudeIDE",n.title="CorgiDude Micropython IDE",n.inType="all",n.outType="none",n.createElementMenu(),n.needMouse=!0,n.resizable=!0,n.contentX=0,n.contentY=n.mlx.mlxCaptionHeight,n.w=700,n.h=600,n.contentW=n.w-1,n.contentH=n.h-n.mlx.mlxPadding,n.contentAspectRatio=3,n.divX=n.contentX,n.divY=n.contentY,n.divW=n.contentW,n.divH=n.contentH,n.h+=45,n.div=t.p5.createDiv(),n.div.size(n.divW,n.divH),n.div.position(n.x+n.divX,n.y+n.divY+n.mlx.mlxNavBarHeight),n.div.style("background-color","#FFFFFF"),n.div.style("text-align","left"),n.div.addClass("js-editor"),n.label=n.mlx.createLabel(a(n),"Ready",n.mlx.mlxPadding,n.h-26,n.w-2*n.mlx.mlxPadding-5,24),n.outputIsReady=!1,n.ready=!0,n.busy=!1,n.editor=window.monaco.editor.create(n.div.elt,{value:"import sensor, image, time, lcd\nlcd.init(type=2)\nsensor.reset()\nsensor.set_pixformat(sensor.RGB565)\nsensor.set_framesize(sensor.QVGA)\nsensor.skip_frames(time = 2000)\nwhile(True):\n    img = sensor.snapshot()\n    lcd.display(img)",language:"python",theme:"vs-dark"}),n.corgihub=window.CorgiHub.getInstance(),n}return n(i,[{key:"save",value:function(){var t=r(l(i.prototype),"save",this).call(this),e=this.editor.getValue();return t.code=e,t}},{key:"load",value:function(t){r(l(i.prototype),"load",this).call(this,t);var e=t.code;this.editor.getModel().setValue(e)}},{key:"inactivateUI",value:function(){this.div.style("display","none")}},{key:"activateUI",value:function(){this.div.style("display","block")}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Run",(function(e){t.hideMenu();var i=t.editor.getValue();t.corgihub.send({cmd:"run",code:i}),t.activateUI()})),e.addCommand("Upload File",(function(e){t.hideMenu();var i=$(document.createElement("input"));i.attr("type","file"),i.trigger("click"),f=files[0];new FileReader;t.activateUI()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"resizeByMouse",value:function(){r(l(i.prototype),"resizeByMouse",this).call(this)}},{key:"setContentSizeByElementWidth",value:function(){this.label.yy=this.h-26,this.label.resize(this.w-2*this.mlx.mlxPadding-5,this.label.h),this.div.size(this.w*this.mlx.userScale-1,this.h*this.mlx.userScale-45-this.mlx.mlxPadding),this.editor.layout()}},{key:"doProcess",value:function(){return this.outputIsReady=!1,this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.divX,s=this.y+this.divY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale)}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.setPosition(this.x,this.y)}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t)}}]),i}(d);t.exports={mlxCorgiDudeCamera2:E,mlxCorgiDudeMobileNetRegressor:S,mlxCorgiDudeMobileNetClassifier:w,mlxLicensePlateDetector:x,mlxFaceMaskDetector:y,mlxCorgiDudeMobileNet:_,mlxCorgiDudeIDE:k}},56856:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput),m=(p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,i(98143)),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Input",n.type="Spectrogram",n.title="CorgiDude Audio",n.inType="audio",n.outType="tensor",n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=256,n.contentH=256,n.w=n.contentW+2*n.mlx.mlxPadding,n.h=n.contentH+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.text="",n.detectWord=!0,n.createElementMenu(),n.grx=t.p5.createGraphics(256,256),n.grx.background(0),n.label=n.mlx.createLabel(a(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.fft=new p5.FFT(.8,256),n.label.hidden=!0,n.busy=!1,n.outputIsReady=!1,n.corgihub=window.CorgiHub.getInstance(),n.corgihub.register("audio",n.constructor.name,(function(t){var e=new Uint8ClampedArray(t.data).slice(2);n.fft_data=e,n.ready=!0,console.log("audio ready!")})),setTimeout((function(){n.ready=!1,n.corgihub.send({cmd:"run",code:m})}),500),n}return n(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Run Code",(function(e){t.hideMenu(),t.ready=!1,t.corgihub.send({cmd:"run",code:m})})),e.addSeparator(),e.addCheckedMenu("Detect Word",this.detectWord,(function(e,i){t.hideMenu(),t.detectWord=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.busy=!1,this.outputIsReady&&(this.output=this.fft_data),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t);var e=this.fft_data||[0];this.grx.image(this.grx,-2,0),this.grx.colorMode(t.HSB,255);for(var s=0;s<e.length/2;s++){var n=t.map(1.5*e[s],0,255,0,255);this.grx.stroke(n,255,255),this.grx.point(254,255-2*s-1),this.grx.point(254,255-2*s),this.grx.point(255,255-2*s-1),this.grx.point(255,255-2*s)}var a=this.x+this.contentX,o=this.y+this.contentY;(t.image(this.grx,a,o),this.detectWord)?e.reduce((function(t,e){return t+e}))>1e4&&512==this.fft_data.length&&(console.log("[audio]ready"),this.output=this.fft_data,this.outputIsReady=!0):this.fft_data&&512==this.fft_data.length&&(this.output=this.fft_data,this.outputIsReady=!0)}}]),i}(c);t.exports={mlxCorgiDudeAudio:d}},46120:function(t,e,i){var s=i(50450),n=i(18770),a=i(9807),r=i(27690),o=i(99828),h=i(2553),l=i(62012);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=o(t);if(e){var n=o(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return r(this,i)}}var p,c=0,m=function(){"use strict";function t(e){h(this,t),this.mlx=e,this.p5=e.p5,this.category=null,this.type=null,this.inType=null,this.outType=null,this.x=100,this.y=100,this.w=200,this.h=100,this.colorBackground=this.p5.color(240),this.div=null,this.ready=!1,this.busy=!1,this.alreadyRunInLoop=!1,this.outputIsReady=!1,this.noDraw=!1,this.inElement=null,this.outElement=null,this.replaceImage=null,this.backgroundImage=null,this.extraInElement=[],this.allowExtraInElement=!1,this.linkMoving=!1,this.resizable=!1,this.resizing=!1,this.isHighlight=!1,this.children=[],this.title=null,this.extraDraw=null,this.needMouse=!1,this.needResults=null,this.isFullScreen=!1,this.autoMaximize=!1,this.lockMaximize=!1}return l(t,[{key:"createDiv",value:function(t,e,i,s,n){this.divX=t,this.divY=e,this.divW=i,this.divH=s,this.div=mlx.p5.createDiv(),this.div.html(n),this.div.size(this.divW,this.divH),this.div.position(this.x+this.divX,this.y+this.divY)}},{key:"scaleContentToFillSize",value:function(t){}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e,this.div&&this.div.position(this.x+this.divX,this.y+this.divY+this.mlx.mlxNavBarHeight)}},{key:"save",value:function(){return{type:this.type,x:this.x,y:this.y,w:this.w,h:this.h,outElementIndex:parseInt(this.getOutElementIndex()),outExtraElementIndex:parseInt(this.getOutExtraElementIndex())}}},{key:"getOutElementIndex",value:function(){return this.outElement&&this.outElement.inElement==this?this.mlx.getElementIndex(this.outElement):-1}},{key:"getOutExtraElementIndex",value:function(){return this.outElement&&this.outElement.inElement!=this?this.mlx.getElementIndex(this.outElement):-1}},{key:"load",value:function(t){t.type==this.type&&(this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h)}},{key:"remove",value:function(){this.div&&this.div.remove()}},{key:"refresh",value:function(){}},{key:"clearResults",value:function(){}},{key:"process",value:function(){return!1}},{key:"doProcess",value:function(){return!1}},{key:"update",value:function(){}},{key:"mouseWheel",value:function(t){if(this.needMouse)for(var e in this.children){var i=this.children[e];if(!i.hidden&&i.mouseWheel&&!i.mouseWheel(t))return!1}return!0}},{key:"mousePressed",value:function(){if(this.needMouse)for(var t in this.children){var e=this.children[t];if(!e.hidden&&!e.mousePressed())return!1}return!0}},{key:"mouseReleased",value:function(){if(this.needMouse)for(var t in this.children){var e=this.children[t];if(!e.hidden&&!e.mouseReleased())return!1}return!0}},{key:"mouseMoved",value:function(){}},{key:"mouseDragged",value:function(){if(this.needMouse)for(var t in this.children){this.children[t].mouseDragged()}}},{key:"enterMaximize",value:function(){}},{key:"exitMaximize",value:function(){}},{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"_createMenu",value:function(){if(!this.menu)return this.menu=this.mlx.createMenu(this,10,this.mlx.mlxCaptionHeight),this.menu.hidden=!0,this.menu.alwaysOnTop=!0,this.menu}},{key:"hidePopup",value:function(t){for(var e in this.mlx.popup){var i=this.mlx.popup[e];i==t&&(this.mlx.popup.splice(e,this.mlx.popup.length-e),i.hidden=!0)}}},{key:"hideMenu",value:function(){if(this.menu)for(var t in this.menu.hidden=!0,this.mlx.popup){this.mlx.popup[t]==this.menu&&this.mlx.popup.splice(t,this.mlx.popup.length-t)}}},{key:"updateUI",value:function(){for(var t in this.children){this.children[t]._update()}}},{key:"drawUI",value:function(t){for(var e in this.children){var i=this.children[e];0!=i.hidden||i.alwaysOnTop||i._draw(t)}}},{key:"drawUITop",value:function(t){for(var e in this.children){var i=this.children[e];0==i.hidden&&i.alwaysOnTop&&i._draw(t)}}},{key:"toggleMenu",value:function(){this.menu&&(this.menu.hidden=!this.menu.hidden,0==this.menu.hidden?(this.inactivateUI(),this.mlx.popup.push(this.menu)):this.activateUI())}},{key:"inactivateUI",value:function(){}},{key:"activateUI",value:function(){}},{key:"isHitMenuButton",value:function(t,e){return t>this.x+10&&t<this.x+20&&e>this.y+8&&e<this.y+26}},{key:"isHitElement",value:function(t,e){return t>this.x&&t<this.x+this.w&&e>this.y&&e<this.y+this.h}},{key:"isHitSizer",value:function(t,e){return!!this.resizable&&(t>this.x+this.w-10&&t<this.x+this.w&&e>this.y+this.h-10&&e<this.y+this.h)}},{key:"isHitCaptionBar",value:function(t,e){return t>this.x&&t<this.x+this.w&&e>this.y&&e<this.y+this.mlx.mlxCaptionHeight}},{key:"isHitInputLink",value:function(t,e){var i=this.mlx.mlxLinkSize/2+1;return!!(this.inElement&&0==this.inElement.linkMoving&&t>this.inputLinkX-i&&t<this.inputLinkX+i&&e>this.inputLinkY-i&&e<this.inputLinkY+i)}},{key:"isHitOutputLink",value:function(t,e){var i=this.mlx.mlxLinkSize/2+1;return!this.outElement&&0==this.linkMoving&&t>this.outputLinkX-i&&t<this.outputLinkX+i&&e>this.outputLinkY-i&&e<this.outputLinkY+i}},{key:"updateOutputLinkPosition",value:function(){0==(this.linkMoving?this.mlx.mouseY>this.y+this.h+20?0:1:!this.outElement||this.outElement.y>this.y+this.h+20?0:1)?(this.outputLinkX=this.x+this.w/2,this.outputLinkY=this.y+this.h,this.outputLinkCtrlX=0,this.outputLinkCtrlY=1):(this.outputLinkX=this.x+this.w,this.outputLinkY=this.y+this.h/2+this.mlx.mlxCaptionHeight/2,this.outputLinkCtrlX=1,this.outputLinkCtrlY=0)}},{key:"updateInputLinkPosition",value:function(){this.inElement&&(this.y>this.inElement.y+this.inElement.h?(this.inputLinkX=this.x+this.w/2,this.inputLinkY=this.y,this.inputLinkCtrlX=0,this.inputLinkCtrlY=-1,this.inputLinkAngle=90):(this.inputLinkX=this.x,this.inputLinkY=this.y+this.h/2+this.mlx.mlxCaptionHeight/2,this.inputLinkCtrlX=-1,this.inputLinkCtrlY=0,this.inputLinkAngle=0))}},{key:"draw",value:function(t){if(this.mlx.fullScreenElement!=this&&!this.mlx.maximizedElement){t.fill(this.colorBackground),t.noStroke(),t.rect(this.x,this.y,this.w,this.h,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize),t.fill(64),t.rect(this.x,this.y,this.w,this.mlx.mlxCaptionHeight,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize,0,0),this.resizable&&(t.stroke(192),t.strokeWeight(2),t.line(this.x+this.w-15,this.y+this.h,this.x+this.w,this.y+this.h-15),t.line(this.x+this.w-10,this.y+this.h,this.x+this.w,this.y+this.h-10)),t.stroke(0),t.noFill(),this.isHighlight?(t.stroke(this.mlx.getLinkColor(this.inType)),t.strokeWeight(5),t.rect(this.x-2,this.y-2,this.w+4,this.h+4,this.mlx.mlxCornerSize+2,this.mlx.mlxCornerSize+2,this.mlx.mlxCornerSize+2,this.mlx.mlxCornerSize+2),t.stroke(0),t.strokeWeight(1)):(t.stroke(0),t.strokeWeight(1)),t.rect(this.x,this.y,this.w,this.h,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize,this.mlx.mlxCornerSize),t.stroke(0),t.strokeWeight(1),t.line(this.x,this.y+this.mlx.mlxCaptionHeight,this.x+this.w,this.y+this.mlx.mlxCaptionHeight),t.stroke(255);var e=this.y+8;t.line(this.x+10,e,this.x+20,e),t.line(this.x+10,e+4,this.x+20,e+4),t.line(this.x+10,e+8,this.x+20,e+8),this.title&&(t.fill(255),t.noStroke(),t.textSize(14),t.textAlign(t.LEFT,t.TOP),t.text(this.title,this.x+30,this.y+1)),t.stroke(0),this.ready?(t.fill(0,192,0),this.outputIsReady&&t.fill(10,255,0)):t.fill(255,0,0),t.ellipse(this.x+this.w-12,this.y+12,10,10)}}},{key:"linkTo",value:function(t){this.outElement=t,t.inElement=this,this.outLinkWeight=3}},{key:"linkToExtra",value:function(t){t.allowExtraInElement&&(this.outElement=t,t.extraInElement.push(this),this.outLinkWeight=1)}},{key:"clearLinkTo",value:function(){if(this.outElement){if(this.outElement.inElement==this){for(var t=this.outElement.extraInElement.length-1;t>=0;t--){this.outElement.extraInElement[t].clearLinkTo(this.outElement)}this.outElement.inElement=null}else{var e=this.outElement.extraInElement.indexOf(this);this.outElement.extraInElement.splice(e,1)}this.extraDraw&&(this.extraDraw=null),this.backgroundImage&&(this.backgroundImage=null),this.replaceImage&&(this.replaceImage=null),this.outElement=null,this.outputIsReady=!1}}},{key:"drawLink",value:function(t){if(!this.mlx.maximizedElement){if(t.push(),this.linkMoving){t.stroke(128),t.strokeWeight(1),t.noFill();var e=2*Math.abs(this.mlx.mouseX-this.outputLinkX)/3,i=2*Math.abs(this.mlx.mouseY-this.outputLinkY)/3;t.bezier(this.outputLinkX,this.outputLinkY,this.outputLinkX+e*this.outputLinkCtrlX,this.outputLinkY+i*this.outputLinkCtrlY,this.mlx.mouseX-e*this.outputLinkCtrlX,this.mlx.mouseY-i*this.outputLinkCtrlY,this.mlx.mouseX,this.mlx.mouseY)}else if(this.outElement){t.stroke(0),t.strokeWeight(this.outLinkWeight),t.noFill();var s=2*Math.abs(this.outElement.inputLinkX-this.outputLinkX)/3,n=2*Math.abs(this.outElement.inputLinkY-this.outputLinkY)/3;t.bezier(this.outputLinkX,this.outputLinkY,this.outputLinkX+s*this.outputLinkCtrlX,this.outputLinkY+n*this.outputLinkCtrlY,this.outElement.inputLinkX+s*this.outElement.inputLinkCtrlX,this.outElement.inputLinkY+n*this.outElement.inputLinkCtrlY,this.outElement.inputLinkX,this.outElement.inputLinkY)}t.pop()}}},{key:"drawOutputLink",value:function(t){this.mlx.maximizedElement||this.mlx.fullScreenElement!=this&&(t.stroke(0),t.strokeWeight(1),t.fill(this.mlx.getLinkColor(this.outType)),t.ellipse(this.outputLinkX,this.outputLinkY,this.mlx.mlxLinkSize,this.mlx.mlxLinkSize,0))}},{key:"drawInputLink",value:function(t){}},{key:"polygon",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.p5.TWO_PI/s,r=this.p5.radians(n);this.p5.beginShape();for(var o=r;o<this.p5.TWO_PI+r;o+=a){var h=t+this.p5.cos(o)*i,l=e+this.p5.sin(o)*i;this.p5.vertex(h,l)}this.p5.endShape(this.p5.CLOSE)}},{key:"resizeByMouse",value:function(){var t=this.mlx.mouseX-this.x,e=this.mlx.mouseY-this.y;this.w=t,this.h=e,this.setContentSizeByElementWidth()}},{key:"setContentSizeByElementWidth",value:function(){}}]),t}(),d=function(t){"use strict";a(i,t);var e=u(i);function i(t){var s;return h(this,i),(s=e.call(this,t)).type="input",s.category="Input",s.x=100,s.y=100,s}return l(i,[{key:"process",value:function(){return!!this.ready&&(!this.busy&&(!!this.alreadyRunInLoop||this.doProcess()))}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.updateOutputLinkPosition()}},{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t)}},{key:"setContentSizeByElementWidth",value:function(){this.contentW=this.w-2*this.mlx.mlxPadding,this.contentH=this.contentW/this.contentAspectRatio}},{key:"w2h",value:function(t){return(t-2*this.mlx.mlxPadding)/this.contentAspectRatio+this.mlx.mlxCaptionHeight+2*this.mlx.mlxPadding}},{key:"h2w",value:function(t){return(t-this.mlx.mlxCaptionHeight-2*this.mlx.mlxPadding)*this.contentAspectRatio+2*this.mlx.mlxPadding}},{key:"resizeByMouse",value:function(){var t=this.mlx.mouseX-this.x,e=this.mlx.mouseY-this.y,i=this.w2h(t);i<e?(this.w=this.h2w(e),this.h=e):(this.w=t,this.h=i),this.setContentSizeByElementWidth()}},{key:"setElementSizeByContentSize",value:function(){this.w=this.contentW+2*this.mlx.mlxPadding,this.h=this.w2h(this.w)}},{key:"endFullScreen",value:function(){this.isFullScreen=!1,this.mlx.showNavBar(),this.scaleContentToSaved()}},{key:"scaleContentToSaved",value:function(){this.x=this.saveX,this.y=this.saveY,this.w=this.saveW,this.h=this.saveH,this.mlx.mlxCaptionHeight=this.saveCaptionHeight,this.mlx.mlxPadding=this.savePadding,this.contentX=this.saveOutputX,this.contentY=this.saveOutputY,this.contentW=this.saveOutputW,this.contentH=this.saveOutputH,this.mlx.userScaleX=this.saveUserScaleX,this.mlx.userScaleY=this.saveUserScaleY,this.mlx.userScale=this.saveUserScale,this.mlx.userTranslateX=this.saveUserTranslateX,this.mlx.userTranslateY=this.saveUserTranslateY,this.contentScale=1}},{key:"enterFullScreen",value:function(){this.isFullScreen=!0,/iPhone|iPad|iPod/i.test(navigator.userAgent)||this.mlx.fullscreen(this),this.mlx.hideNavBar(),this.saveWindowStatus(),this.scaleContentToFillSize(!0)}},{key:"enterMaximize",value:function(){this.mlx.maximizeWindow(),this.saveWindowStatus(),this.scaleContentToFillSize(!1),this.mlx.maximizedElement=this}},{key:"exitMaximize",value:function(){this.mlx.normalizeWindow(),this.scaleContentToSaved(),this.mlx.maximizedElement=null}},{key:"saveWindowStatus",value:function(){this.saveX=this.x,this.saveY=this.y,this.saveW=this.w,this.saveH=this.h,this.saveCaptionHeight=this.mlx.mlxCaptionHeight,this.savePadding=this.mlx.mlxPadding,this.saveOutputX=this.contentX,this.saveOutputY=this.contentY,this.saveOutputW=this.contentW,this.saveOutputH=this.contentH,this.saveVideoWidth=this.videoWidth,this.saveVideoHeight=this.videoHeight,this.saveUserTranslateX=this.mlx.userTranslateX,this.saveUserTranslateY=this.mlx.userTranslateY,this.saveUserScaleX=this.mlx.userScaleX,this.saveUserScaleY=this.mlx.userScaleY,this.saveUserScale=this.mlx.userScale,this.mlx.userScaleX=0,this.mlx.userScaleY=0,this.mlx.userScale=1,this.mlx.userTranslateX=0,this.mlx.userTranslateY=0}},{key:"scaleContentToFillSize",value:function(t){this.x=0,this.y=0,t?(this.w=this.p5.displayWidth,this.h=this.p5.displayHeight,this.contentW=this.p5.displayWidth):(this.w=this.p5.width,this.h=this.p5.height,this.contentW=this.p5.width),this.mlx.mlxCaptionHeight=0,this.mlx.mlxPadding=0,this.contentH=this.contentW/this.contentAspectRatio,t?this.contentH>this.p5.displayHeight&&(this.contentH=this.p5.displayHeight,this.contentW=this.contentH*this.contentAspectRatio):(this.contentH<this.p5.height?(this.contentH=this.p5.height,this.contentW=this.p5.height*this.contentAspectRatio):this.contentH>this.p5.height&&(this.contentW=this.p5.width,this.contentH=this.contentW/this.contentAspectRatio),this.contentScale=this.contentW/this.videoWidth),t?(this.contentX=(this.p5.displayWidth-this.contentW)/2,this.contentY=(this.p5.displayHeight-this.contentH)/2):(this.contentX=(this.p5.width-this.contentW)/2,this.contentY=(this.p5.height-this.contentH)/2)}}]),i}(m),g=function(t){"use strict";a(i,t);var e=u(i);function i(t){var s;return h(this,i),(s=e.call(this,t)).type="model",s.category="Model",s.x=400,s.y=100,s}return l(i,[{key:"process",value:function(){return!(!this.inElement||!this.inElement.outElement)&&(!!this.ready&&(!this.busy&&(!!this.alreadyRunInLoop||!!this.inElement.outputIsReady&&this.doProcess())))}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.updateInputLinkPosition(),this.updateOutputLinkPosition()}},{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t)}},{key:"drawInputLink",value:function(t){this.mlx.maximizedElement||this.mlx.fullScreenElement!=this&&this.inElement&&(t.stroke(0),t.fill(this.mlx.getLinkColor(this.inType)),this.polygon(this.inputLinkX,this.inputLinkY,this.mlx.mlxLinkSize-2,3,this.inputLinkAngle))}}]),i}(m),v=function(t){"use strict";a(i,t);var e=u(i);function i(t){var s;return h(this,i),(s=e.call(this,t)).type="output",s.category="Output",s.x=700,s.y=100,s}return l(i,[{key:"process",value:function(){return!(!this.inElement||!this.inElement.outElement)&&(!!this.ready&&(!this.busy&&(!!this.alreadyRunInLoop||!!this.inElement.outputIsReady&&this.doProcess())))}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.updateInputLinkPosition(),this.updateOutputLinkPosition()}},{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t)}},{key:"drawInputLink",value:function(t){this.mlx.fullScreenElement!=this&&this.inElement&&(t.stroke(0),t.fill(this.mlx.getLinkColor(this.inType)),this.polygon(this.inputLinkX,this.inputLinkY,this.mlx.mlxLinkSize-2,3,this.inputLinkAngle))}},{key:"endFullScreen",value:function(){this.x=this.saveX,this.y=this.saveY,this.w=this.saveW,this.h=this.saveH,this.mlx.mlxCaptionHeight=this.saveCaptionHeight,this.mlx.mlxPadding=this.savePadding,this.contentX=this.saveOutputX,this.contentY=this.saveOutputY,this.contentW=this.saveOutputW,this.contentH=this.saveOutputH}},{key:"enterFullScreen",value:function(){this.mlx.fullscreen(this),this.saveX=this.x,this.saveY=this.y,this.saveW=this.w,this.saveH=this.h,this.saveCaptionHeight=this.mlx.mlxCaptionHeight,this.savePadding=this.mlx.mlxPadding,this.saveOutputX=this.contentX,this.saveOutputY=this.contentY,this.saveOutputW=this.contentW,this.saveOutputH=this.contentH,this.saveVideoWidth=this.videoWidth,this.saveVideoHeight=this.videoHeight,this.x=0,this.y=0,this.w=this.p5.displayWidth,this.h=this.p5.displayHeight,this.mlx.mlxCaptionHeight=0,this.mlx.mlxPadding=0,this.contentW=this.p5.displayWidth,this.contentH=this.contentW/this.contentAspectRatio,this.contentH>this.p5.displayHeight&&(this.contentH=this.p5.displayHeight,this.contentW=this.contentH*this.contentAspectRatio),this.contentX=(this.p5.displayWidth-this.contentW)/2,this.contentY=(this.p5.displayHeight-this.contentH)/2}}]),i}(m),f=function(t){"use strict";a(i,t);var e=u(i);function i(t){var s;return h(this,i),(s=e.call(this,t)).lockCanvasToThisElement=!1,s.prevCanvasWidth=-1,s.prevCanvasHeight=-1,s}return l(i,[{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t),this.adjustThisElementToLockCanvas()}},{key:"adjustThisElementToLockCanvas",value:function(){if(this.lockCanvasToThisElement){var t=!1;this.prevCanvasWidth!=this.p5.width&&(this.prevCanvasWidth=this.p5.width,t=!0),this.prevCanvasHeight!=this.p5.height&&(this.prevCanvasHeight=this.p5.height,t=!0),t&&this.canvasChanged()}}},{key:"removeFocus",value:function(){this.prevCanvasWidth=-1,this.prevCanvasHeight=-1,this.lockCanvasToThisElement=!1,this.mlx.showNavBar()}},{key:"canvasChanged",value:function(){this.mlx.userTranslateX=0,this.mlx.userTranslateY=0;var t=this.w-2*this.mlx.mlxPadding,e=this.h-this.mlx.mlxCaptionHeight-2*this.mlx.mlxPadding,i=this.p5.width/t,s=this.p5.height/e;i>s&&(i=s),this.mlx.userScaleX=0,this.mlx.userScaleY=0,this.mlx.userScale=i,this.x=(this.p5.width-this.w*i)/2/i,this.y=-(this.mlx.mlxCaptionHeight+this.mlx.mlxPadding)}},{key:"save",value:function(){var t=n(o(i.prototype),"save",this).call(this);return t.lockCanvasToThisElement=this.lockCanvasToThisElement,t}},{key:"load",value:function(t){n(o(i.prototype),"load",this).call(this,t),t.lockCanvasToThisElement&&(this.lockCanvasToThisElement=t.lockCanvasToThisElement,this.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),this.mlx.focusedElement=this)}}]),i}(v),x=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="Label",n.title="Label",n.inType="results",n.outType="results",n.h=60,n.text="",n.size=0,n.createElementMenu(),n.resizable=!0,n.label=n.mlx.createLabel(s(n),"Loading...",n.mlx.mlxPadding,n.mlx.mlxCaptionHeight+2,n.w-2*n.mlx.mlxPadding,n.h-10-n.mlx.mlxCaptionHeight),n.onScreenDisplay=!1,n.confidence80=!1,n.ready=!0,n}return l(i,[{key:"resizeByMouse",value:function(){n(o(i.prototype),"resizeByMouse",this).call(this)}},{key:"setContentSizeByElementWidth",value:function(){var t=this.w-2*this.mlx.mlxPadding,e=this.h-5-this.label.yy;this.label.resize(t,e)}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCheckedMenu("Confidence > 80%",this.confidence80,(function(e,i){t.hideMenu(),t.confidence80=i})),e.addCheckedMenu("On Screen Display",this.onScreenDisplay,(function(e,i){t.hideMenu(),t.onScreenDisplay=i,t.onScreenDisplay?t.mlx.labelElement=t:(t.mlx.labelElement=null,t.mlx.statusOut("Copyright \xa9 2020 Art & Technology Co.,Ltd."))})),e.addSeparator(),e.addSelectMenu(["Small","Medium","Large"],this.size,(function(e,i){t.size=i,0==t.size?t.label.setFontSize(14):1==t.size?t.label.setFontSize(24):2==t.size&&t.label.setFontSize(48),t.hideMenu()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.results=this.inElement.output,Array.isArray(this.results)&&this.results.length>0?this.results[0].label&&(this.results[0].confidence?!this.confidence80||this.results[0].confidence>.8?this.text="".concat(this.results[0].label," (").concat((100*this.results[0].confidence).toFixed(2),"%)"):this.text="":this.text=this.results[0].label,this.label.setText(this.text)):this.results.value?(this.text=this.results.value,this.label.setText(this.text)):this.results.label&&(this.results.confidence?this.text="".concat(this.results.label," (").concat((100*this.results.confidence).toFixed(2),"%)"):this.text=this.results.label,this.label.setText(this.text)),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.label.setText("")}}]),i}(v),y=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="Oscillator",n.title="Oscillator",n.inType="results",n.outType="results",n.h=60,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.onScreenDisplay=!1,n.currentNote="",n.freq={A:440,B:493.88,C:523.25,D:587.33,E:659.26,F:698.46,G:783.99,H:880},p||(p=new p5.Oscillator),p.setType("sine"),c=0,p.start(),p.amp(c),n.ready=!0,n}return l(i,[{key:"doProcess",value:function(){return this.results=this.inElement.output,Array.isArray(this.results)?this.results[0].label&&(this.text=this.results[0].label,this.label.setText(this.text),this.freq[this.text]&&0==c&&(p.freq(this.freq[this.text]),c=5,p.amp(c))):this.results.value?(this.text=this.results.value,this.label.setText(this.text)):this.results.label&&(this.results.confidence?this.text="".concat(this.results.label," (").concat((100*this.results.confidence).toFixed(2),"%)"):this.text=this.results.label,this.label.setText(this.text),this.freq[this.text]&&0==c&&(p.freq(this.freq[this.text]),c=5,p.amp(c))),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),c>0&&((c-=.1)<1&&(c=0),p.amp(c)),this.inElement&&this.inElement.outElement||this.label.setText("")}},{key:"remove",value:function(){c=0,p.amp(c)}}]),i}(v),E=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="ConsoleLog",n.title="Console Log",n.inType="all",n.outType="results",n.h=60,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(s(n),"Ready",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.onScreenDisplay=!1,n.ready=!0,n}return l(i,[{key:"doProcess",value:function(){return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,console.log(this.output),this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),!this.inElement||this.inElement.outElement}},{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t)}}]),i}(v),_=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="Speech",n.title="Speech",n.inType="results",n.outType="results",n.h=60,n.text="",n.speechCount=0,n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.lang=0,n.language="en",n.speech=new p5.Speech,n.label.setText("Speech ready."),n.createElementMenu(),n.speech.onEnd=function(){n.inElement&&(n.inElement.outputIsReady=!1),n.speechCount--,0==n.speechCount&&(n.busy=!1,n.outputIsReady=!0)},n.speech.onLoad=function(){n.label.setText("Speech is ready"),n.isReady=!0},n.speech.setLang(n.language),"th"==n.language?n.speech.setVoice("Kanya"):n.speech.setVoice("Daniel"),n.speech.setVoice(63),n.ready=!0,n}return l(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addSelectMenu(["English","Thai"],this.lang,(function(e,i){t.lang=i,t.language=0==i?"en":"th",t.speech.setLang(t.language),"th"==t.language?t.speech.setVoice("Kanya"):t.speech.setVoice("Daniel"),t.hideMenu()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.results=this.inElement.output,Array.isArray(this.results)?this.results[0].label&&(this.text=this.results[0].label,this.label.setText(this.text)):this.results.value?(this.text=this.results.value,this.label.setText(this.text)):this.results.label&&(this.results.confidence?this.text="".concat(this.results.label," (").concat((100*this.results.confidence).toFixed(2),"%)"):this.text=this.results.label,this.label.setText(this.text)),this.text&&0==this.speechCount&&(this.speech.speak(this.text),this.speechCount++),this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||(this.text="",this.label.setText(""))}}]),i}(v),w=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Input",n.type="Audio",n.title="Audio Input",n.inType="none",n.outType="audio",n.createElementMenu(),n.mic=new p5.AudioIn,n.mic.start(),n.h=100,n.icon=n.mlx.createImage(s(n),"/assets/iconMicrophone.jpg",1,n.mlx.mlxCaptionHeight+1,198,44),n.label=n.mlx.createLabel(s(n),"Ready",18,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.ready=!0,n.busy=!1,n}return l(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return!!this.mic&&(this.busy=!1,this.output=this.mic,this.outputIsReady=!0,this.alreadyRunInLoop=!0,!0)}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this)}},{key:"remove",value:function(){this.mic&&(this.mic.stop(),this.mic=null),n(o(i.prototype),"remove",this).call(this)}}]),i}(d),S=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;h(this,i),(n=e.call(this,t)).category="Output",n.type="SoundAmplitude",n.title="Sound Amplitude",n.inType="audio",n.outType="audio",n.amplitude=new Array(60),n.ampIndex=0;for(var a=0;a<60;a++)n.amplitude[a]=0;return n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=240,n.contentH=100,n.w=n.contentW+2*n.mlx.mlxPadding,n.h=n.contentH+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.label.setText("Sound Amplitude ready."),n.ready=!0,n.busy=!1,n.outputIsReady=!1,n}return l(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.inElement&&"audio"==this.inElement.outType?(this.busy=!0,this.output=this.inElement.output,this.outputIsReady=!0):this.outputIsReady=!1,this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.inElement&&"audio"==this.inElement.outType&&(this.amplitude[this.ampIndex]=this.inElement.output.getLevel(),this.ampIndex=this.ampIndex+1,this.ampIndex>=60&&(this.ampIndex=0))}},{key:"draw",value:function(t){n(o(i.prototype),"draw",this).call(this,t);var e=0;t.noFill(),t.stroke(20);for(var s=this.x+this.contentX,a=this.y+this.contentY+this.contentH,r=this.ampIndex;r<60;r++)t.line(s+e,a,s+e,a-512*this.amplitude[r]),e+=4;for(r=0;r<this.ampIndex;r++)t.line(s+e,a,s+e,a-512*this.amplitude[r]),e+=4}}]),i}(v),k=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="FFT",n.title="FFT Spectrum",n.inType="audio",n.outType="tensor",n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=512,n.contentH=150,n.w=n.contentW+2*n.mlx.mlxPadding,n.h=n.contentH+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.fft=new p5.FFT(.8,512),n.label.setText("FFT ready."),n.ready=!0,n.busy=!1,n.outputIsReady=!1,n.fftMode=1,n}return l(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Amplitude",(function(e){t.hideMenu(),t.fftMode=0})),e.addCommand("Analysis",(function(e){t.hideMenu(),t.fftMode=1})),e.addCommand("Spectrogram",(function(e){t.hideMenu(),t.fftMode=2})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.inElement&&"audio"==this.inElement.outType?(this.busy=!0,this.fft.setInput(this.inElement.output),1==this.fftMode&&(this.spectrum=this.fft.analyze(),this.output=this.spectrum,this.outputIsReady=!0)):this.outputIsReady=!1,this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){if(n(o(i.prototype),"draw",this).call(this,t),this.inElement&&"audio"==this.inElement.outType)if(0==this.fftMode){this.spectrum=this.fft.waveform();var e=this.contentH;t.beginShape(),t.noFill(),t.stroke(20);for(var s=this.x+this.contentX,a=this.y+this.contentY,r=0;r<this.spectrum.length;r++){var h=s+2*r,l=a+t.map(this.spectrum[r],-1,1,e,0);t.vertex(h,l)}t.endShape()}else if(1==this.fftMode&&this.spectrum){var u=this.contentH,p=this.x+this.contentX,c=this.y+this.contentY;t.push(),t.colorMode(t.HSB,255);for(var m=0;m<this.spectrum.length;m++){h=p+m,l=c+t.map(this.spectrum[m],0,255,u,0);t.stroke(1.5*this.spectrum[m],255,255),t.line(h,c+u,h,l)}t.pop()}}}]),i}(v),b=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;h(this,i),(n=e.call(this,t)).category="Output",n.type="NatsSoundTensor",n.title="Nat's Sound Tensor",n.inType="tensor",n.outType="tensor",n.wordDetected=!1,n.wordDuration=0,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=256,n.contentH=128,n.w=n.contentW+2*n.mlx.mlxPadding,n.h=n.contentH+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.label.hidden=!0,n.ready=!0,n.busy=!1,n.outputIsReady=!1,n.detectWord=!0,n.soundTensor=new Array(128);for(var a=0;a<128;a++)n.soundTensor[a]=0;return n}return l(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.inElement&&"tensor"==this.inElement.outType&&this.inElement.outputIsReady?(this.busy=!0,this.spectrum=this.inElement.output,this.output=this.soundTensor):this.outputIsReady=!1,this.detectWord||(this.outputIsReady=!0),this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){if(n(o(i.prototype),"draw",this).call(this,t),this.inElement&&"tensor"==this.inElement.outType&&this.spectrum){for(var e=0,s=0;s<128;s++)e+=this.spectrum[s];if(this.detectWord){if(e>1500&&!this.wordDetected){this.wordDetected=!0;for(s=0;s<128;s++)this.soundTensor[s]=0}if(this.wordDetected){if(this.wordDuration>64)this.wordDetected=!1,this.wordDuration=0;else if(this.wordDuration>43)this.outputIsReady=!0,console.log(this.soundTensor);else for(s=0;s<128;s++)this.soundTensor[s]+=this.spectrum[s];this.wordDuration++}}var a=this.x+this.contentX,r=this.y+this.contentY,h=this.contentH;for(s=0;s<128;s++){var l=a+2*s,u=r+t.map(this.soundTensor[s],0,3825,h,0);t.stroke(0),t.line(l,r+h,l,u)}}}}]),i}(v),C=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),(n=e.call(this,t)).category="Output",n.type="Spectrogram",n.title="Spectrogram",n.inType="tensor",n.outType="image",n.wordDetected=!1,n.wordDuration=0,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=256,n.contentH=256,n.w=n.contentW+2*n.mlx.mlxPadding,n.h=n.contentH+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.text="",n.createElementMenu(),n.grx=t.p5.createGraphics(256,256),n.grx.background(0),n.grx.noSmooth(),n.grx.colorMode(p5.HSB,255),n.grx2=t.p5.createGraphics(256,256),n.grx2.background(0),n.grx2.noSmooth(),n.grx2.colorMode(p5.HSB,255),n.label=n.mlx.createLabel(s(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.label.hidden=!0,n.ready=!0,n.busy=!1,n.outputIsReady=!1,n.detectWord=!1,n}return l(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCheckedMenu("Detect Word",this.detectWord,(function(e,i){t.hideMenu(),t.detectWord=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.inElement&&"tensor"==this.inElement.outType&&this.inElement.outputIsReady?(this.busy=!0,this.spectrum=this.inElement.output,this.output=this.grx2):this.outputIsReady=!1,this.detectWord||(this.outputIsReady=!0),this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){if(n(o(i.prototype),"draw",this).call(this,t),this.inElement&&"tensor"==this.inElement.outType&&this.spectrum){this.grx.image(this.grx,-6,0),this.grx.colorMode(t.HSB,255);for(var e=0,s=0;s<128;s++){e+=this.spectrum[s];var a=1.5*this.spectrum[s];this.grx.fill(a,255,255),this.grx.noStroke(),this.grx.rect(250,255-2*s-1,6,2)}this.detectWord?(e>4500&&!this.wordDetected&&(this.wordDetected=!0),this.wordDetected&&(this.wordDuration>64?(this.wordDetected=!1,this.wordDuration=0):this.wordDuration>43?this.outputIsReady=!0:this.grx2.image(this.grx,0,0),this.wordDuration++)):this.grx2.image(this.grx,0,0)}var r=this.x+this.contentX,h=this.y+this.contentY;this.detectWord?t.image(this.grx2,r,h):t.image(this.grx,r,h)}}]),i}(v),T=function(t){"use strict";a(i,t);var e=u(i);function i(t){var n;return h(this,i),n=e.call(this,t),console.log("TextInput"),n.category="Input",n.type="TextInput",n.title="Text Input",n.inType="none",n.outType="results",n.createElementMenu(),n.needMouse=!0,n.resizable=!1,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentW=200,n.contentH=100,n.contentAspectRatio=n.contentW/n.contentH,n.divX=n.contentX,n.divY=n.contentY,n.divW=n.contentW,n.divH=n.contentH-24,n.setElementSizeByContentSize(),n.div=t.p5.createDiv(),n.div.size(n.divW,n.divH),n.div.position(n.x+n.divX,n.y+n.divY+n.mlx.mlxNavBarHeight),n.div.style("background-color","#FFFFFF"),n.div.style("text-align","left"),n.div.style("font-size","x-small"),n.textArea=document.createElement("TEXTAREA"),n.div.elt.appendChild(n.textArea),n.textArea.style.Width="100%",n.textArea.style.height="100%",n.textArea.style.resize="none",n.textArea.cols=30,n.divW=n.textArea.clientWidth+2,n.div.size(n.divW,n.divH),n.contentW=n.divW,n.contentAspectRatio=n.contentW/n.contentH,n.setElementSizeByContentSize(),n.label=n.mlx.createLabel(s(n),"Ready",n.mlx.mlxPadding,n.divY+n.divH+2,n.w-2*n.mlx.mlxPadding,24),n.okButton=n.mlx.createButton(s(n),"OK",(function(){n.output={label:n.textArea.value},console.log("OK"),n.outputIsReady=!0}),n.w-60-n.mlx.mlxPadding,n.h-28,60,22),n.okButton.border=!0,n.outputIsReady=!1,n.ready=!0,n.busy=!1,n}return l(i,[{key:"inactivateUI",value:function(){this.div.style("display","none")}},{key:"activateUI",value:function(){this.div.style("display","block")}},{key:"doProcess",value:function(){return this.busy=!1,this.alreadyRunInLoop=!0,!0}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.divX,s=this.y+this.divY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale),this.div.size(this.divW*this.mlx.userScale,this.divH*this.mlx.userScale),this.label.yy=this.divY+this.divH+2,this.label.resize(this.w-2*this.mlx.mlxPadding,this.label.h)}},{key:"update",value:function(){n(o(i.prototype),"update",this).call(this),this.setPosition(this.x,this.y)}}]),i}(d);t.exports={mlxElement:m,mlxElementInput:d,mlxElementModel:g,mlxElementOutput:v,mlxElementLocakableOutput:f,mlxLabel:x,mlxOscillator:y,mlxConsoleLog:E,mlxSpeech:_,mlxAudioInput:w,mlxSoundAmplitude:S,mlxFFTSpectrum:k,mlxSpectrogram:C,mlxNatsSoundTensor:b,mlxTextInput:T}},86050:function(t,e,i){var s=i(809),n=i(38561),a=i(83115),r=i(2553),o=i(62012),h=i(50450),l=i(18770),u=i(9807),p=i(27690),c=i(99828);function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=c(t);if(e){var n=c(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return p(this,i)}}var d=i(46120),g=(d.mlxElement,d.mlxElementInput,d.mlxElementModel,d.mlxElementOutput),v=(d.mlxElementLocakableOutput,d.mlxLabel,d.mlxOscillator,d.mlxConsoleLog,d.mlxSpeech,d.mlxAudioInput,d.mlxFFTSpectrum,d.mlxTextInput,function(t){"use strict";u(i,t);var e=m(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Output",s.type="MQTT",s.title="MQTT",s.inType="all",s.outType="results",s.needMouse=!0,s.resizable=!1,s.w=280,s.h=270,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.sendTimestamp=Date.now(),s.minOnChangeInterval=500,s.text="",s.createElementMenu();var n=10,a=30;s.label=s.mlx.createLabel(h(s),"",10,s.h-35,s.w-20,a),s.mlx.createLabel(h(s),"Host",10,s.mlx.mlxCaptionHeight+n,s.w-60,a),s.mlx.createLabel(h(s),"Username",10,s.mlx.mlxCaptionHeight+n+30,s.w-20,a),s.mlx.createLabel(h(s),"Password",10,s.mlx.mlxCaptionHeight+n+60,s.w-20,a),s.mlx.createLabel(h(s),"Client ID",10,s.mlx.mlxCaptionHeight+n+90,s.w-20,a);var o=s.mlx.mlxCaptionHeight+n;return s.host=s.mlx.createTextInput(h(s),"ws://mqtt.com:8000/mqtt","text",null,80,o+0,190,a),s.username=s.mlx.createTextInput(h(s),"","text",null,80,o+30,190,a),s.password=s.mlx.createTextInput(h(s),"","password",null,80,o+60,190,a),s.clientId=s.mlx.createTextInput(h(s),"","text",null,80,o+90,190,a),s.mlx.createSeperator(h(s),0,s.mlx.mlxCaptionHeight+n+120+5,s.w,3),n+=45,s.mlx.createLabel(h(s),"Topic",10,s.mlx.mlxCaptionHeight+n+90,s.w-20,a),s.mlx.createLabel(h(s),"Send",10,s.mlx.mlxCaptionHeight+n+120,s.w-20,a),s.topic=s.mlx.createTextInput(h(s),"/test","text",null,80,s.mlx.mlxCaptionHeight+n+90,190,a),s.sendOption=s.mlx.createRadioOption(h(s),["On Change","Every"],null,75,s.mlx.mlxCaptionHeight+n+120+2,200,25),s.interval=s.mlx.createTextInput(h(s),"3","text",null,228,s.mlx.mlxCaptionHeight+n+120,30,a),s.mlx.createLabel(h(s),"s",s.w-20,s.mlx.mlxCaptionHeight+n+120,10,a),s.connectBtn=s.mlx.createButton(h(s),"Connect",(function(){s.onConnect()}),s.w-s.mlx.mlxPadding-100,s.h-30,100,24),s.connectBtn.border=!0,s.ready=!1,s.busy=!1,s.outputIsReady=!1,s}return o(i,[{key:"onConnect",value:function(){var t=this,e=this.host.getText(),i=this.username.getText(),s=this.password.getText(),n=this.clientId.getText();if(null==this.client){var a=new URL(e);this.client=new Paho.MQTT.Client(a.hostname,parseInt(a.port),a.pathname,n),this.client.onConnectionLost=this.onDisconnected.bind(this),this.client.onMessageArrived=this.onMessage.bind(this),this.client.onConnected=this.onConnected.bind(this)}if(this.client.isConnected())console.log("Disconnected"),this.client.disconnect();else{if(""==e)return void this.label.setText("Client ID empty!");this.connectBtn.text="Connecting...",console.log("Connect to : "+e);var r={useSSL:!!e.startsWith("wss"),onSuccess:function(){t.onConnected()},onFailure:function(){t.onDisconnected()}};""!=i&&(r.userName=i),""!=s&&(r.password=s),this.client.connect(r)}}},{key:"onConnected",value:function(){this.label.setText("Connected"),this.connectBtn.text="Disconnect",this.ready=!0,this.outputIsReady=!1}},{key:"onMessage",value:function(){console.log("message")}},{key:"onDisconnected",value:function(){this.label.setText("Disconnected"),this.connectBtn.text="Connect",this.ready=!1,this.outputIsReady=!1,this.client=null}},{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"save",value:function(){var t=l(c(i.prototype),"save",this).call(this),e=this.host.getText(),s=this.token.getText(),n=this.secret.getText(),a=this.clientId.getText(),r=this.topic.getText(),o=this.interval.getText(),h=this.sendOption.getValue();return t.host=e,t.port=port,t.username=s,t.password=n,t.clientId=a,t.topic=r,t.interval=o,t.sendOption=h,t}},{key:"load",value:function(t){l(c(i.prototype),"load",this).call(this,t),this.host.setText(t.host),this.username.setText(t.username),this.password.setText(t.password),this.clientId.setText(t.clientId),this.topic.setText(t.topic),this.interval.setText(t.interval),this.sendOption.setValue(t.sendOption)}},{key:"inactivateUI",value:function(){this.host.input.hide(),this.username.input.hide(),this.password.input.hide(),this.clientId.input.hide(),this.topic.input.hide(),this.sendOption.radio.hide(),this.interval.input.hide()}},{key:"activateUI",value:function(){this.host.input.show(),this.username.input.show(),this.password.input.show(),this.clientId.input.show(),this.topic.input.show(),this.sendOption.radio.show(),this.interval.input.show()}},{key:"doProcess",value:function(){this.outputIsReady=!1,this.busy=!0,this.results=this.inElement.output;var t="";if(Array.isArray(this.results)&&this.results.length>0?this.results[0].label&&(this.results[0].confidence?(this.text=this.results[0].label,(100*this.results[0].confidence).toFixed(2)):this.text=this.results[0].label,t=this.text):this.results.value?(this.text=this.results.value,t=this.text):this.results.label&&(this.results.confidence?(this.text=this.results.label,(100*this.results.confidence).toFixed(2)):this.text=this.results.label,t=this.text),0==this.sendOption.getValue()){if(this.mqttMsg!=t)Date.now()-this.sendTimestamp>this.minOnChangeInterval&&(this.sendTimestamp=Date.now(),this.label.setText(t),this.mqttSend(t),this.mqttMsg=t)}else{var e=Date.now(),i=1e3*parseFloat(this.interval.getText()),s=e-this.sendTimestamp;i>0&&s>i&&(this.sendTimestamp=Date.now(),this.label.setText(t),this.mqttSend(t))}return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"mqttSend",value:function(t){var e=this.topic.getText(),i=new Paho.MQTT.Message(t);i.destinationName=e,this.client.send(i)}},{key:"update",value:function(){l(c(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.label.setText("")}},{key:"draw",value:function(t){l(c(i.prototype),"draw",this).call(this,t)}}]),i}(g)),f=function(t){"use strict";u(i,t);var e=m(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Output",s.type="NETPIE2020",s.title="NETPIE 2020",s.inType="all",s.outType="results",s.needMouse=!0,s.resizable=!1,s.w=280,s.h=240,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.mqttUri="mqtt.netpie.io",s.mqttPort=443,s.sendTimestamp=Date.now(),s.minOnChangeInterval=500,s.text="",s.createElementMenu();var n=10,a=30;s.label=s.mlx.createLabel(h(s),"--- Wait To Connect ---",10,s.h-35,s.w-20,a),s.mlx.createLabel(h(s),"Client ID",10,s.mlx.mlxCaptionHeight+n,s.w-20,a),s.mlx.createLabel(h(s),"Token",10,s.mlx.mlxCaptionHeight+n+30,s.w-20,a),s.mlx.createLabel(h(s),"Secret",10,s.mlx.mlxCaptionHeight+n+60,s.w-20,a);var o=s.mlx.mlxCaptionHeight+n;return s.clientId=s.mlx.createTextInput(h(s),"","text",null,70,o+0,200,a),s.token=s.mlx.createTextInput(h(s),"","text",null,70,o+30,200,a),s.secret=s.mlx.createTextInput(h(s),"","password",null,70,o+60,200,a),s.mlx.createSeperator(h(s),0,s.mlx.mlxCaptionHeight+n+90+5,s.w,3),n+=15,s.mlx.createLabel(h(s),"Topic",10,s.mlx.mlxCaptionHeight+n+90,s.w-20,a),s.mlx.createLabel(h(s),"Send",10,s.mlx.mlxCaptionHeight+n+120,s.w-20,a),s.topic=s.mlx.createTextInput(h(s),"@msg/test","text",null,70,s.mlx.mlxCaptionHeight+n+90,200,a),s.sendOption=s.mlx.createRadioOption(h(s),["On Change","Every"],null,70,s.mlx.mlxCaptionHeight+n+120+2,200,25),s.interval=s.mlx.createTextInput(h(s),"3","text",null,228,s.mlx.mlxCaptionHeight+n+120,30,a),s.mlx.createLabel(h(s),"s",s.w-20,s.mlx.mlxCaptionHeight+n+120,10,a),s.connectBtn=s.mlx.createButton(h(s),"Connect",(function(){s.onConnect()}),s.w-s.mlx.mlxPadding-100,s.h-30,100,24),s.connectBtn.border=!0,s.ready=!1,s.busy=!1,s.outputIsReady=!1,s}return o(i,[{key:"createInput",value:function(t,e,i){var s=this.mlx.p5.createInput("");return s.position(t,e),s.size(100),s}},{key:"onConnect",value:function(){var t=this;if(null==this.client&&(this.client=new Paho.MQTT.Client(this.mqttUri,this.mqttPort,this.clientId.getText()),this.client.onConnectionLost=this.onDisconnected.bind(this),this.client.onMessageArrived=this.onMessage.bind(this),this.client.onConnected=this.onConnected.bind(this)),this.client.isConnected())console.log("Disconnect NETPIE 2020"),this.client.disconnect();else{if(""==this.clientId.getText())return void this.label.setText("Client ID empty!");if(""==this.token.getText())return void this.label.setText("Token empty!");if(""==this.secret.getText())return void this.label.setText("Secret empty!");if(""==this.topic.getText())return void this.label.setText("Topic empty!");this.connectBtn.text="Connecting...",console.log("Connect to NETPIE 2020"),console.log("Client ID : ",this.clientId.getText()),console.log("Token : ",this.token.getText());var e={useSSL:!0,userName:this.token.getText(),password:this.secret.getText(),onSuccess:function(){t.onConnected()},onFailure:function(){t.onDisconnected()}};this.client.connect(e)}}},{key:"onConnected",value:function(){this.label.setText("Connected"),this.connectBtn.text="Disconnect",this.ready=!0,this.outputIsReady=!1}},{key:"onMessage",value:function(){console.log("message")}},{key:"onDisconnected",value:function(){this.label.setText("Disconnected"),this.connectBtn.text="Connect",this.ready=!1,this.outputIsReady=!1,this.client=null}},{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"save",value:function(){var t=l(c(i.prototype),"save",this).call(this),e=this.token.getText(),s=this.secret.getText(),n=this.clientId.getText(),a=this.topic.getText(),r=this.interval.getText(),o=this.sendOption.getValue();return t.username=e,t.password=s,t.clientId=n,t.topic=a,t.interval=r,t.sendOption=o,t}},{key:"load",value:function(t){l(c(i.prototype),"load",this).call(this,t),this.token.setText(t.username),this.secret.setText(t.password),this.clientId.setText(t.clientId),this.topic.setText(t.topic),this.interval.setText(t.interval),this.sendOption.setValue(t.sendOption)}},{key:"inactivateUI",value:function(){this.clientId.input.hide(),this.token.input.hide(),this.secret.input.hide(),this.sendOption.radio.hide(),this.topic.input.hide(),this.interval.input.hide()}},{key:"activateUI",value:function(){this.clientId.input.show(),this.token.input.show(),this.secret.input.show(),this.sendOption.radio.show(),this.topic.input.show(),this.interval.input.show()}},{key:"doProcess",value:function(){this.outputIsReady=!1,this.busy=!0,this.results=this.inElement.output;var t="";if(Array.isArray(this.results)&&this.results.length>0?this.results[0].label&&(this.results[0].confidence?(this.text=this.results[0].label,(100*this.results[0].confidence).toFixed(2)):this.text=this.results[0].label,t=this.text):this.results.value?(this.text=this.results.value,t=this.text):this.results.label&&(this.results.confidence?(this.text=this.results.label,(100*this.results.confidence).toFixed(2)):this.text=this.results.label,t=this.text),0==this.sendOption.getValue()){if(this.mqttMsg!=t)Date.now()-this.sendTimestamp>this.minOnChangeInterval&&(this.sendTimestamp=Date.now(),this.label.setText(t),this.mqttSend(t),this.mqttMsg=t)}else{var e=Date.now(),i=1e3*parseFloat(this.interval.getText()),s=e-this.sendTimestamp;i>0&&s>i&&(this.sendTimestamp=Date.now(),this.label.setText(t),this.mqttSend(t))}return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"mqttSend",value:function(t){var e=this.topic.getText(),i=new Paho.MQTT.Message(t);i.destinationName=e,this.client.send(i)}},{key:"update",value:function(){l(c(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.label.setText("")}},{key:"draw",value:function(t){l(c(i.prototype),"draw",this).call(this,t)}}]),i}(g),x=function(t){"use strict";u(i,t);var e=m(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Output",s.type="Blynk",s.title="Blynk",s.inType="results",s.outType="results",s.needMouse=!0,s.resizable=!1,s.w=280,s.h=175,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.sendTimestamp=Date.now(),s.minOnChangeInterval=500,s.text="",s.createElementMenu();var n=10,a=30;s.label=s.mlx.createLabel(h(s),"--- Wait To Connect ---",10,s.h-35,s.w-20,a),s.mlx.createLabel(h(s),"Token",10,s.mlx.mlxCaptionHeight+n,s.w-20,a),s.mlx.createLabel(h(s),"VPin",10,s.mlx.mlxCaptionHeight+n+30,s.w-20,a);var o=s.mlx.mlxCaptionHeight+n;return s.token=s.mlx.createTextInput(h(s),"-- Blynk Auth Token --","text",null,70,o+0,200,a),s.vpins=["*V0 reserved for LCD","*V1 reserved for class ID"].concat(Array.from({length:38},(function(t,e){return"V"+(e+2)}))),s.vpin=s.mlx.createSelectOption(h(s),s.vpins,null,70,o+30,200,a),s.vpin.setValue("2"),s.mlx.createSeperator(h(s),0,s.mlx.mlxCaptionHeight+n+60+5,s.w,3),n+=15,s.mlx.createLabel(h(s),"Send",10,s.mlx.mlxCaptionHeight+n+60,s.w-20,a),s.sendOption=s.mlx.createRadioOption(h(s),["On Change","Every"],null,70,s.mlx.mlxCaptionHeight+n+60+2,200,25),s.interval=s.mlx.createTextInput(h(s),"3","text",null,228,s.mlx.mlxCaptionHeight+n+60,30,a),s.mlx.createLabel(h(s),"s",s.w-20,s.mlx.mlxCaptionHeight+n+60,10,a),s.connectBtn=s.mlx.createButton(h(s),"Connect",(function(){s.onConnect()}),s.w-s.mlx.mlxPadding-100,s.h-30,100,24),s.connectBtn.border=!0,s.ready=!1,s.busy=!1,s.outputIsReady=!1,s}return o(i,[{key:"onConnect",value:function(){var t=this.token.getText();if(null==this.blynk&&(this.blynk=new Blynk.Blynk(t,{path:"/websockets",port:8080,skip_connect:!0}),this.blynk.once("disconnect",this.onDisconnected.bind(this)),this.blynk.once("connect",this.onConnected.bind(this)),this.lcd=new this.blynk.WidgetLCD(0)),1==this.ready);else{if(""==t)return void this.label.setText("Token empty!");var e=parseInt(this.vpin.getValue());if(0==e)return void this.label.setText("V0 reserved for label LCD");if(1==e)return void this.label.setText("V1 reserved for class ID");this.classIdPin=new this.blynk.VirtualPin(1),this.virtualPin=new this.blynk.VirtualPin(e),this.blynk.connect()}}},{key:"onConnected",value:function(){this.blynk.syncAll(),this.label.setText("Connected"),this.connectBtn.text="Disconnect",this.ready=!0,this.outputIsReady=!1}},{key:"onMessage",value:function(){console.log("message")}},{key:"onDisconnected",value:function(){this.label.setText("Disconnected"),this.connectBtn.text="Connect",this.ready=!1,this.outputIsReady=!1}},{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"save",value:function(){var t=l(c(i.prototype),"save",this).call(this),e=this.token.getText(),s=this.vpin.getValue(),n=this.interval.getText(),a=this.sendOption.getValue();return t.blynk_token=e,t.blynk_vpin=s,t.blynk_interval=n,t.blynk_sendOption=a,t}},{key:"load",value:function(t){l(c(i.prototype),"load",this).call(this,t),this.token.setText(t.blynk_token),this.vpin.setValue(t.blynk_vpin),this.interval.setText(t.blynk_interval),this.sendOption.setValue(t.blynk_sendOption)}},{key:"inactivateUI",value:function(){this.token.input.hide(),this.vpin.select.hide(),this.sendOption.radio.hide(),this.interval.input.hide()}},{key:"activateUI",value:function(){this.token.input.show(),this.vpin.select.show(),this.sendOption.radio.show(),this.interval.input.show()}},{key:"doProcess",value:function(){this.outputIsReady=!1,this.busy=!0,this.results=this.inElement.output;var t="",e=null;if(Array.isArray(this.results)&&this.results.length>0?this.results[0].label&&(this.results[0].confidence?(this.text=this.results[0].label,(100*this.results[0].confidence).toFixed(2)):this.text=this.results[0].label,void 0!==this.results[0].classId&&(e=this.results[0].classId),t=this.text):this.results.value?(this.text=this.results.value,t=this.text):this.results.label&&(this.results.confidence?(this.text=this.results.label,(100*this.results.confidence).toFixed(2)):this.text=this.results.label,void 0!==this.results.classId&&(e=this.results[0].classId),t=this.text),0==this.sendOption.getValue()){if(this.mqttMsg!=t)Date.now()-this.sendTimestamp>this.minOnChangeInterval&&(this.sendTimestamp=Date.now(),this.label.setText(t),null!==e&&this.classIdPin.write(e),this.virtualPin.write(t),this.lcd.clear(),this.lcd.print(0,0,t),this.mqttMsg=t)}else{var i=Date.now(),s=1e3*parseFloat(this.interval.getText()),n=i-this.sendTimestamp;s>0&&n>s&&(this.sendTimestamp=Date.now(),this.label.setText(t),null!==e&&this.classIdPin.write(e),this.virtualPin(t),this.lcd.clear(),this.lcd.print(0,0,t))}return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){l(c(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.label.setText("")}},{key:"draw",value:function(t){l(c(i.prototype),"draw",this).call(this,t)}}]),i}(g),y=function(t){"use strict";u(i,t);var e=m(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Output",s.type="SerialPort",s.title="Serial Port",s.inType="results",s.outType="results",s.createElementMenu(),s.needMouse=!0,s.serialObject=null,s.writer=null,s.reader=null,s.opened=!1,s.resizable=!1,s.w=237,s.h=90,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.contentAspectRatio=1,s.mlx.createLabel(h(s),"Baud Rate : ",s.mlx.mlxPadding,s.mlx.mlxCaptionHeight+8,100,24),s.baudrate=["115200","1200","2400","4800","9600","14400","19200","28800","31250","38400","57600"],s.baudrateSelector=s.mlx.createSelectOption(h(s),s.baudrate,null,90,s.mlx.mlxCaptionHeight+5,140,30),s.label=s.mlx.createLabel(h(s),"... Wait to connect",s.mlx.mlxPadding,s.h-26,s.w-2*s.mlx.mlxPadding-5,24),s.connectBtn=s.mlx.createButton(h(s),"Connect",(function(){s.onConnect()}),s.w-s.mlx.mlxPadding-100+3,s.h-28,100,24),s.connectBtn.border=!0,navigator.serial||(s.mlx.createLabel(h(s),"Your web browser is not supported",s.mlx.mlxPadding,s.mlx.mlxCaptionHeight,s.w-s.mlx.mlxPadding,s.h-s.mlx.mlxCaptionHeight-5),s.baudrateSelector.select.hide()),s.outputIsReady=!1,s.ready=!1,s.busy=!1,s}return o(i,[{key:"onConnect",value:function(){var t=this;this.ready?this.serialObject&&(this.writer&&this.writer.releaseLock(),this.reader&&this.reader.releaseLock(),this.serialObject.close().then((function(e){t.connectBtn.text="Connect",t.ready=!1})).catch((function(t){console.log(t)}))):navigator.serial.requestPort().then((function(e){if(e){var i=t.baudrate[parseInt(t.baudrateSelector.getValue())];return t.serialObject=e,t.serialObject.onconnect=function(){t.onConnected()},t.serialObject.ondisconnect=function(){t.onDisconnected()},e.open({baudRate:i})}return!1})).then((function(e){!1===e||(t.writer=t.serialObject.writable.getWriter(),t.connectBtn.text="Disconnect",t.ready=!0)})).catch((function(e){console.log(e),t.label.setText(e.message),t.ready=!1}))}},{key:"onConnected",value:function(){console.log("serial port connected"),this.connectBtn.text="Disconnect",this.ready=!0}},{key:"onDisconnected",value:function(){console.log("serial port disconnected"),this.ready=!1,this.connectBtn.text="Connect"}},{key:"save",value:function(){var t=l(c(i.prototype),"save",this).call(this);return t.baudrateSelector=this.baudrateSelector.getValue(),t}},{key:"load",value:function(t){l(c(i.prototype),"load",this).call(this,t),this.baudrateSelector.setValue(t.baudrateSelector)}},{key:"inactivateUI",value:function(){this.baudrateSelector.select.hide()}},{key:"activateUI",value:function(){this.baudrateSelector.select.show()}},{key:"int2bytes",value:function(t){return[t>>8&255,255&t]}},{key:"float2bytes",value:function(t){var e=new Float32Array(1);return e[0]=t,a(new Uint8Array(e.buffer))}},{key:"checkSum",value:function(t){for(var e=0,i=0;i<t.length;i++)e^=t[i];return e}},{key:"getRndInteger",value:function(t,e){return Math.floor(Math.random()*(e-t))+t}},{key:"createPayload",value:function(t,e,i,s,n,a,r,o,h){var l=[].concat(36,0,0,e,this.int2bytes(t),this.int2bytes(i),this.int2bytes(s.length),Array.from(s,(function(t){return t.charCodeAt(0)})),this.float2bytes(n));1==e||2==e&&(l=l.concat(this.int2bytes(a),this.int2bytes(r),this.int2bytes(o),this.int2bytes(h)));var u=this.int2bytes(l.length+2);l[1]=u[0],l[2]=u[1];var p=this.checkSum(l);return l.push(p),l.push(254),l}},{key:"sendOut",value:function(t,e){for(var i=[],s=0;s<e.length;s++){var n=e[s];if(!n.label)return;var a=1;n.width&&n.height&&(a=2);var r=n.classId||0,o=n.x?Math.floor(n.x+n.width/2):0,h=n.y?Math.floor(n.y+n.height/2):0,l=Math.floor(n.width),u=Math.floor(n.height),p=this.createPayload(t,a,r,n.label,n.confidence?100*n.confidence:0,o,h,l,u);i=i.concat(p)}0==e.length&&(i=this.createPayload(0,0,0,"",0,0,0,0,0));var c=new Uint8Array(i);return this.writer.write(c)}},{key:"doProcess",value:function(){if(this.busy=!0,this.alreadyRunInLoop=!1,this.inElement.output&&(!this.outElement||!this.outputIsReady)){var t=this.getRndInteger(1,65533),e=[];e=Array.isArray(this.inElement.output)?this.inElement.output:[this.inElement.output],this.sendOut(t,e).then(n(s.mark((function t(){return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))),this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0}return!0}},{key:"update",value:function(){l(c(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){l(c(i.prototype),"draw",this).call(this,t)}}]),i}(g);t.exports={mlxMQTT:v,mlxNETPIE2020:f,mlxBlynk:x,mlxSerialPort:y}},29719:function(t,e,i){var s=i(62012),n=i(50450),a=i(18770),r=i(2553),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel),m=(p.mlxElementOutput,p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).numResults=0,s}return i}(c)),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="MobileNetFeatureExtractor",s.title="MobileNet Feature Extractor",s.inType="image",s.outType="tensor",s.w=400,s.h=100,s.mode="logits",s.needMouse=!0,s.snapData=[],s.outputType=1,s.createElementMenu(),s.icon=s.mlx.createImage(n(s),"/assets/iconFeatureExtractor.jpg",1,s.mlx.mlxCaptionHeight+1,398,44),s.label=s.mlx.createLabel(n(s),"Loading...",8,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.snapButton=s.mlx.createButton(n(s),"snap",(function(){if(console.log("snap"),s.inElement&&s.inElement.output){s.h+=32,s.label.yy+=32,s.snapButton.yy+=32;var t=s.features.infer(s.inElement.output).dataSync();console.log(t),s.snapData.push(t)}}),s.w-72,s.h-28,68,24),s.snapButton.border=!0,s.h+=32,s.label.yy+=32,s.snapButton.yy+=32,s.features=ml5.featureExtractor("MobileNet",(function(){console.log("MobileNet Feature Extractor is ready"),s.ready=!0,s.label.setText("Ready"),console.log(s.features)})),s}return s(i,[{key:"getSoftMax",value:function(t){for(var e=[0,0,0],i=[-1,-1,-1],s=0;s<t.length;s++){var n=t[s];n>e[0]?(e[0]=n,i[0]=s):n>e[1]&&n<e[0]?(e[1]=n,i[1]=s):n>e[2]&&n<e[1]&&(e[2]=n,i[2]=s)}return i}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addSelectMenu(["Output Raw Data","Output Flatten Array"],this.outputType,(function(e,i){t.hideMenu(),t.outputType=i,0==t.outputType?t.outType="logits":1==t.outputType&&(t.outType="tensor")})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){if(this.inElement.output&&(!this.outElement||!this.outputIsReady)){this.inElement&&(this.inElement.outputIsReady=!1),this.busy=!0;var t=this.features.infer(this.inElement.output);this.data=t.dataSync(),this.label.setText("Ready (".concat(this.mode,")")),this.numResults=256,"logits"==this.outType?this.output=t:this.output=Array.prototype.slice.call(this.data),this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0}return!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready")}},{key:"draw",value:function(t){a(l(i.prototype),"draw",this).call(this,t);var e=this.mlx.mlxCaptionHeight+44;t.stroke(211),t.line(this.x,this.y+e,this.x+this.w,this.y+e),e+=32;var s=this.x+130;if(this.output){var n=this.data;t.noStroke(),t.fill(0),t.text("Real-time logits",s-120,this.y+e-24),t.stroke(64);for(var r=0;r<n.length;r++)t.line(s+r,this.y+e-3,s+r,this.y+e-3-25*n[r]/3)}t.stroke(211),t.line(this.x,this.y+e,this.x+this.w,this.y+e),e+=32;for(var o=0;o<this.snapData.length;o++){var h=this.snapData[o];t.noStroke(),t.fill(0),t.text("Logit snap #".concat(o+1),s-120,this.y+e-24),t.stroke(128);for(this.x,h.length,r=0;r<h.length;r++)t.line(s+r,this.y+e-3,s+r,this.y+e-3-25*h[r]/3);t.stroke(211),t.line(this.x,this.y+e,this.x+this.w,this.y+e),e+=32}}}]),i}(m),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;r(this,i),(s=e.call(this,t)).category="Model",s.type="MobileNetClassifier",s.title="MobileNet Classifier",s.inType="image",s.outType="results",s.w=400,s.h=100,s.createElementMenu(),s.mode="classify",s.needMouse=!0,s.classNames=["A","B","C","D","E"],s.currentClass="A",s.classes=[],s.counts=[0,0,0,0,0],s.currentClassIndex=0,s.classifier=null,s.trained=!1,s.losses=[],s.highestLoss=0,s.icon=s.mlx.createImage(n(s),"/assets/iconMobileNetClassifier.jpg",1,s.mlx.mlxCaptionHeight+1,398,44),s.label=s.mlx.createLabel(n(s),"Loading...",8,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.categoryMenu=s.mlx.createMenu(n(s),10,s.mlx.mlxCaptionHeight+44+10),s.select=s.categoryMenu.addSelectMenu(["A","B","C","D","E"],-1,(function(t,e){s.inElement&&s.inElement.output&&e>=0&&(s.currentClass=s.classNames[e],s.currentClassIndex=e)})),s.categoryMenu.w=75,s.trainLogX=95,s.trainLogY=s.mlx.mlxCaptionHeight+44+10,s.trainLogW=s.w-105,s.trainLogH=s.categoryMenu.h,console.log(s.categoryMenu.h),s.labelTrain=s.mlx.createLabel(n(s),"No training data",s.trainLogX,s.trainLogY+s.trainLogH+4,s.trainLogW,24),s.getButton=s.mlx.createButton(n(s),"add",(function(){s.inElement&&s.inElement.output&&(console.log("add",s.currentClass),s.counts[s.currentClassIndex]+=1,s.select.setTitle(s.currentClassIndex,"".concat(s.currentClass," (").concat(s.counts[s.currentClassIndex],")")),s.classifier.addImage(s.inElement.output,s.currentClass),-1==s.classes.indexOf(s.currentClass)&&s.classes.push(s.currentClass))}),10,205,75,24),s.getButton.border=!0,s.getButton.hidden=!0,s.trainButton=s.mlx.createButton(n(s),"train",(function(){console.log("train"),s.inElement&&s.inElement.output&&s.classifier&&(s.losses=[],s.highestLoss=0,s.classifier.train((function(t){t?(s.loss=t,console.log("Loss: "+s.loss),s.labelTrain.setText("Loss: "+s.loss),s.losses.push(t),t>s.highestLoss&&(s.highestLoss=t),s.drawed=!1):(console.log("Done Training! Final Loss: "+s.loss),s.labelTrain.setText("Done Training! Final Loss: "+s.loss),s.trained=!0,s.drawed=!1)})))}),s.w-72,s.h-28,68,24),s.trainButton.border=!0;return s.features=ml5.featureExtractor("MobileNet",{numLabels:5},(function(){console.log("MobileNet Feature Extractor is ready"),s.ready=!0,s.label.setText("Ready (No trained data)"),console.log(s.features),s.getButton.hidden=!1})),s.h+=160,s.label.yy+=160,s.trainButton.yy+=160,s.classifier=s.features.classification((function(){})),s}return s(i,[{key:"doProcess",value:function(){var t=this;return!!this.trained&&(this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.classifier.classify(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=i.length,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0)}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready (Trained)"):this.label.setText("Ready (No trained data)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"draw",value:function(t){if(a(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0),t.rect(this.x+this.trainLogX,this.y+this.trainLogY,this.trainLogW,this.trainLogH),!this.drawed){var e=.9*this.trainLogH/this.highestLoss,s=this.y+this.trainLogY+this.trainLogH,n=this.x+this.trainLogX,r=this.trainLogW/this.losses.length;r>10&&(r=10),t.beginShape();for(var o=0;o<this.losses.length;o++){var h=s-e*this.losses[o];t.vertex(n+o*r,h)}t.endShape()}}}]),i}(m),v=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).category="Model",s.type="MobileNetRegressor",s.title="MobileNet Regressor",s.inType="image",s.outType="results",s.w=400,s.h=100,s.createElementMenu(),s.mode="regression",s.needMouse=!0,s.currentClassIndex=0,s.trained=!1,s.losses=[],s.highestLoss=0,s.regressor=null,s.currentValue=0,s.counts=0,s.icon=s.mlx.createImage(n(s),"/assets/iconMobileNetRegressor.jpg",1,s.mlx.mlxCaptionHeight+1,398,44),s.label=s.mlx.createLabel(n(s),"Loading...",8,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.slider=s.mlx.createVerticalSlider(n(s),(function(t){s.currentValue=t}),s.currentValue,0,1,20,s.mlx.mlxCaptionHeight+44+10,15,122),s.trainLogX=95,s.trainLogY=s.mlx.mlxCaptionHeight+44+10,s.trainLogW=s.w-105,s.trainLogH=122,s.labelTrain=s.mlx.createLabel(n(s),"No training data",s.trainLogX,s.trainLogY+s.trainLogH+4,s.trainLogW,24),s.getButton=s.mlx.createButton(n(s),"add",(function(){s.inElement&&s.inElement.output&&(console.log("add",s.currentValue),s.counts+=1,s.regressor.addImage(s.inElement.output,s.currentValue),s.labelTrain.setText("".concat(s.counts," data was added.")))}),10,205,75,24),s.getButton.border=!0,s.trainButton=s.mlx.createButton(n(s),"train",(function(){console.log("train"),s.inElement&&s.inElement.output&&s.regressor&&(s.losses=[],s.highestLoss=0,s.regressor.train((function(t){t?(s.loss=t,console.log("Loss: "+s.loss),s.labelTrain.setText("Loss: "+s.loss),s.losses.push(t),t>s.highestLoss&&(s.highestLoss=t),s.drawed=!1):(console.log("Done Training! Final Loss: "+s.loss),s.labelTrain.setText("Done Training! Final Loss: "+s.loss),s.trained=!0,s.drawed=!1)})))}),s.w-72,s.h-28,68,24),s.trainButton.border=!0,s.features=ml5.featureExtractor("MobileNet",(function(){console.log("MobileNet Feature Extractor is ready"),s.ready=!0,s.label.setText("Ready (No trained data)"),console.log(s.features)})),s.h+=160,s.label.yy+=160,s.trainButton.yy+=160,s.regressor=s.features.regression((function(){console.log("Regression Ready"),s.getButton.hidden=!1})),s}return s(i,[{key:"doProcess",value:function(){var t=this;return!!this.trained&&(this.inElement.output&&(this.outElement&&this.outputIsReady||(this.busy=!0,this.inElement&&(this.inElement.outputIsReady=!1),this.regressor.predict(this.inElement.output,(function(e,i){e?console.error(e):(t.numResults=1,t.output=i,t.busy=!1,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.label.setText("".concat(t.numResults," results found")))})))),!0)}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready (Trained)"):this.label.setText("Ready (No trained data)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"draw",value:function(t){if(a(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0),t.rect(this.x+this.trainLogX,this.y+this.trainLogY,this.trainLogW,this.trainLogH),!this.drawed){var e=.9*this.trainLogH/this.highestLoss,s=this.y+this.trainLogY+this.trainLogH,n=this.x+this.trainLogX,r=this.trainLogW/this.losses.length;r>10&&(r=10),t.beginShape();for(var o=0;o<this.losses.length;o++){var h=s-e*this.losses[o];t.vertex(n+o*r,h)}t.endShape()}}}]),i}(m);t.exports={mlxFeatureExtractor:m,mlxMobileNetFeatureExtractor:d,mlxMobileNetClassifier:g,mlxMobileNetRegressor:v}},87501:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="FLowFilter",n.title="Flow Filter",n.inType="results",n.outType="results",n.createElementMenu(),n.needMouse=!0,n.resizable=!1,n.w=250,n.h=65,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentAspectRatio=1,n.filterName=["confidence","label","class ID","box area","box width","box height","box x","box y","box center x","box center y","length (array)"],n.comparatorName=["==",">","<",">=","<=","contains","starts with","ends with"],n.filter=n.mlx.createSelectOption(a(n),n.filterName,null,5,n.mlx.mlxCaptionHeight+5,100,30),n.comparator=n.mlx.createSelectOption(a(n),n.comparatorName,null,110,n.mlx.mlxCaptionHeight+5,50,30),n.inputValue=n.mlx.createTextInput(a(n),"","text",null,165,n.mlx.mlxCaptionHeight+5,80,30),n.outputIsReady=!1,n.ready=!0,n.busy=!1,n}return n(i,[{key:"save",value:function(){var t=r(l(i.prototype),"save",this).call(this);return t.filter=this.filter.getValue(),t.compare=this.comparator.getValue(),t.inputValue=this.inputValue.getText(),t}},{key:"load",value:function(t){r(l(i.prototype),"load",this).call(this,t),this.filter.setValue(t.filter),this.comparator.setValue(t.compare),this.inputValue.setText(t.inputValue)}},{key:"inactivateUI",value:function(){this.filter.select.hide(),this.comparator.select.hide(),this.inputValue.input.hide()}},{key:"activateUI",value:function(){this.filter.select.show(),this.comparator.select.show(),this.inputValue.input.show()}},{key:"compare",value:function(t,e,i){switch(e){case"==":return t==i;case">":return t>i;case"<":return t<i;case">=":return t>=i;case"<=":return t<=i;case"contains":return t.includes(i);case"starts with":return"string"===typeof t&&t.startsWith(i);case"ends with":return"string"===typeof t&&t.endsWith(i)}return!1}},{key:"processFilter",value:function(t,e,i,s){switch(e){case"class ID":return!!t.classId&&this.compare(t.classId,i,s);case"confidence":return!!t.confidence&&this.compare(t.confidence,i,s);case"label":return!!t.label&&this.compare(t.label,i,s);case"box area":return!(!t.width||!t.height)&&this.compare(t.width*t.height,i,s);case"box width":return!!t.width&&this.compare(t.width,i,s);case"box height":return!!t.height&&this.compare(t.height,i,s);case"box x":return!!t.x&&this.compare(t.x,i,s);case"box y":return!!t.y&&this.compare(t.y,i,s);case"box x (center)":return!(!t.x||!t.width)&&this.compare((t.x+t.width)/2,i,s);case"box y (center)":return!(!t.y||!t.height)&&this.compare((t.y+t.height)/2,i,s)}return!1}},{key:"doProcess",value:function(){var t=this;if(this.inElement.output&&(!this.outElement||!this.outputIsReady)){var e=this.filterName[parseInt(this.filter.getValue())],i=this.comparatorName[parseInt(this.comparator.getValue())],s=this.inputValue.getText();if(isNaN(s)||(s=s.includes(".")?parseFloat(s):parseInt(s)),Array.isArray(this.inElement.output)&&this.inElement.output.length>0){var n=this.inElement.output.filter((function(n){return t.processFilter(n,e,i,s)}));n.length>0?(this.output=n,this.outputIsReady=!0):this.outputIsReady=!1}else{this.processFilter(this.inElement.output,e,i,s)?(this.output=this.inElement.output,this.outputIsReady=!0):this.outputIsReady=!1}}return this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t)}}]),i}(c)),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="FLowMerge",n.title="Merge",n.inType="results",n.outType="results",n.allowExtraInElement=!0,n.createElementMenu(),n.needMouse=!1,n.resizable=!1,n.w=100,n.h=55,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentAspectRatio=1,n.label=n.mlx.createLabel(a(n),"Ready",n.mlx.mlxPadding,n.mlx.mlxCaptionHeight+5,n.w-2*n.mlx.mlxPadding-5,24),n.ready=!0,n.busy=!1,n}return n(i,[{key:"doProcess",value:function(){var t=[];for(var e in this.inElement.output&&(this.outElement&&this.outputIsReady||(Array.isArray(this.inElement.output)&&this.inElement.output.length>0?t=t.concat(this.inElement.output):t.push(this.inElement.output))),this.extraInElement){var i=this.extraInElement[e];i.output&&i.outputIsReady&&(Array.isArray(i.output)&&i.output.length>0?t=t.concat(i.output):t.push(i.output),i.outputIsReady=!1)}return t.length>0?(this.output=t,this.outputIsReady=!0):this.outputIsReady=!1,this.label.setText("Output : "+t.length),this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t)}}]),i}(c),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="JSEditor",n.title="Javascript Editor",n.inType="all",n.outType="results",n.createElementMenu(),n.needMouse=!0,n.resizable=!0,n.contentX=0,n.contentY=n.mlx.mlxCaptionHeight,n.w=400,n.h=300,n.contentW=n.w-1,n.contentH=n.h-n.mlx.mlxPadding,n.contentAspectRatio=3,n.divX=n.contentX,n.divY=n.contentY,n.divW=n.contentW,n.divH=n.contentH,n.h+=45,n.div=t.p5.createDiv(),n.div.size(n.divW,n.divH),n.div.position(n.x+n.divX,n.y+n.divY+n.mlx.mlxNavBarHeight),n.div.style("background-color","#FFFFFF"),n.div.style("text-align","left"),n.div.addClass("js-editor"),n.label=n.mlx.createLabel(a(n),"JS Flow Editor : Ready",n.mlx.mlxPadding,n.h-26,n.w-2*n.mlx.mlxPadding-5,24),n.outputIsReady=!1,n.ready=!0,n.busy=!1,n.editor=window.monaco.editor.create(n.div.elt,{value:"function flow(input){\n  // console.log(input);\n  return input;\n}",language:"javascript",theme:"vs-dark"}),n}return n(i,[{key:"save",value:function(){var t=r(l(i.prototype),"save",this).call(this),e=this.editor.getValue();return t.code=e,t}},{key:"load",value:function(t){r(l(i.prototype),"load",this).call(this,t);var e=t.code;this.editor.getModel().setValue(e)}},{key:"inactivateUI",value:function(){this.div.style("display","none")}},{key:"activateUI",value:function(){this.div.style("display","block")}},{key:"resizeByMouse",value:function(){r(l(i.prototype),"resizeByMouse",this).call(this)}},{key:"setContentSizeByElementWidth",value:function(){this.label.yy=this.h-26,this.label.resize(this.w-2*this.mlx.mlxPadding-5,this.label.h),this.div.size(this.w*this.mlx.userScale-1,this.h*this.mlx.userScale-45-this.mlx.mlxPadding),this.editor.layout()}},{key:"doProcess",value:function(){try{if(this.inElement.output&&(!this.outElement||!this.outputIsReady)){var t=this.editor.getValue(),e=new Function("{ return "+t+" };")(null)(this.inElement.output);Array.isArray(e)&&e.length>0?(this.output=e,this.outputIsReady=!0):Array.isArray(e)||null==e?this.outputIsReady=!1:(this.output=e,this.outputIsReady=!0),this.label.setText("READY ...")}}catch(i){this.label.setText("ERROR : "+i.message),this.outputIsReady=!1}return this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.divX,s=this.y+this.divY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale)}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.setPosition(this.x,this.y)}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t)}}]),i}(c);t.exports={mlxFlowFilter:m,mlxFlowMerge:d,mlxJSEditor:g}},12783:function(t,e,i){var s=i(18770),n=i(2553),a=i(62012),r=i(50450),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput),m=(p.mlxElementModel,p.mlxElementOutput),d=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;n(this,i),(s=e.call(this,t)).category="Input",s.type="GamePad",s.title="GamePad",s.inType="none",s.outType="results",s.needMouse=!0,s.canvasSize=120,s.createElementMenu(),s.w=s.canvasSize+2*s.mlx.mlxPadding,s.h=176+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding;var a=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,o=s.mlx.mlxPadding+43;return s.buttonA=s.mlx.createButton(r(s),"A",(function(){s.cmd("A")}),o,a,34,24),s.buttonA.border=!0,o=s.mlx.mlxPadding,a+=32,s.buttonB=s.mlx.createButton(r(s),"B",(function(){s.cmd("B")}),o,a,34,24),s.buttonB.border=!0,o+=43,s.buttonC=s.mlx.createButton(r(s),"C",(function(){s.cmd("C")}),o,a,34,24),s.buttonC.border=!0,o+=44,s.buttonD=s.mlx.createButton(r(s),"D",(function(){s.cmd("D")}),o,a,34,24),s.buttonD.border=!0,o=s.mlx.mlxPadding+43,a+=32,s.buttonE=s.mlx.createButton(r(s),"E",(function(){s.cmd("E")}),o,a,34,24),s.buttonE.border=!0,o=s.mlx.mlxPadding,a+=48,s.buttonF=s.mlx.createButton(r(s),"F",(function(){s.cmd("F")}),o,a,34,24),s.buttonF.border=!0,o+=43,s.buttonG=s.mlx.createButton(r(s),"G",(function(){s.cmd("G")}),o,a,34,24),s.buttonG.border=!0,o+=44,s.buttonH=s.mlx.createButton(r(s),"H",(function(){s.cmd("H")}),o,a,34,24),s.buttonH.border=!0,o=s.mlx.mlxPadding,a+=32,s.buttonI=s.mlx.createButton(r(s),"I",(function(){s.cmd("I")}),o,a,34,24),s.buttonI.border=!0,o+=43,s.buttonJ=s.mlx.createButton(r(s),"J",(function(){s.cmd("J")}),o,a,34,24),s.buttonJ.border=!0,o+=44,s.buttonK=s.mlx.createButton(r(s),"K",(function(){s.cmd("K")}),o,a,34,24),s.buttonK.border=!0,s.output="",s.outputIsReady=!1,s.ready=!0,s}return a(i,[{key:"cmd",value:function(t){this.output={label:t},this.outputIsReady=!0}},{key:"doProcess",value:function(){return!!this.outputIsReady&&(this.numResults=1,this.busy=!1,this.outputIsReady=!0,!0)}}]),i}(c)),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return n(this,i),(s=e.call(this,t)).category="Output",s.type="SnakeGame",s.title="Snake Game",s.inType="results",s.outType="results",s.needMouse=!0,s.score=0,s.canvasSize=300,s.gameRunning=!1,s.fps=5,s.createElementMenu(),s.numSegments=0,s.direction="right",s.xStart=0,s.yStart=150,s.diff=6,s.xCor=[],s.yCor=[],s.xFruit=0,s.yFruit=0,s.offScreenX=s.mlx.mlxPadding,s.offScreenY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.offScreen=s.mlx.createCanvas(r(s),s.offScreenX,s.offScreenY,s.canvasSize,s.canvasSize),s.canvas=s.offScreen.offScreen,s.canvas.strokeWeight(s.diff),s.canvas.stroke(255),s.canvas.background(0),s.w=s.canvasSize+2*s.mlx.mlxPadding,s.h=s.canvasSize+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding+32,s.labelScore=s.mlx.createLabel(r(s),s.score,s.mlx.mlxPadding,s.offScreenY+s.canvasSize+5,s.w-2*s.mlx.mlxPadding,24),s.setScore(0),s.buttonStart=s.mlx.createButton(r(s),"Start",(function(){s.startGame()}),s.w-s.mlx.mlxPadding-80,s.offScreenY+s.canvasSize+5,80,24),s.buttonStart.border=!0,s.then=Date.now(),s.output=s.canvas,s.ready=!0,s}return a(i,[{key:"startGame",value:function(){this.xStart=0,this.yStart=150,this.xCor=[],this.yCor=[],this.xFruit=0,this.yFruit=0,this.numSegments=10;for(var t=0;t<this.numSegments;t++)this.xCor.push(this.xStart+t*this.diff),this.yCor.push(this.yStart);this.updateFruitCoordinates(),this.gameRunning=!0}},{key:"setScore",value:function(t){this.score=t,this.labelScore.setText("Score: ".concat(this.score))}},{key:"updateFruitCoordinates",value:function(){this.xFruit=this.p5.floor(this.p5.random(5,this.canvasSize/this.diff-5))*this.diff,this.yFruit=this.p5.floor(this.p5.random(5,this.canvasSize/this.diff-5))*this.diff}},{key:"checkForFruit",value:function(){this.canvas.point(this.xFruit+this.diff/2,this.yFruit+this.diff/2),this.xCor[this.xCor.length-1]===this.xFruit&&this.yCor[this.yCor.length-1]===this.yFruit&&(this.setScore(this.score+1),this.xCor.unshift(this.xCor[0]),this.yCor.unshift(this.yCor[0]),this.numSegments++,this.updateFruitCoordinates())}},{key:"checkSnakeCollision",value:function(){for(var t=this.xCor[this.xCor.length-1],e=this.yCor[this.yCor.length-1],i=0;i<this.xCor.length-1;i++)if(this.xCor[i]===t&&this.yCor[i]===e)return!0}},{key:"checkGameStatus",value:function(){(this.xCor[this.xCor.length-1]>this.canvasSize||this.xCor[this.xCor.length-1]<0||this.yCor[this.yCor.length-1]>this.canvasSize||this.yCor[this.yCor.length-1]<0||this.checkSnakeCollision())&&(this.labelScore.setText("Game ended! Score: "+this.score),this.gameRunning=!1)}},{key:"draw",value:function(t){if(s(l(i.prototype),"draw",this).call(this,t),this.gameRunning){var e=1e3/this.fps;this.now=Date.now();var n=this.now-this.then;if(n>e){this.canvas.background(0);for(var a=0;a<this.numSegments-1;a++)this.canvas.line(this.xCor[a]+this.diff/2,this.yCor[a]+this.diff/2,this.xCor[a+1]+this.diff/2,this.yCor[a+1]+this.diff/2);this.updateSnakeCoordinates(),this.checkGameStatus(),this.checkForFruit(),this.then=this.now-n%e}}}},{key:"doProcess",value:function(){return this.results=this.inElement.output,this.key=null,Array.isArray(this.results)?this.results[0].label&&(this.key=this.results[0].label):this.results.label&&(this.key=this.results.label),"A"==this.key?"down"!==this.direction&&(this.direction="up"):"B"==this.key?"right"!==this.direction&&(this.direction="left"):"D"==this.key?"left"!==this.direction&&(this.direction="right"):"E"==this.key&&"up"!==this.direction&&(this.direction="down"),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"updateSnakeCoordinates",value:function(){for(var t=0;t<this.numSegments-1;t++)this.xCor[t]=this.xCor[t+1],this.yCor[t]=this.yCor[t+1];switch(this.direction){case"right":this.xCor[this.numSegments-1]=this.xCor[this.numSegments-2]+this.diff,this.yCor[this.numSegments-1]=this.yCor[this.numSegments-2];break;case"up":this.xCor[this.numSegments-1]=this.xCor[this.numSegments-2],this.yCor[this.numSegments-1]=this.yCor[this.numSegments-2]-this.diff;break;case"left":this.xCor[this.numSegments-1]=this.xCor[this.numSegments-2]-this.diff,this.yCor[this.numSegments-1]=this.yCor[this.numSegments-2];break;case"down":this.xCor[this.numSegments-1]=this.xCor[this.numSegments-2],this.yCor[this.numSegments-1]=this.yCor[this.numSegments-2]+this.diff}}}]),i}(m),v=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return n(this,i),(s=e.call(this,t)).category="Output",s.type="PongGame",s.title="Pong Game",s.inType="results",s.outType="results",s.needMouse=!0,s.score=0,s.canvasSizeW=400,s.canvasSizeH=300,s.gameRunning=!1,s.fps=60,s.createElementMenu(),s.width=s.canvasSizeW,s.height=s.canvasSizeH,s.MAX_SPEED=5,s.paddleA=s.p5.createSprite(15,s.height/2,10,70),s.paddleA.immovable=!0,s.paddleB=s.p5.createSprite(s.width-14,s.height/2,10,70),s.paddleB.immovable=!0,s.wallTop=s.p5.createSprite(s.width/2,0,s.width,1),s.wallTop.immovable=!0,s.wallBottom=s.p5.createSprite(s.width/2,s.height-1,s.width,1),s.wallBottom.immovable=!0,s.ball=s.p5.createSprite(s.width/2,s.height/2,10,10),s.ball.maxSpeed=s.MAX_SPEED,s.paddleA.shapeColor=s.paddleB.shapeColor=s.ball.shapeColor=s.p5.color(255,255,255),s.wallTop.shapeColor=s.wallBottom.shapeColor=s.p5.color(0,0,0,0),s.ball.setSpeed(s.MAX_SPEED,-180),s.group=new s.p5.Group,s.paddleA.addToGroup(s.group),s.paddleB.addToGroup(s.group),s.wallTop.addToGroup(s.group),s.wallBottom.addToGroup(s.group),s.paddleA.addToGroup(s.group),s.ball.addToGroup(s.group),s.numSegments=0,s.direction="right",s.xStart=0,s.yStart=150,s.diff=2,s.offScreenX=s.mlx.mlxPadding,s.offScreenY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.p5.fill(0),s.p5.rect(s.x+s.offScreenX,s.y+s.offScreenY,s.canvasSizeW,s.canvasSizeH),s.p5.strokeWeight(s.diff),s.p5.stroke(255),s.w=s.canvasSizeW+2*s.mlx.mlxPadding,s.h=s.canvasSizeH+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding+32,s.labelScore=s.mlx.createLabel(r(s),s.score,s.mlx.mlxPadding,s.offScreenY+s.canvasSizeH+5,s.w-2*s.mlx.mlxPadding,24),s.setScore(0),s.buttonStart=s.mlx.createButton(r(s),"Start",(function(){s.startGame()}),s.w-s.mlx.mlxPadding-80,s.offScreenY+s.canvasSizeH+5,80,24),s.buttonStart.border=!0,s.then=Date.now(),s.output=s.canvas,s.ready=!0,s}return a(i,[{key:"startGame",value:function(){this.xStart=0,this.yStart=150,this.gameRunning=!0}},{key:"setScore",value:function(t){this.score=t}},{key:"remove",value:function(){this.group&&this.group.removeSprites(),s(l(i.prototype),"remove",this).call(this)}},{key:"draw",value:function(t){if(s(l(i.prototype),"draw",this).call(this,t),this.gameRunning){t.push();var e,n=this.x+this.offScreenX,a=this.y+this.offScreenY;t.translate(n,a),t.fill(0),t.rect(0,0,this.canvasSizeW,this.canvasSizeH),this.inElement?(this.paddleA.position.y=t.constrain(this.paddleA.position.y,this.paddleA.height/2,this.height-this.paddleA.height/2),this.paddleB.position.y=t.constrain(this.paddleB.position.y,this.paddleA.height/2,this.height-this.paddleA.height/2)):(this.paddleA.position.y=t.constrain(t.mouseY-a,this.paddleA.height/2,this.height-this.paddleA.height/2),this.paddleB.position.y=t.constrain(t.mouseY-a,this.paddleA.height/2,this.height-this.paddleA.height/2)),this.ball.bounce(this.wallTop),this.ball.bounce(this.wallBottom),this.ball.bounce(this.paddleA)&&(e=(this.ball.position.y-this.paddleA.position.y)/3,this.ball.setSpeed(this.MAX_SPEED,this.ball.getDirection()+e)),this.ball.bounce(this.paddleB)&&(e=(this.ball.position.y-this.paddleB.position.y)/3,this.ball.setSpeed(this.MAX_SPEED,this.ball.getDirection()-e)),this.ball.position.x<0&&(this.ball.position.x=this.width/2,this.ball.position.y=this.height/2,this.ball.setSpeed(this.MAX_SPEED,0)),this.ball.position.x>this.width&&(this.ball.position.x=this.width/2,this.ball.position.y=this.height/2,this.ball.setSpeed(this.MAX_SPEED,180)),this.group&&this.group.draw(),t.pop()}}},{key:"doProcess",value:function(){return this.results=this.inElement.output,this.key=null,Array.isArray(this.results)?this.results[0].label&&(this.key=this.results[0].label):this.results.label&&(this.key=this.results.label),"A"==this.key?this.paddleA.position.y-=15:"E"==this.key?this.paddleA.position.y+=15:"G"==this.key?this.paddleB.position.y-=15:"J"==this.key&&(this.paddleB.position.y+=15),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}}]),i}(m),f=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;n(this,i),(s=e.call(this,t)).category="Output",s.type="BreakoutGame",s.title="Breakout Game",s.inType="results",s.outType="results",s.needMouse=!0,s.score=0,s.canvasSizeW=400,s.canvasSizeH=300,s.gameRunning=!1,s.fps=60,s.createElementMenu(),s.width=s.canvasSizeW,s.height=s.canvasSizeH,s.MAX_SPEED=5,s.paddle=s.p5.createSprite(s.width/2,s.height-25,70,10),s.paddle.immovable=!0,s.wallTop=s.p5.createSprite(s.width/2,0,s.width,1),s.wallTop.immovable=!0,s.wallBottom=s.p5.createSprite(s.width/2,s.height-1,s.width,1),s.wallBottom.immovable=!0,s.wallLeft=s.p5.createSprite(0,s.height/2,1,s.height),s.wallLeft.immovable=!0,s.wallRight=s.p5.createSprite(s.width,s.height/2,1,s.height),s.wallRight.immovable=!0;var a=s.width/2-165;s.bricks=new s.p5.Group;for(var o=0;o<9;o++)for(var h=0;h<16;h++){var l=s.p5.createSprite(a+22*h,40+12*o,20,10);l.shapeColor=s.p5.color(255,255,255),l.addToGroup(s.bricks),l.immovable=!0}return s.ball=s.p5.createSprite(s.width/2,s.height-100,10,10),s.ball.maxSpeed=s.MAX_SPEED,s.paddle.shapeColor=s.ball.shapeColor=s.p5.color(255,255,255),s.wallTop.shapeColor=s.wallBottom.shapeColor=s.wallLeft.shapeColor=s.wallRight.shapeColor=s.p5.color(0,0,0,0),s.group=new s.p5.Group,s.paddle.addToGroup(s.group),s.wallTop.addToGroup(s.group),s.wallBottom.addToGroup(s.group),s.wallLeft.addToGroup(s.group),s.wallRight.addToGroup(s.group),s.ball.addToGroup(s.group),s.numSegments=0,s.direction="right",s.xStart=0,s.yStart=150,s.diff=2,s.offScreenX=s.mlx.mlxPadding,s.offScreenY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.p5.fill(0),s.p5.rect(s.x+s.offScreenX,s.y+s.offScreenY,s.canvasSizeW,s.canvasSizeH),s.p5.strokeWeight(s.diff),s.p5.stroke(255),s.w=s.canvasSizeW+2*s.mlx.mlxPadding,s.h=s.canvasSizeH+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding+32,s.labelScore=s.mlx.createLabel(r(s),s.score,s.mlx.mlxPadding,s.offScreenY+s.canvasSizeH+5,s.w-2*s.mlx.mlxPadding,24),s.setScore(0),s.buttonStart=s.mlx.createButton(r(s),"Start",(function(){s.startGame()}),s.w-s.mlx.mlxPadding-80,s.offScreenY+s.canvasSizeH+5,80,24),s.buttonStart.border=!0,s.then=Date.now(),s.output=s.canvas,s.ready=!0,s}return a(i,[{key:"startGame",value:function(){console.log("startGame()"),this.xStart=0,this.yStart=150,0==this.ball.velocity.x&&0==this.ball.velocity.y&&(this.ball.setSpeed(this.MAX_SPEED,this.p5.random(80,100)),console.log("startGame + ball.setSpeed")),this.gameRunning=!0,console.log("startGame() this.gameRunning = true")}},{key:"setScore",value:function(t){this.score=t}},{key:"remove",value:function(){this.bricks&&this.bricks.removeSprites(),this.group&&this.group.removeSprites(),s(l(i.prototype),"remove",this).call(this)}},{key:"draw",value:function(t){if(s(l(i.prototype),"draw",this).call(this,t),this.gameRunning){t.push();var e=this.x+this.offScreenX,n=this.y+this.offScreenY;if(t.translate(e,n),t.fill(247,134,131),t.rect(0,0,this.canvasSizeW,this.canvasSizeH),this.inElement?this.paddle.position.x=t.constrain(this.paddle.position.x,this.paddle.width/2,this.width-this.paddle.width/2):this.paddle.position.x=t.constrain(t.mouseX-e,this.paddle.width/2,this.width-this.paddle.width/2),this.ball.bounce(this.wallTop),this.ball.bounce(this.wallBottom),this.ball.bounce(this.wallLeft),this.ball.bounce(this.wallRight),this.ball.bounce(this.paddle)){var a=(this.ball.position.x-this.paddle.position.x)/3;this.ball.setSpeed(this.MAX_SPEED,this.ball.getDirection()+a)}this.ball.bounce(this.bricks,(function(t,e){e.remove()})),this.bricks&&this.bricks.draw(),this.group&&this.group.draw(),t.pop()}}},{key:"doProcess",value:function(){return this.results=this.inElement.output,this.key=null,Array.isArray(this.results)?this.results[0].label&&(this.key=this.results[0].label):this.results.label&&(this.key=this.results.label),"B"==this.key?this.paddle.position.x-=15:"D"==this.key&&(this.paddle.position.x+=15),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}}]),i}(m);t.exports={mlxGamePad:d,mlxSnakeGame:g,mlxPongGame:v,mlxBreakoutGame:f}},45699:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="JungleJumper",n.category="Output",n.type="JungleJumperGame",n.inType="results",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=400,n.canvas_w=400,n.canvas_h=250,n.fullscreen=!1,n.fullscreen_scale=1,n.w=400+2*n.mlx.mlxPadding,n.h=250+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=25,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w,n.canvas_h),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.MAIN_SPEED=.35,n.GAMEPHASE="PREGAME",n.TIME_SLIDE=800,n.ui,n.font,n.img_logo,n.obstacleGenerator,n.character,n.character_w=25,n.character_h=40,n.character_w_slide=40,n.character_h_slide=25,n.img_run,n.image_jump,n.image_landing,n.image_particle,n.TILE_TOTAL,n.TILE_LOOP_NO=[],n.floorTile,n.img_tile_floor,n.img_floor_start,n.img_floor_end,n.img_slide,n.floor_w=26,n.floor_h=50,n.img_p1,n.img_p2,n.img_p3,n.parallaxBG1,n.parallaxBG2,n.parallaxBG3,n.sound_slide,n.sound_fall,n.sound_jump,n.sound_hit,n.sound_readygo,n.pits=[],n.pitCount=0,n.spikes=[],n.spikeCount,n.img_spike,n.spike_w=40,n.spike_h=178,n.food=[],n.foodCount=0,n.img_food,n.foodScore=0,n.preload(),n.setup(),console.log("Game Art (Free Commercial Licens) from https://jesse-m.itch.io/jungle-pack/"),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.canvas_w,this.canvas_h),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.canvas_w;var t=(this.h-110)/this.canvas_h;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.canvas_w*this.fullscreen_scale,this.canvas_h*this.fullscreen_scale)}},{key:"preload",value:function(){this.img_logo=this.p5.loadImage("assets_game/mlxJungleJumper/logo.png"),this.img_run_1=this.p5.loadImage("assets_game/mlxJungleJumper/run_1.png"),this.img_run_2=this.p5.loadImage("assets_game/mlxJungleJumper/run_2.png"),this.img_run_3=this.p5.loadImage("assets_game/mlxJungleJumper/run_3.png"),this.img_run_4=this.p5.loadImage("assets_game/mlxJungleJumper/run_4.png"),this.img_run_5=this.p5.loadImage("assets_game/mlxJungleJumper/run_5.png"),this.img_run_6=this.p5.loadImage("assets_game/mlxJungleJumper/run_6.png"),this.img_run_7=this.p5.loadImage("assets_game/mlxJungleJumper/run_7.png"),this.img_run_8=this.p5.loadImage("assets_game/mlxJungleJumper/run_8.png"),this.image_jump=this.p5.loadImage("assets_game/mlxJungleJumper/jump.png"),this.image_landing=this.p5.loadImage("assets_game/mlxJungleJumper/landing.png"),this.img_slide=this.p5.loadImage("assets_game/mlxJungleJumper/slide.png"),this.image_particle=this.p5.loadImage("assets_game/mlxJungleJumper/particle.png"),this.img_tile_floor=this.p5.loadImage("assets_game/mlxJungleJumper/tilefloor.png"),this.img_floor_start=this.p5.loadImage("assets_game/mlxJungleJumper/tilefloor_start.png"),this.img_floor_end=this.p5.loadImage("assets_game/mlxJungleJumper/tilefloor_end.png"),this.img_spike=this.p5.loadImage("assets_game/mlxJungleJumper/spike.png"),this.img_p1=this.p5.loadImage("assets_game/mlxJungleJumper/plx-5.png"),this.img_p2=this.p5.loadImage("assets_game/mlxJungleJumper/plx-4.png"),this.img_p3=this.p5.loadImage("assets_game/mlxJungleJumper/plx-2.png"),this.img_food=this.p5.loadImage("assets_game/mlxJungleJumper/sandwich.png"),this.sound_slide=this.p5.loadSound("assets_game/mlxJungleJumper/slide.mp3"),this.sound_fall=this.p5.loadSound("assets_game/mlxJungleJumper/fall.mp3"),this.sound_jump=this.p5.loadSound("assets_game/mlxJungleJumper/jump.mp3"),this.sound_hit=this.p5.loadSound("assets_game/mlxJungleJumper/hit.mp3"),this.sound_readygo=this.p5.loadSound("assets_game/mlxJungleJumper/readygo.mp3"),this.sound_collect=this.p5.loadSound("assets_game/mlxJungleJumper/correct.mp3"),this.font=this.p5.loadFont("assets_game/mlxJungleJumper/Anakotmai-Bold.ttf")}},{key:"setup",value:function(){this.TILE_TOTAL=0,this.MAIN_SPEED=.35,this.GAMEPHASE="PREGAME",this.ui=new g(this),this.character=new d(this),this.floorTile=new v(this),this.parallaxBG1=new _(this.img_p1,8,this),this.parallaxBG2=new _(this.img_p2,4,this),this.parallaxBG3=new _(this.img_p3,1,this),this.img_run_array=[this.img_run_1,this.img_run_2,this.img_run_3,this.img_run_4,this.img_run_5,this.img_run_6,this.img_run_7,this.img_run_8]}},{key:"doProcess",value:function(){return this.results=this.inElement.output,this.key=null,Array.isArray(this.results)?this.results[0].label&&(this.key=this.results[0].label):this.results.label&&(this.key=this.results.label),"A"==this.key?this.actionJump():"E"==this.key?this.actionSlide():"C"==this.key&&this.actionStart(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t),this.precanvas.push(),this.precanvas.background(0),this.parallaxBG3.draw(),this.parallaxBG2.draw(),this.parallaxBG1.draw(),"PLAY"==this.GAMEPHASE&&(this.precanvas.push(),this.precanvas.stroke(255,0,0,60),this.precanvas.strokeWeight(5),this.precanvas.line(this.canvas_w/2,0,this.canvas_w/2,this.canvas_h),this.precanvas.pop()),this.floorTile.draw();for(var e=0;e<this.spikeCount;e++)this.spikes[e].draw();if(this.spikeCount>0&&this.spikes[0].markForRemove){for(e=0;e<this.spikeCount+1;e++)this.spikes[e]=this.spikes[e+1];this.spikeCount--}for(e=0;e<this.foodCount;e++)this.food[e].draw();if(this.foodCount>0&&this.food[0].markForRemove){for(e=0;e<this.foodCount+1;e++)this.food[e]=this.food[e+1];this.foodCount--}this.character.calculateAndDraw(this.floor_h)>this.canvas_h&&"PLAY"==this.GAMEPHASE&&(this.MAIN_SPEED=0,this.GAMEPHASE="OVER",this.sound_fall.play());for(e=0;e<this.spikeCount;e++)this.spikes[e].collide(this.p5.createVector(this.character.positionXOnScreen-this.character.characterWidth/2,this.character.previousPositionY-this.character.characterHeight/2),this.p5.createVector(this.character.characterWidth,this.character.characterHeight))&&"OVER"!=this.GAMEPHASE&&(this.MAIN_SPEED=0,this.GAMEPHASE="OVER",this.sound_hit.play());for(e=0;e<this.foodCount;e++)this.food[e].collide(this.p5.createVector(this.character.positionXOnScreen-this.character.characterWidth/2,this.character.previousPositionY-this.character.characterHeight/2),this.p5.createVector(this.character.characterWidth,this.character.characterHeight))&&"OVER"!=this.GAMEPHASE&&(this.foodScore+=1,this.food[e].markForRemove=!0,this.sound_collect.play());"PLAY"==this.GAMEPHASE&&this.obstacleGenerator.checkForObstacleGeneration(),this.ui.draw(),this.precanvas.pop(),this.canvas.push(),this.fullscreen&&this.canvas.scale(this.fullscreen_scale),this.canvas.image(this.precanvas,0,0),this.canvas.pop()}},{key:"resetGame",value:function(){this.GAMEPHASE="PLAY",this.MAIN_SPEED=.35,this.ui=new g(this),this.character=new d(this),this.floorTile=new v(this),this.foodScore=0,this.foodCount=0,this.pitCount=0,this.spikeCount=0,this.obstacleGenerator=new f(this.floorTile.tileCount+16,this),this.sound_readygo.play()}},{key:"actionJump",value:function(){"RUN"==this.character.currentAction&&"OVER"!=this.GAMEPHASE&&(this.sound_jump.play(),this.character.currentAction="JUMP",this.character.velocityY=.5)}},{key:"actionSlide",value:function(){"RUN"==this.character.currentAction&&"OVER"!=this.GAMEPHASE&&(this.sound_slide.play(),this.character.currentAction="SLIDE",this.character.currentActionTime=this.TIME_SLIDE)}},{key:"actionStart",value:function(){"PREGAME"!=this.GAMEPHASE&&"OVER"!=this.GAMEPHASE||this.resetGame()}}]),i}(c)),d=function(){"use strict";function t(e){s(this,t),this.parent=e,this.gravity=-.001,this.positionY=0,this.velocityY=0,this.previousPositionY=0,this.currentAction="RUN",this.currentActionTime=0,this.totalMeter=0,this.positionXOnScreen=this.parent.canvas_w/4,this.framecount=0,this.frametime=150,this.currentframe=0}return n(t,[{key:"calculateAndDraw",value:function(t){"SLIDE"==this.currentAction?(this.characterWidth=this.parent.character_w_slide,this.characterHeight=this.parent.character_h_slide):(this.characterWidth=this.parent.character_w,this.characterHeight=this.parent.character_h),"OVER"!=this.parent.GAMEPHASE&&(this.floorHeight=t,this.positionY+=this.velocityY*this.parent.p5.deltaTime,this.velocityY+=this.gravity*this.parent.p5.deltaTime,this.parent.floorTile.collide(this.parent.p5.createVector(this.positionXOnScreen-this.characterWidth/2,this.parent.canvas_h-this.positionY-this.characterHeight/2),this.parent.p5.createVector(this.characterWidth,this.characterHeight))&&("SLIDE"==this.currentAction?this.velocityY=this.positionY=0:this.positionY<0&&(this.velocityY=this.positionY=0,this.currentAction="RUN")));var e=this.parent.canvas_h-this.positionY-this.characterHeight/2-this.floorHeight;if(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),"OVER"==this.parent.GAMEPHASE)this.parent.precanvas.tint(100,255),this.parent.precanvas.image(this.parent.image_jump,this.positionXOnScreen,e,this.characterWidth,this.characterHeight);else if("SLIDE"==this.currentAction)this.parent.precanvas.image(this.parent.img_slide,this.positionXOnScreen,e,this.characterWidth,this.characterHeight),this.currentActionTime-=this.parent.p5.deltaTime,this.currentActionTime<=0&&(this.currentAction="RUN");else if(e=this.parent.canvas_h-this.positionY-this.characterHeight/2-this.floorHeight,this.previousPositionY<e)this.parent.precanvas.image(this.parent.image_landing,this.positionXOnScreen,e,this.characterWidth,this.characterHeight);else if(this.previousPositionY>e)this.parent.precanvas.image(this.parent.image_jump,this.positionXOnScreen,e,this.characterWidth,this.characterHeight);else{this.frametime-=this.parent.p5.deltaTime,this.frametime<0&&(this.frametime=150,this.currentframe++,this.currentframe>=8&&(this.currentframe=0));var i=this.parent.img_run_array[this.currentframe];this.parent.precanvas.image(i,this.positionXOnScreen,e,this.characterWidth,this.characterHeight)}return this.previousPositionY=e,this.parent.precanvas.pop(),e}},{key:"checkCollideWithSpike",value:function(){for(var t=0;t<this.parent.spikeCount;t++)if(this.parent.spikes[t].collide(this.parent.p5.createVector(this.positionXOnScreen,this.previousPositionY),this.parent.p5.createVector(this.characterWidth,this.characterHeight)))return!0;return!1}}]),t}(),g=function(){"use strict";function t(e){s(this,t),this.parent=e,this.alpha_1=0,this.alpha_2=0,this.countdown=4}return n(t,[{key:"draw",value:function(){var t=this.parent.canvas_w,e=this.parent.canvas_h;if(this.parent.precanvas.push(),this.parent.precanvas.textFont(this.parent.font),"PREGAME"==this.parent.GAMEPHASE)this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(12,0,4),this.parent.precanvas.fill(255,0,0),this.parent.precanvas.text("How to Setup",t/2,e/2+20),this.parent.precanvas.fill(255),this.parent.precanvas.text('"A" to Jump',t/2,e/2+38),this.parent.precanvas.text('"E" to Slide',t/2,e/2+54),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text('"C" to Start Game',t/2,e/2+67),this.alpha_1+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.tint(255,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.image(this.parent.img_logo,t/2,e/2-50);else if("PLAY"==this.parent.GAMEPHASE){if(this.countdown<0)this.parent.precanvas.push(),this.parent.precanvas.textAlign(this.parent.p5.LEFT),this.setTextSizeStrokeWeight(15,0,4),this.parent.precanvas.fill(255,230,0),this.parent.precanvas.text("Distance "+this.parent.p5.int(this.parent.character.totalMeter)+" m.",10,30),this.parent.precanvas.pop();else if(this.countdown>=0){this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(100,0,4);var i=255*(this.countdown-this.parent.p5.int(this.countdown));this.parent.precanvas.stroke(0,i),this.parent.precanvas.fill(255,0,0,i),this.countdown>1?this.parent.precanvas.text(this.parent.p5.int(this.countdown),t/2,e/2):this.parent.precanvas.text("GO!",t/2,e/2),this.countdown-=this.parent.p5.deltaTime/1e3,this.parent.character.totalMeter=0}}else"OVER"==this.parent.GAMEPHASE&&(this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(15,0,4),this.parent.precanvas.fill(157,255,134),this.parent.precanvas.text("Your distance "+this.parent.character.totalMeter+" m.",t/2,e/2+20),this.parent.precanvas.text("Food x"+this.parent.foodScore+" piece(s).",t/2,e/2+40),this.parent.precanvas.fill(100,255,100),this.parent.precanvas.text("Total "+this.parent.p5.int(this.parent.character.totalMeter+10*this.parent.foodScore)+" point.",t/2,e/2+60),this.setTextSizeStrokeWeight(12,0,4),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text('"C" to Start Game',t/2,e/2+80),this.setTextSizeStrokeWeight(30,0,6),this.alpha_1+=this.parent.deltaTime/50%50,this.parent.precanvas.stroke(0,0,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.fill(255,0,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.text("Game Over",t/2,e/2-20));this.parent.precanvas.pop()}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),v=function(){"use strict";function t(e){s(this,t),this.parent=e,this.parent.TILE_TOTAL=0,this.tileCount=this.parent.p5.floor(this.parent.canvas_w/this.parent.floor_w)+2,this.PositionFloorTile=[];for(var i=0;i<this.tileCount;i++)this.PositionFloorTile[i]=this.parent.floor_w/2+this.parent.floor_w*(i+1),this.parent.TILE_LOOP_NO[i]=this.parent.TILE_TOTAL,this.parent.TILE_TOTAL++}return n(t,[{key:"draw",value:function(){this.parent.canvas_w;for(var t=this.parent.canvas_h,e=0;e<this.tileCount;e++){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER);var i=0;if(this.parent.pitCount>0)for(var s=0;s<this.parent.pitCount;s++)this.parent.pits[s].isStartPit(this.parent.TILE_LOOP_NO[e])?i=1:this.parent.pits[s].isEndPit(this.parent.TILE_LOOP_NO[e])?i=2:this.parent.pits[s].isPitNone(this.parent.TILE_LOOP_NO[e])&&(i=3);if(0==i?this.parent.precanvas.image(this.parent.img_tile_floor,this.PositionFloorTile[e],t-this.parent.floor_h/2,this.parent.floor_w,this.parent.floor_h):1==i?this.parent.precanvas.image(this.parent.img_floor_start,this.PositionFloorTile[e],t-this.parent.floor_h/2,this.parent.floor_w,this.parent.floor_h):2==i&&this.parent.precanvas.image(this.parent.img_floor_end,this.PositionFloorTile[e],t-this.parent.floor_h/2,this.parent.floor_w,this.parent.floor_h),this.PositionFloorTile[e]-=8*this.parent.MAIN_SPEED,this.PositionFloorTile[e]<-this.parent.floor_w/2){if(this.parent.character.totalMeter+=.5,this.PositionFloorTile[e]+=this.parent.floor_w*this.tileCount,this.parent.pitCount>0&&this.parent.pits[0].nextPit(this.parent.TILE_LOOP_NO[e])){for(s=0;s<this.parent.pitCount-1;s++)this.parent.pits[s]=this.parent.pits[s+1];this.parent.pitCount--}this.parent.TILE_LOOP_NO[e]=this.parent.TILE_TOTAL,this.parent.TILE_TOTAL++}}this.parent.precanvas.pop()}},{key:"collide",value:function(t,e){if(null==this.parent.pits)return!0;for(var i=0;i<this.tileCount;i++){for(var s=!1,n=0;n<this.parent.pitCount;n++)this.parent.pits[n].isPitNone(this.parent.TILE_LOOP_NO[i])&&(s=!0);if(!s){var a=this.parent.p5.createVector(this.PositionFloorTile[i]-this.parent.floor_w/2,this.parent.canvas_h-this.parent.floor_h/2),r=this.parent.p5.createVector(this.parent.floor_w,this.parent.floor_h);if(a.x<t.x+e.x&&a.x+r.x>t.x&&a.y<t.y+e.y&&a.y+r.y>t.y)return!0}}return!1}}]),t}(),f=function(){"use strict";function t(e,i){s(this,t),this.parent=i,this.nextRandom=e,this.currentTileCount=this.parent.TILE_TOTAL}return n(t,[{key:"checkForObstacleGeneration",value:function(){if(this.currentTileCount!=this.parent.TILE_TOTAL&&(this.currentTileCount=this.parent.TILE_TOTAL,this.parent.TILE_TOTAL>=this.nextRandom)){var t=this.parent.p5.random([0,1,2,3,4]);if(2==t){var e=this.parent.TILE_TOTAL+1;this.parent.pits[this.parent.pitCount]=new E(e,this.parent),this.parent.pitCount++,this.nextRandom=e+19+this.parent.p5.random(0,8)}else if(3==t||4==t){e=this.parent.TILE_TOTAL+1;this.parent.food[this.parent.foodCount]=new x(e,this.parent),this.parent.foodCount++,this.nextRandom=e+9+this.parent.p5.random(0,5)}else{e=this.parent.TILE_TOTAL+1;this.parent.spikes[this.parent.spikeCount]=new y(e,this.parent),this.parent.spikeCount++,this.nextRandom=e+15+this.parent.p5.random(0,8)}}}}]),t}(),x=function(){"use strict";function t(e,i){s(this,t),this.parent=i,this.appearOnTile=e,this.PositionX=this.parent.floor_w*this.parent.floorTile.tileCount-this.parent.floor_w/2,this.markForRemove=!1,this.food_wh=30,this.PositionY=100,this.alpha_1=0}return n(t,[{key:"draw",value:function(){this.appearOnTile<=this.parent.TILE_TOTAL&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.alpha_1+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.tint(255,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.image(this.parent.img_food,this.PositionX,this.PositionY,this.food_wh,this.food_wh),this.parent.precanvas.pop(),this.PositionX-=8*this.parent.MAIN_SPEED,this.PositionX<-this.food_wh/2&&(this.markForRemove=!0))}},{key:"collide",value:function(t,e){var i=this.parent.p5.createVector(this.PositionX-this.food_wh/2,this.PositionY),s=this.parent.p5.createVector(this.food_wh,this.food_wh);return i.x<t.x+e.x&&i.x+s.x>t.x&&i.y<t.y+e.y&&i.y+s.y>t.y}}]),t}(),y=function(){"use strict";function t(e,i){s(this,t),this.parent=i,this.appearOnTile=e,this.PositionX=this.parent.floor_w*this.parent.floorTile.tileCount-this.parent.floor_w/2,this.markForRemove=!1}return n(t,[{key:"draw",value:function(){this.appearOnTile<=this.parent.TILE_TOTAL&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_spike,this.PositionX,this.parent.spike_h/2,this.parent.spike_w,this.parent.spike_h),this.parent.precanvas.pop(),this.PositionX-=8*this.parent.MAIN_SPEED,this.PositionX<-this.parent.spike_w/2&&(this.markForRemove=!0))}},{key:"collide",value:function(t,e){var i=this.parent.p5.createVector(this.PositionX-this.parent.spike_w/2+16,0),s=this.parent.p5.createVector(this.parent.spike_w-32,this.parent.spike_h-10);return i.x<t.x+e.x&&i.x+s.x>t.x&&i.y<t.y+e.y&&i.y+s.y>t.y}}]),t}(),E=function(){"use strict";function t(e,i){s(this,t),this.parent=i,this.pitWidth=6,this.pitStart=e,this.pitEnd=this.pitStart+this.pitWidth}return n(t,[{key:"isStartPit",value:function(t){return this.parent.p5.int(t)==this.parent.p5.int(this.pitStart)}},{key:"isEndPit",value:function(t){return this.parent.p5.int(t)==this.parent.p5.int(this.pitEnd)}},{key:"isPitNone",value:function(t){return t>this.pitStart&&t<this.pitEnd}},{key:"nextPit",value:function(t){return this.pitEnd<t}}]),t}(),_=function(){"use strict";function t(e,i,n){s(this,t),this.parent=n,this.speed=i,this.img=e,this.count=2,this.bgTile=[];for(var a=0;a<this.count;a++)this.bgTile[a]=this.parent.canvas_w*a}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER);for(var t=0;t<this.count;t++)this.parent.precanvas.image(this.img,this.bgTile[t],0,this.parent.canvas_w,this.parent.canvas_h),this.bgTile[t]-=this.speed*this.parent.MAIN_SPEED,this.bgTile[t]<-this.parent.canvas_w&&(this.bgTile[t]+=this.parent.canvas_w*this.count);this.parent.precanvas.pop()}}]),t}();t.exports={mlxJungleJumper:m}},34488:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,i(29719).mlxFeatureExtractor),d=i(79025),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),n=e.call(this,t),console.log("KNN"),n.category="DeepLeaning",n.type="KNNClassifier",n.title="KNN Classifier",n.inType="tensor",n.outType="results",n.w=200,n.h=100,n.method=1,n.mode="classify",n.needMouse=!0,n.classNames=["A","B","C","D","E","F","G","H","I","J"],n.currentClass="A",n.currentClassIndex=0,n.classifier=null,n.trained=!1,n.losses=[],n.highestLoss=0,n.rawData={},n.classCounts=0,n.createElementMenu(),n.icon=n.mlx.createImage(a(n),"/assets/iconKNNClassifier.jpg",1,n.mlx.mlxCaptionHeight+1,198,44),n.label=n.mlx.createLabel(a(n),"Loading...",8,n.mlx.mlxCaptionHeight+48,n.w-20,24),n.categoryMenu=n.mlx.createMenu(a(n),10,n.mlx.mlxCaptionHeight+44+10),n.select=n.categoryMenu.addSelectMenu(["A","B","C","D","E"],-1,(function(t,e){n.inElement&&n.inElement.output&&(e>=0&&(n.currentClass=n.classNames[e]),n.select2.setValue(-1))})),n.categoryMenu.w=85,n.trainLogX=105,n.trainLogY=n.mlx.mlxCaptionHeight+44+10,n.trainLogW=n.w-n.trainLogX-1,n.trainLogH=n.categoryMenu.h,console.log(n.categoryMenu.h),n.categoryMenu2=n.mlx.createMenu(a(n),105,n.mlx.mlxCaptionHeight+44+10),n.select2=n.categoryMenu2.addSelectMenu(["F","G","H","I","J"],-1,(function(t,e){n.inElement&&n.inElement.output&&((e=parseInt(e))>=0&&(n.currentClass=n.classNames[e+5]),n.select.setValue(-1))})),n.categoryMenu2.w=85,n.labelTrain=n.mlx.createLabel(a(n),"No data",n.trainLogX,n.trainLogY+n.trainLogH+4,n.trainLogW,24),n.getButton=n.mlx.createButton(a(n),"add",(function(){if(n.inElement&&n.inElement.output){console.log("add",n.inElement.output);try{n.addData(n.inElement.output,n.currentClass),n.classifier.addExample(n.inElement.output,n.currentClass),n.updateDisplayData(),n.trained=!0}catch(t){console.log("ERROR",t)}}}),14,205,75,24),n.getButton.border=!0,n.h+=160,n.label.yy+=160,n.classifier=ml5.KNNClassifier(),n.ready=!0,n}return n(i,[{key:"getDataShape",value:function(t){for(var e=[],i=t;i.length;)e.push(i.length),i=i[0];return e}},{key:"getEuclideanDistance",value:function(t){var e=Object.keys(this.rawData),i=[];for(var s in e){var n=e[s],a=this.rawData[n];for(var r in a){var o=a[r],h=this.p5.dist(t[0],t[1],o[0],o[1]),l={label:n,dist:h,rdata:[o[0],o[1]]};if(i.length){var u=0;for(u in i){if(h<i[u].dist){i.splice(u,0,l);break}}u==i.length&&i.length<3&&i.push(l),i.length>3&&i.splice(3,i.length-3)}else i.push(l)}}return{label:i[0].label,classIndex:s,distances:i}}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addSelectMenu(["Euclidean distance","Cosine similarity"],this.method,(function(e,i){console.log("method",i),t.method=i,t.hideMenu(),t.inElement&&t.inElement.refresh()})),e.addSeparator(),e.addCommand("Clear Model",(function(e){t.hideMenu(),t.classNames=["A","B","C","D","E","F","G","H","I","J"],t.currentClass="A",t.trained=!1,t.losses=[],t.highestLoss=0,t.totalCounts=0,t.rawData={},t.classCounts=0,t.classifier=ml5.KNNClassifier(),["A","B","C","D","E"].forEach((function(e,i){return t.select.setTitle(i,e)})),["F","G","H","I","J"].forEach((function(e,i){return t.select2.setTitle(i,e)}))})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"classify",value:function(t){var e=this;return new Promise((function(i,s){if(0==e.method){var n=e.getEuclideanDistance(t);i({label:n.label,data:t})}else e.classifier.classify(t,(function(e,n){if(e)return s(e);i({label:n.label,data:t})}))}))}},{key:"updateDisplayData",value:function(){var t=this;Object.keys(this.rawData).forEach((function(e,i){var s=t.classNames.indexOf(e);s<0&&(t.classNames[i]=e,s=i),s>4?t.select2.setTitle(s-5,"".concat(e," (").concat(t.rawData[e].length,")")):t.select.setTitle(s,"".concat(e," (").concat(t.rawData[e].length,")"))}))}},{key:"addData",value:function(t,e){this.labelTrain.setText("shp:[".concat(this.getDataShape(t).toString(),"]")),e in this.rawData||(this.rawData[e]=[],this.classCounts+=1,console.log("claseCounts",this.classCounts)),this.rawData[e].push(t)}},{key:"addBatchData",value:function(t){var e=this;t.forEach((function(t){var i=t.data,s=t.label;e.addData(i,s)}))}},{key:"processTrainData",value:function(t,e){var i=this;e?(this.addBatchData(t),t.forEach((function(t){var e=t.data,s=t.label;i.classifier.addExample(e,s)}))):(this.addData(t.data,t.label),this.classifier.addExample(t.data,t.label)),this.updateDisplayData()}},{key:"processClassify",value:function(t,e){var i=this;e||(t=[t]),this.label.setText("Processing Input : "+t.length);var s=t.map((function(t){return i.classify(t)}));Promise.all(s).then((function(t){i.numResults=t.length,i.output=e?t:t[0],i.busy=!1,i.outputIsReady=!0,i.alreadyRunInLoop=!0,i.inElement&&(i.inElement.outputIsReady=!1,i.inElement.needResults&&!e&&i.inElement.needResults({data:t[0].data,label:t[0].label,classIndex:t[0].classIndex})),i.label.setText("".concat(i.numResults," results found"))})).catch((function(t){console.error(t)}))}},{key:"doProcess",value:function(){if(this.inElement.output){var t=this.inElement.output,e=Array.isArray(t)&&(t[0].data||Array.isArray(t[0]));if(e?t[0].label&&t[0].data:t.label&&t.data){this.busy=!0,this.outputIsReady=!1;try{this.processTrainData(t,e),this.trained=!0}catch(s){console.log("ERROR",s)}this.output=t,this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0,this.inElement&&(this.inElement.outputIsReady=!1)}else{if(!this.trained)return console.log("not trained"),this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),!1;if(!this.outElement||!this.outputIsReady){this.inElement&&(this.inElement.outputIsReady=!1),this.busy=!0,this.outputIsReady=!1,this.alreadyRunInLoop=!1;var i=this.inElement.output;return this.processClassify(i,e),!0}}}return!!this.trained}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready"):this.label.setText("Ready (No data)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0)}}]),i}(m),v=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="ConfusionMatrix",n.title="Confusion Matrix",n.inType="results,tensor",n.outType="results",n.createElementMenu(),n.needMouse=!0,n.resizable=!1,n.w=200,n.h=100,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.contentAspectRatio=1,n.allowExtraInElement=!0,n.targeted=[],n.predicted=[],n.cm=null,n.cellWidth=30,n.labelPredict=n.mlx.createLabel(a(n),"Predicted : None",n.mlx.mlxPadding,n.mlx.mlxCaptionHeight+5,n.w-2*n.mlx.mlxPadding-5,24),n.labelActual=n.mlx.createLabel(a(n),"Actual : None",n.mlx.mlxPadding,n.mlx.mlxCaptionHeight+26,n.w-2*n.mlx.mlxPadding-5,24),n.computeBtn=n.mlx.createButton(a(n),"Compute",(function(){n.onCompute()}),n.mlx.mlxPadding,n.h-28,100,24),n.computeBtn.border=!0,n.outputIsReady=!1,n.ready=!0,n.busy=!1,n}return n(i,[{key:"save",value:function(){var t=r(l(i.prototype),"save",this).call(this);return t.baudrateSelector=this.baudrateSelector.getValue(),t}},{key:"load",value:function(t){r(l(i.prototype),"load",this).call(this,t),this.baudrateSelector.setValue(t.baudrateSelector)}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Clear",(function(e){t.hideMenu(),t.predicted=[],t.targeted=[],t.labelPredict.setText("Predicted : ".concat(t.predicted.length)),t.labelActual.setText("Actual : ".concat(t.targeted.length)),t.cm=null,t.w=200,t.h=100,t.activateUI()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"onCompute",value:function(){if(this.predicted.length>0&&this.targeted.length>0&&this.predicted.length==this.targeted.length){var t=this.predicted.map((function(t){return t.label})).filter((function(t){return void 0!=t})),e=this.targeted.map((function(t){return t.label})).filter((function(t){return void 0!=t}));if(t.length==e.length&&t.length>0){var i=d.default.fromLabels(e,t);this.cellWidth=6*i.labels.sort((function(t,e){return e.length-t.length}))[0].length,this.cm=i}else console.log("length not match")}else console.log("length not match")}},{key:"map",value:function(t,e,i,s,n){return(t-e)*(n-s)/(i-e)+s}},{key:"doProcess",value:function(){if(this.busy=!0,this.alreadyRunInLoop=!1,this.inElement.output&&(console.log("CONF GOT : ",this.inElement.output),this.outElement&&this.outputIsReady||(Array.isArray(this.inElement.output)?this.predicted=this.predicted.concat(this.inElement.output):this.predicted.push(this.inElement.output),this.labelPredict.setText("Predicted : ".concat(this.predicted.length)),this.busy=!1,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0)),1==this.extraInElement.length){var t=this.extraInElement[0];t.output&&t.outputIsReady&&(Array.isArray(this.inElement.output)?this.targeted=this.targeted.concat(this.inElement.output):this.targeted.push(this.inElement.output),this.labelActual.setText("Actual : ".concat(this.targeted.length)),this.busy=!1,t.outputIsReady=!1,this.alreadyRunInLoop=!0)}return!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this)}},{key:"drawTextBox",value:function(t,e,i,s,n,a,r){r.fill(a),r.strokeWeight(1),r.rect(e,i,s,n),r.fill(0),r.strokeWeight(0),r.text(t,e,i,s,n)}},{key:"draw",value:function(t){var e=this;if(r(l(i.prototype),"draw",this).call(this,t),this.cm){var s=this.cellWidth+10,n=30,a=this.cm.labels.length,o=a,h=this.x+this.contentX,u=this.y+this.contentY+80,p=50,c=60,m=n+s*(a+1)+10+p+120+2*this.mlx.mlxPadding;this.h=n*(a+5)+10+this.mlx.mlxPadding+120,t.line(this.x,this.y+100,this.x+this.w,this.y+105),m>200&&(this.w=m),t.push(),t.textSize(14),t.textStyle(t.NORMAL),t.textAlign(t.CENTER,t.CENTER),this.d,t.fill(140),t.rect(h+n+s,u,s*a,n),t.rect(h,u+n+n,n,n*o),t.fill(0),t.strokeWeight(0),t.text("Predicted",h+n+s,u,s*a,n),t.text("Actual",h,u+n+n,n,n*o),t.push(),this.cm.labels.forEach((function(i,a){e.drawTextBox(i,h+n+s+s*a,u+n,s,n,180,t),e.drawTextBox(i,h+n,u+n+n+n*a,s,n,180,t)})),t.pop(),t.push(),this.cm.getMatrix().forEach((function(i,a){i.forEach((function(i,r){var o=180;if(r==a){var l=i/e.cm.getPositiveCount(e.cm.labels[r])*204;o="rgb(".concat(204-l,",",204,",").concat(204-l,")")}else{var p=i/e.cm.getTotalCount()*204;o="rgb(".concat(204,",",204-p,",").concat(204-p,")")}e.drawTextBox(i,h+n+s+s*r,u+n+n+n*a,s,n,o,t)}))})),t.pop();var d=h+n+s*(a+1)+10,g=u+n*(2+o)+10;this.drawTextBox("SUM",d,u+n,p,n,140,t),["Recall","F1-Score"].forEach((function(i,s){e.drawTextBox(i,d+p+s*c,u+n,c,n,140,t)})),this.drawTextBox("SUM",h+n,g,s,n,140,t),this.drawTextBox("Precision",h+n,g+n,s,n,140,t),this.cm.labels.forEach((function(i,a){var r=u+n+n+n*a,o=h+n+s+s*a;e.drawTextBox(e.cm.getPositiveCount(i),d,r,p,n,180,t),e.drawTextBox(e.cm.getTruePositiveRate(i),d+p,r,c,n,180,t),e.drawTextBox(e.cm.getF1Score(i),d+p+c,r,c,n,180,t),e.drawTextBox(e.cm.getTruePositiveCount(i)+e.cm.getFalsePositiveCount(i),o,g,s,n,180,t),e.drawTextBox(e.cm.getPositivePredictiveValue(i),o,g+n,s,n,180,t)})),this.drawTextBox("Accuracy",h+n,g+n+n,s,n,140,t),this.drawTextBox((100*this.cm.getAccuracy()).toFixed(3)+" %",h+n+s,g+n+n,s*a,n,180,t),t.pop()}}}]),i}(c);t.exports={mlxKNNClassifier:g,mlxConfusionMatrix:v}},68768:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput);p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput;var m=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Mask",n.category="Output",n.type="MaskGame",n.inType="posenet",n.outType="results",n.needMouse=!0,n.score=0,n.canvasSize=650,n.poses=[],n.noseX=0,n.noseY=0,n.eyeLX=0,n.eyeLY=0,n.eyeRX=0,n.eyeRY=0,n.CV_SIZE_W=450,n.CV_SIZE_H=650,n.cNose,n.cEL,n.cER,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.CV_SIZE_W/2+2*n.mlx.mlxPadding,n.h=n.CV_SIZE_H/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.CV_SIZE_W/2,n.CV_SIZE_H/2),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.CV_SIZE_W,n.CV_SIZE_H),n.buttonNose=n.mlx.createButton(a(n),"Nose",(function(){n.buttonNose.lock<500||(n.buttonNose.lock=0,n.cNose+=1,n.cNose>=5&&(n.cNose=0))}),80,n.h-32,65,24),n.buttonEL=n.mlx.createButton(a(n),"LeftEye",(function(){n.buttonEL.lock<500||(n.buttonEL.lock=0,n.cEL+=1,n.cEL>=5&&(n.cEL=0))}),10,n.h-32,65,24),n.buttonER=n.mlx.createButton(a(n),"RightEye",(function(){n.buttonER.lock<500||(n.buttonER.lock=0,n.cER+=1,n.cER>=5&&(n.cER=0))}),150,n.h-32,65,24),n.captureCountdown=2999,n.captureBeepCountdown=0,n.doCaptureScreen=!1,n.takePhoto=n.mlx.createButton(a(n),"Save",(function(){n.captureCountdown=2999,n.captureBeepCountdown=0,n.doCaptureScreen=!0}),80,n.h-32-24-3,65,24),n.buttonNose.border=!0,n.buttonEL.border=!0,n.buttonER.border=!0,n.takePhoto.border=!0,n.img_n1,n.img_n2,n.img_n3,n.img_n4,n.img_n5,n.img_el1,n.img_el2,n.img_el3,n.img_el4,n.img_el5,n.img_er1,n.img_er2,n.img_er3,n.img_er4,n.img_er5,n.img_n,n.img_el,n.img_er,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_n1=this.p5.loadImage("assets_game/mlxMask/nose1.png"),this.img_n2=this.p5.loadImage("assets_game/mlxMask/nose2.png"),this.img_n3=this.p5.loadImage("assets_game/mlxMask/nose3.png"),this.img_n4=this.p5.loadImage("assets_game/mlxMask/nose4.png"),this.img_n5=this.p5.loadImage("assets_game/mlxMask/nose5.png"),this.img_el1=this.p5.loadImage("assets_game/mlxMask/leftEye1.png"),this.img_el2=this.p5.loadImage("assets_game/mlxMask/leftEye2.png"),this.img_el3=this.p5.loadImage("assets_game/mlxMask/leftEye3.png"),this.img_el4=this.p5.loadImage("assets_game/mlxMask/leftEye4.png"),this.img_el5=this.p5.loadImage("assets_game/mlxMask/leftEye5.png"),this.img_er1=this.p5.loadImage("assets_game/mlxMask/rightEye1.png"),this.img_er2=this.p5.loadImage("assets_game/mlxMask/rightEye2.png"),this.img_er3=this.p5.loadImage("assets_game/mlxMask/rightEye3.png"),this.img_er4=this.p5.loadImage("assets_game/mlxMask/rightEye4.png"),this.img_er5=this.p5.loadImage("assets_game/mlxMask/rightEye5.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxMask/waiting_mobile.png"),this.beepSound=this.p5.loadSound("/assets/shutterbeep.mp3"),this.shutterSound=this.p5.loadSound("/assets/shuttersound.mp3")}},{key:"setup",value:function(){this.img_n=[this.img_n1,this.img_n2,this.img_n3,this.img_n4,this.img_n5],this.img_el=[this.img_el1,this.img_el2,this.img_el3,this.img_el4,this.img_el5],this.img_er=[this.img_er1,this.img_er2,this.img_er3,this.img_er4,this.img_er5],this.cNose=0,this.cEL=0,this.cER=0}},{key:"doProcess",value:function(){return this.poses=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){if(this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),this.buttonNose.lock<500&&(this.buttonNose.lock+=t.deltaTime),this.buttonEL.lock<500&&(this.buttonEL.lock+=t.deltaTime),this.buttonER.lock<500&&(this.buttonER.lock+=t.deltaTime),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture){this.gameConnected||(this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.CV_SIZE_W,0)),this.precanvas.imageMode(t.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop();var e=t.dist(this.eyeLX,this.eyeLY,this.eyeRX,this.eyeRY);this.precanvas.push(),this.precanvas.imageMode(t.CENTER),this.precanvas.image(this.img_n[this.cNose],this.noseX,this.noseY-e/72,e/72*(this.img_n[0].width/8.5),e/72*(this.img_n[0].height/8.5)),this.precanvas.image(this.img_el[this.cEL],this.eyeLX,this.eyeLY,e/72*(this.img_el[0].width/7),e/72*(this.img_el[0].height/7)),this.precanvas.image(this.img_er[this.cER],this.eyeRX,this.eyeRY,e/72*(this.img_er[0].width/7),e/72*(this.img_er[0].height/7)),this.precanvas.pop()}else this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop(),this.gameConnected=!1;this.doCaptureScreen&&(this.captureCountdown-=t.deltaTime,this.captureCountdown>0?(this.captureBeepCountdown-=t.deltaTime,this.captureBeepCountdown<0&&(null!=this.beepSound&&this.beepSound.isLoaded()&&this.beepSound.play(),this.captureBeepCountdown=1e3),this.precanvas.push(),this.precanvas.fill(255),this.precanvas.textSize(40),this.precanvas.text(t.floor(this.captureCountdown/1e3)+1,this.CV_SIZE_W-55,5,50,50),this.precanvas.pop()):(null!=this.shutterSound&&this.shutterSound.isLoaded()&&this.shutterSound.play(),this.precanvas.save("myVideoCanvas.jpg"),this.doCaptureScreen=!1)),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.CV_SIZE_W,this.CV_SIZE_W),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.CV_SIZE_W;var t=(this.h-110)/this.CV_SIZE_H;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.CV_SIZE_W*this.fullscreen_scale,this.CV_SIZE_H*this.fullscreen_scale)}},{key:"getKeypoints",value:function(){if(null!=this.poses)for(var t=0,e=0,i=0,s=0;s<this.poses.length;s++){if(null==this.poses[s].pose)return;var n=this.poses[s].pose.keypoints[0];if(n.score>.2&&t<n.score){t=n.score;var a=n.position.x;this.inElement.inElement.flip&&(a=this.inElement.inElement.videoWidth-n.position.x);var r=this.CV_SIZE_W/this.inElement.inElement.videoWidth,o=this.CV_SIZE_H/this.inElement.inElement.videoHeight;this.noseX=a*r,this.noseY=n.position.y*o}if((n=this.poses[s].pose.keypoints[1]).score>.2&&e<n.score){e=n.score;a=n.position.x;this.inElement.inElement.flip&&(a=this.inElement.inElement.videoWidth-n.position.x);r=this.CV_SIZE_W/this.inElement.inElement.videoWidth,o=this.CV_SIZE_H/this.inElement.inElement.videoHeight;this.eyeLX=a*r,this.eyeLY=n.position.y*o}if((n=this.poses[s].pose.keypoints[2]).score>.2&&i<n.score){i=n.score;a=n.position.x;this.inElement.inElement.flip&&(a=this.inElement.inElement.videoWidth-n.position.x);r=this.CV_SIZE_W/this.inElement.inElement.videoWidth,o=this.CV_SIZE_H/this.inElement.inElement.videoHeight;this.eyeRX=a*r,this.eyeRY=n.position.y*o}}}}]),i}(c);t.exports={mlxMaskGame:m}},88062:function(t,e,i){var s=i(62012),n=i(50450),a=i(18770),r=i(2553),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel),m=(p.mlxElementOutput,p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).numResults=0,s}return i}(c)),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),s=e.call(this,t),console.log("NNC"),s.category="DeepLeaning",s.type="NeuralNetworkClassifier",s.title="Neural Network (Classifier)",s.inType="tensor",s.outType="results",s.w=400,s.h=100,s.mode=0,s.needMouse=!0,s.classNames=["A","B","C","D","E"],s.currentClass="A",s.classifier=null,s.trained=!1,s.losses=[],s.highestLoss=0,s.currentClassIndex=0,s.counts=[0,0,0,0,0],s.rawData={},s.classCounts=0,s.totalCounts=0,s.dataShape=[],s.customLayersInfo=null,s.autoLayersInfo=null,s.layerH=36,s.isAutoNeuron=!0,s.activationList=["linear","sigmoid","relu","softmax"],s.layerTypeList=["dense","flatten","conv2d","maxPooling2d"],s.neuronColor={input:s.p5.color(255,192,0),hidden:s.p5.color(0,255,0),output:s.p5.color(255,0,0)},s.createElementMenu(),s.currentValue=0,s.defaultLayers=[{name:"dense",units:16,input:{shape:[null,2]},activation:{constructor:{className:"relu"}}},{name:"dense",units:2,input:{shape:[null,16]},activation:{constructor:{className:"sigmoid"}}}],s.icon=s.mlx.createImage(n(s),"/assets/iconNeuralNetworkClassifier.jpg",1,s.mlx.mlxCaptionHeight+1,398,44),s.label=s.mlx.createLabel(n(s),"Loading...",8,s.mlx.mlxCaptionHeight+48,s.w-20,24),s.createAddUI(),s.trainLogX=95,s.trainLogY=s.mlx.mlxCaptionHeight+44+10,s.trainLogW=s.w-105,s.trainLogH=122,s.labelTrain=s.mlx.createLabel(n(s),"No training data",s.trainLogX,s.trainLogY+s.trainLogH+4,s.trainLogW,24),s.addLayerButtron=s.mlx.createButton(n(s),"add hidden layer",(function(){var t=null;if(s.customLayersInfo.length>=2?t=s.customLayersInfo[s.customLayersInfo.length-2]:1==s.customLayersInfo.length&&(t=s.customLayersInfo[s.customLayersInfo.length-1]),t){var e={type:t.type,units:t.units,input:t.units,activation:t.activation};s.customLayersInfo.length>=2?s.customLayersInfo.splice(s.customLayersInfo.length-1,0,e):s.customLayersInfo.push(e),s.updateLayersView()}}),10,s.h-32,150,24),s.addLayerButtron.border=!0,s.addLayerButtron.hidden=!0,s.autoNeuronCheckBox=s.mlx.createCheckBox(n(s),"Auto Gen",(function(t,e){var i;(s.isAutoNeuron=e,s.isAutoNeuron)?(s.addLayerButtron.hidden=!0,s.updateLayersView()):(s.addLayerButtron.hidden=!1,s.customLayersInfo||(i=s.autoLayersInfo.length?s.autoLayersInfo:s.defaultLayers,s.customLayersInfo=i.slice()),s.updateLayersView())}),s.isAutoNeuron,s.w-172,s.h-28,100,20),s.autoNeuronCheckBox.showBox=!0,s.trainButton=s.mlx.createButton(n(s),"train",(function(){if(console.log("train"),s.inElement&&s.inElement.output){var t;if(s.losses=[],s.highestLoss=0,s.updateLayersView(),1==s.mode)t={inputs:[s.dataShape[1],s.dataShape[0],s.dataShape[2]],outputs:["label"],task:"imageClassification"};else 0==s.mode?t={outputs:["label"],task:"classification"}:2==s.mode&&(t={outputs:1,task:"regression",learningRate:.02});if(console.log(t),s.classifier=ml5.neuralNetwork(t),!s.isAutoNeuron){console.log(s.customLayersInfo);for(var e=0;e<s.customLayersInfo.length;e++){var i=s.customLayersInfo[e],n={type:i.type,units:i.units,activation:i.activation},a=void 0;"dense"==i.type?(0==e?n.inputShape=s.dataShape:e==s.customLayersInfo.length-1&&(console.log(n),console.log(s.classCounts),n.units=s.classCounts,i.units=s.classCounts),a=ml5.tf.layers.dense(n)):"conv2d"==i.type&&(n.filters=2,n.kernelSize=2,n.strides=2,n.kernelInitializer="varianceScaling",0==e&&(n.inputShape=s.dataShape),a=ml5.tf.layers.conv2d(n)),console.log(n),console.log(a),s.classifier.addLayer(a)}}s.addDataToNN(),s.classifier.normalizeData(),s.loss=null;s.mode,s.classifier.train({epochs:400,learningRate:.2},(function(t,e){var i=e.loss;i?(s.loss=i,s.labelTrain.setText("".concat(t," Loss: ")+s.loss.toFixed(2)),s.losses.push(i),i>s.highestLoss&&(s.highestLoss=i),s.drawed=!1):console.log("no lossValue")}),(function(){console.log("Done Training! Final Loss: "+s.loss.toFixed(2)),s.labelTrain.setText("Done Training! Final Loss: "+s.loss.toFixed(2)),s.trained=!0,s.drawed=!1,console.log(s.classifier),s.autoLayersInfo=s.layerToLayerInfo(s.classifier.neuralNetwork.model.layers),console.log(s.autoLayersInfo),s.updateLayersView()}))}}),s.w-72,s.h-28,68,24),s.trainButton.border=!0,s.h+=160,s.label.yy+=160,s.trainButton.yy+=160,s.autoNeuronCheckBox.yy+=160,s.saveH=s.h,s.saveLabelY=s.label.yy,s.saveTrainButtonY=s.trainButton.yy,s.createLayerTypeMenu(),s.createActivationMenu(),s.getButton.hidden=!1,s.ready=!0,s}return s(i,[{key:"save",value:function(){var t=a(l(i.prototype),"save",this).call(this);return t.counts=this.counts,t.rawData=this.rawData,t.classCounts=this.classCounts,t.totalCounts=this.totalCounts,t.dataShape=this.dataShape,t.isAutoNeuron=this.isAutoNeuron,t.customLayersInfo=this.customLayersInfo,t.mode=this.mode,t}},{key:"load",value:function(t){if(a(l(i.prototype),"load",this).call(this,t),this.counts=t.counts,this.rawData=t.rawData,this.classCounts=t.classCounts,this.totalCounts=t.totalCounts,this.dataShape=t.dataShape,this.isAutoNeuron=t.isAutoNeuron,this.customLayersInfo=t.customLayersInfo,t.mode||(t.mode=0),this.mode=t.mode,this.autoNeuronCheckBox.value=this.isAutoNeuron,this.select)for(var e in this.classNames)this.counts[e]?this.select.setTitle(e,"".concat(this.classNames[e]," (").concat(this.counts[e],")")):this.select.setTitle(e,"".concat(this.classNames[e]));this.labelTrain.setText("Data shape: [".concat(this.dataShape.toString(),"]")),this.isAutoNeuron||(this.addLayerButtron.hidden=!1),this.updateLayersView()}},{key:"createAddUI",value:function(){var t=this;this.categoryMenu=this.mlx.createMenu(this,10,this.mlx.mlxCaptionHeight+44+10),this.select=this.categoryMenu.addSelectMenu(["A","B","C","D","E"],-1,(function(e,i){t.inElement&&t.inElement.output&&i>=0&&(t.currentClass=t.classNames[i],t.currentClassIndex=i)})),this.categoryMenu.w=75,this.getButton=this.mlx.createButton(this,"add",(function(){t.inElement&&t.inElement.output&&(console.log("add",t.currentClass,t.inElement.output),t.counts[t.currentClassIndex]+=1,t.select.setTitle(t.currentClassIndex,"".concat(t.currentClass," (").concat(t.counts[t.currentClassIndex],")")),t.addData(t.inElement.output,[t.currentClass]))}),10,205,75,24),this.getButton.border=!0,this.getButton.hidden=!0}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addSelectMenu(["Classification","Image Classification"],this.mode,(function(e,i){t.mode=parseInt(i),console.log("selected",i),t.hideMenu()})),e.addSeparator(),e.addCommand("Clear Data",(function(e){t.hideMenu(),t.clearData()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"clearData",value:function(){for(var t in this.counts=[0,0,0,0,0],this.counts)this.select.setTitle(t,"".concat(this.classNames[t]));this.currentClassIndex=0,this.rawData={},this.classCounts=0,this.totalCounts=0,this.dataShape=[]}},{key:"layerToLayerInfo",value:function(t){if(t.length){var e=[];for(var i in t){var s=t[i],n={};s.input.shape.length>2?n.input=1:n.input=s.input.shape.slice(1)[0],n.shapeInput=s.input.shape.slice(1),n.shapeOutput=s.output.shape,s.output.shape.length>2?n.output=1:n.output=s.output.shape[1],s.activation?n.activation=s.activation.constructor.className:n.activation="",s.units?n.units=s.units:n.units=1,s.name.startsWith("dense")?n.type="dense":s.name.startsWith("conv2d")?(n.type="conv2d",n.filters=s.filters,n.kernelSize=s.kernelSize,n.strides=s.strides,n.units=s.filters):s.name.startsWith("max_pooling2d")?(n.type="maxPooling2d",n.strides=s.strides,n.poolSize=s.poolSize,n.units=1,n.input=s.input.shape[3]):s.name.startsWith("flatten")?(n.type="flatten",n.units=n.output):n.type=s.name,e.push(n)}return e}return null}},{key:"createActivationMenu",value:function(){var t=this;this.menuActivation=this.mlx.createMenu(this,10,this.mlx.mlxCaptionHeight),this.menuActivation.hidden=!0,this.menuActivation.alwaysOnTop=!0,this.submenuActivation=this.menuActivation.addSelectMenu(this.activationList,2,(function(e,i){var s=parseInt(i),n=t.activationList[s];t.customLayersInfo[t.currentActiveLayer].activation=n,t.mlx.hidePopup(t.menuActivation)}))}},{key:"createLayerTypeMenu",value:function(){var t=this;this.menuLayerType=this.mlx.createMenu(this,10,this.mlx.mlxCaptionHeight),this.menuLayerType.hidden=!0,this.menuLayerType.alwaysOnTop=!0,this.submenuLayerType=this.menuLayerType.addSelectMenu(this.layerTypeList,2,(function(e,i){var s=parseInt(i),n=t.layerTypeList[s];t.customLayersInfo[t.currentActiveLayer].type=n,t.mlx.hidePopup(t.menuLayerType)}))}},{key:"changeNeuron",value:function(t,e){t>=0&&t<this.customLayersInfo.length&&this.customLayersInfo[t].units+e>0&&(this.customLayersInfo[t].units+=e,t<this.customLayersInfo.length-1&&(this.customLayersInfo[t+1].input+=e))}},{key:"removeLayer",value:function(t){console.log("remove ",t),this.customLayersInfo.splice(t,1),t<this.customLayersInfo.length&&(this.customLayersInfo[t].input=this.customLayersInfo[t-1].units),this.updateLayersView()}},{key:"mousePressed",value:function(){if(!a(l(i.prototype),"mousePressed",this).call(this))return!1;var t=this.saveH;if(t+=this.layerH,!this.isAutoNeuron){var e=this.mlx.mouseX-this.x-this.mlx.mlxPadding,s=this.mlx.mouseY-this.y;this.layers=this.customLayersInfo;for(var n=0;n<this.layers.length;n++){var r=this.layers[n],o=this.layers[n].activation,h=this.layers[n].type,u=this.mlx.myFont.textBounds(o,0,0,14),p=(this.w-this.mlx.mlxPadding-12*(r.units-1))/2-6,c=p+12*r.units;if(s>=t&&s<t+this.layerH)return e<15?this.changeNeuron(n,-1):e<30?this.changeNeuron(n,1):e>this.w-10-2*this.mlx.mlxPadding?this.removeLayer(n):e>this.w-20-2*this.mlx.mlxPadding-u.w?(console.log(this.w-20-this.mlx.mlxPadding-u.w),console.log("activation",o),this.submenuActivation.setValue(this.activationList.indexOf(o)),this.currentActiveLayer=n,this.menuActivation.hidden=!1,this.menuActivation.xx=this.w-20-this.mlx.mlxPadding-u.w,this.menuActivation.yy=t+this.layerH,this.mlx.popup.push(this.menuActivation)):e>=p&&e<=c&&(console.log("layerType",h),this.submenuLayerType.setValue(this.layerTypeList.indexOf(h)),this.currentActiveLayer=n,this.menuLayerType.hidden=!1,this.menuLayerType.xx=(this.w-this.menuLayerType.w)/2,this.menuLayerType.yy=t+this.layerH,this.mlx.popup.push(this.menuLayerType)),!1;t+=this.layerH}}return!0}},{key:"classify",value:function(t,e){this.trained&&this.classifier.classify(t,(function(i,s){i?console.error(i):e&&e({label:s[0].label,data:t})}))}},{key:"classifyMultiple",value:function(t,e){this.trained&&this.classifier.classifyMultiple(t,(function(t,i){t?console.error(t):e&&e(i)}))}},{key:"updateLayersView",value:function(){this.isAutoNeuron?this.layers=this.autoLayersInfo:this.layers=this.customLayersInfo,this.h=this.saveH,this.label.yy=this.saveLabelY,this.trainButton.yy=this.saveTrainButtonY,this.autoNeuronCheckBox.yy=this.saveTrainButtonY,this.layers&&this.layers.length>0&&(this.h+=this.layerH,this.h+=this.layerH*this.layers.length,this.h+=44),this.addLayerButtron.yy=this.h-32}},{key:"addDataToNN",value:function(){var t=Object.keys(this.rawData);for(var e in t){var i=t[e],s=this.rawData[i];for(var n in s){var a=void 0;if(s[n].flat)for(a=s[n].flat();a[0].length;)a=a.flat();else a=s[n];var r={inputLabels:Object.keys(a),outputLabels:["labels"]};this.classifier.addData(a,[i],r)}}}},{key:"addData",value:function(t,e){for(var i=[],s=t;s.length;)i.push(s.length),s=s[0];this.dataShape=i,this.labelTrain.setText("Data shape: [".concat(this.dataShape.toString(),"]"));Object.keys(this.rawData);Array.isArray(this.rawData[e])||(this.rawData[e]=[],this.classCounts+=1),this.rawData[e].push(t),this.totalCounts+=1}},{key:"doProcess",value:function(){var t=this;if(this.busy=!0,this.outputIsReady=!1,this.inElement.output){console.log("[nat] nn output",this.inElement.output);var e=this.inElement.output;if(e.label&&e.data){try{this.addData(e.data,[e.label]);var i=this.classNames.indexOf(e.label);this.counts[i]+=1,i>=0&&this.select.setTitle(i,"".concat(e.label," (").concat(this.counts[i],")"))}catch(n){console.log("ERROR",n)}this.busy=!1,this.output=this.inElement.output,this.outputIsReady=!0,this.alreadyRunInLoop=!0,this.inElement&&(this.inElement.outputIsReady=!1)}else{if(!this.trained)return this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),!1;var s;if(this.inElement.output.flat)for(s=this.inElement.output.flat();s[0].length;)s=s.flat();else s=this.inElement.output;2==this.mode?this.classifier.predict(s,(function(e,i){e?console.error(e):(console.log(i),t.busy=!1,t.output={value:i[0].value},t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.outputIsReady=!1))})):this.classifier.classify(s,(function(e,i){e?console.error(e):(t.busy=!1,t.output=i,t.outputIsReady=!0,t.alreadyRunInLoop=!0,t.inElement&&(t.inElement.outputIsReady=!1))}))}}return!0}},{key:"update",value:function(){a(l(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement?this.trained?this.numResults||this.label.setText("Ready (Trained)"):this.label.setText("(Untrained)"):this.ready&&this.label.setText("Ready (No input)")}},{key:"drawNumNeuronButton",value:function(t,e,i,s,n){if(t.fill(0,0,255),t.noStroke(),t.textAlign(this.p5.LEFT,this.p5.CENTER),s)if("dense"==n.type)t.text("-",this.x+this.mlx.mlxPadding,this.y+e-3),t.text("+",this.x+this.mlx.mlxPadding+20,this.y+e-3),t.text(n.units,this.x+this.mlx.mlxPadding+40,this.y+e-3);else if("conv2d"==n.type){var a="".concat(n.filters,"x[").concat(n.kernelSize.toString(),"] >[").concat(n.strides.toString(),"]");t.text(a,this.x+this.mlx.mlxPadding,this.y+e-3)}else if("maxPooling2d"==n.type){var r="[".concat(n.poolSize.toString(),"] >[").concat(n.strides.toString(),"]");t.text(r,this.x+this.mlx.mlxPadding,this.y+e-3)}else"flatten"==n.type&&t.text(n.units,this.x+this.mlx.mlxPadding,this.y+e-3)}},{key:"drawLayer",value:function(t,e,i,s,n,a,r,o){if(t.fill(this.neuronColor[s]),t.stroke(0),t.strokeWeight(1),"dense"==r||"input"==r||"flatten"==r){var h=i;h>16&&(h=16);for(var l=(this.w-12*(h-1))/2,u=0;u<h;u++)t.ellipse(this.x+l+12*u,this.y+e,8,8)}if("dense"!=r&&"input"!=r){var p=r+" ["+o.toString()+"]";"flatten"==r&&(p=r+" to "+i);var c=this.mlx.myFont.textBounds(p,0,0,14),m=(this.w-(c.w+16))/2;t.stroke(0),t.fill(255),t.rect(this.x+m,this.y+e-1-c.h,c.w+16,c.h+8),t.noStroke(),t.fill(0),m=this.w/2,t.textAlign(this.p5.CENTER,this.p5.CENTER),t.text(p,this.x+m,this.y+e-c.h/2)}t.noStroke(),t.textSize(14),a?t.fill(0,0,255):t.fill(64,64,64),t.textAlign(this.p5.RIGHT,this.p5.CENTER),t.text(n,this.x+this.w-this.mlx.mlxPadding-20,this.y+e-3),t.fill(0),a&&t.text("x",this.x+this.w-this.mlx.mlxPadding,this.y+e-2)}},{key:"drawLayerLink",value:function(t,e,i,s,n,a){t.fill(this.neuronColor[n]),t.stroke(128),t.strokeWeight(1);for(var r=Math.min(i,16),o=Math.min(s,16),h=(this.w-12*(r-1))/2,l=(this.w-12*(o-1))/2,u=e-this.layerH,p=0;p<r;p++){l=(this.w-12*(o-1))/2;for(var c=0;c<o;c++)t.line(this.x+h,this.y+u,this.x+l,this.y+e),l+=12;h+=12}}},{key:"draw",value:function(t){if(a(l(i.prototype),"draw",this).call(this,t),t.fill(255),t.stroke(0),t.rect(this.x+this.trainLogX,this.y+this.trainLogY,this.trainLogW,this.trainLogH),!this.drawed){var e=.9*this.trainLogH/this.highestLoss,s=this.y+this.trainLogY+this.trainLogH,n=this.x+this.trainLogX,r=this.trainLogW/this.losses.length;r>10&&(r=10),t.beginShape();for(var o=0;o<this.losses.length;o++){var h=s-e*this.losses[o];t.vertex(n+o*r,h)}t.endShape()}if(t.fill(0),t.noStroke(),this.isAutoNeuron?this.drawLayers=this.autoLayersInfo:this.drawLayers=this.customLayersInfo,this.drawLayers&&this.drawLayers.length>0){var u="input",p=this.saveH+this.layerH/2;for(var o in p+=this.layerH,this.drawLayers){var c=this.drawLayers[o],m=c.input,d=c.units;d||(d=1),this.drawLayerLink(t,p,m,d,u,c.type),p+=this.layerH}p=this.saveH+this.layerH/2;var g=this.drawLayers[0].input;for(o in this.drawLayer(t,p,g,"input","input",!1,"input",this.drawLayers[0].shapeInput),p+=this.layerH,this.drawLayers){u="hidden",o==this.drawLayers.length-1&&(u="output");var v=this.drawLayers[o],f=v.units;f||(f=1),this.drawLayer(t,p,f,u,v.activation,o<this.drawLayers.length-0,v.type,v.shapeInput),t.fill(0,0,255),this.drawNumNeuronButton(t,p,o,o<this.drawLayers.length-1,v),t.fill(0),p+=this.layerH}}}}]),i}(m),g=function(t){"use strict";o(i,t);var e=u(i);function i(t){var s;return r(this,i),(s=e.call(this,t)).mode=2,s.category="DeepLeaning",s.type="NeuralNetworkRegressor",s.title="Neural Network (Regressor)",s.inType="tensor",s.outType="results",s.regressor=null,s.currentValue=0,s.rawData=[],s.icon=s.mlx.createImage(n(s),"/assets/iconNeuralNetworkRegressor.jpg",1,s.mlx.mlxCaptionHeight+1,398,44),s}return s(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"createAddUI",value:function(){var t=this;this.slider=this.mlx.createVerticalSlider(this,(function(e){t.currentValue=e}),this.currentValue,0,1,20,this.mlx.mlxCaptionHeight+44+10,15,122),this.getButton=this.mlx.createButton(this,"add",(function(){t.inElement&&t.inElement.output&&(console.log("add",t.currentValue),t.counts[0]+=1,t.addData(t.inElement.output,t.currentValue))}),10,205,75,24),this.getButton.border=!0,this.getButton.hidden=!0}},{key:"addData",value:function(t,e){for(var i=[],s=t;s.length;)i.push(s.length),s=s[0];this.dataShape=i,this.rawData.push({value:e,data:t}),this.totalCounts+=1,this.labelTrain.setText("Shape: [".concat(this.dataShape.toString(),"] (").concat(this.totalCounts," added)"))}},{key:"addDataToNN",value:function(){for(var t in this.rawData){var e=this.rawData[t];console.log("Add ",e.value,e.data),this.classifier.addData(e.data,[e.value])}}}]),i}(d);t.exports={mlxNeuralNetwork:m,mlxNeuralNetworkClassifier:d,mlxNeuralNetworkRegressor:g}},57868:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Nose Artist",n.category="Output",n.type="NoseArtistGame",n.inType="posenet",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=854,n.poses=[],n.skeletons=[],n.pg,n.noseX=0,n.noseY=0,n.pNoseX,n.pNoseY,n.isDraw=!1,n.posNose,n.gameMode="WELCOME",n.gameLevel,n.BUTTON_ACTIVATED_TIME=1200,n.DOTPOINT_ACTIVATED_TIME=800,n.hp,n.CAPTURE_IMAGE=!0,n.displayText=["1.\u0e04\u0e27\u0e23\u0e43\u0e2a\u0e48\u0e2b\u0e19\u0e49\u0e32\u0e01\u0e32\u0e01\u0e2d\u0e19\u0e32\u0e21\u0e31\u0e22\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e1b\u0e49\u0e2d\u0e07\u0e01\u0e31\u0e19","2.\u0e2b\u0e21\u0e31\u0e48\u0e19\u0e25\u0e49\u0e32\u0e07\u0e21\u0e37\u0e2d\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e0a\u0e47\u0e14\u0e14\u0e49\u0e27\u0e22\u0e41\u0e2d\u0e25\u0e01\u0e2d\u0e2e\u0e2d\u0e25\u0e4c","3.\u0e07\u0e14\u0e40\u0e14\u0e34\u0e19\u0e17\u0e32\u0e07\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e1e\u0e37\u0e49\u0e19\u0e17\u0e35\u0e48\u0e40\u0e2a\u0e35\u0e48\u0e22\u0e07\u0e42\u0e23\u0e04\u0e23\u0e30\u0e1a\u0e32\u0e14","4.\u0e44\u0e21\u0e48\u0e43\u0e0a\u0e49\u0e2a\u0e34\u0e48\u0e07\u0e02\u0e2d\u0e07\u0e23\u0e48\u0e27\u0e21\u0e01\u0e31\u0e1a\u0e1c\u0e39\u0e49\u0e2d\u0e37\u0e48\u0e19","5.\u0e16\u0e49\u0e32\u0e21\u0e35\u0e2d\u0e32\u0e01\u0e32\u0e23\u0e23\u0e35\u0e1a\u0e44\u0e1b\u0e1e\u0e1a\u0e41\u0e1e\u0e17\u0e22\u0e4c\u0e17\u0e31\u0e19\u0e17\u0e35!"],n.cornerText="\u0e40\u0e01\u0e21\u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e1a\u0e17\u0e40\u0e23\u0e35\u0e22\u0e19 AI For Kids",n.GAMENAME="Nose Artist",n.OPEN_WEB_ON_FINISH="https://www.ml.in.th",n.FINISH_MESSAGE="\u0e22\u0e34\u0e19\u0e14\u0e35\u0e14\u0e49\u0e27\u0e22 \u0e04\u0e38\u0e13\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08\u0e41\u0e25\u0e49\u0e27!!",n.CV_SIZE_W=854,n.CV_SIZE_H=560,n.BG_SIZE_W=450,n.BG_SIZE_H=400,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.CV_SIZE_W/2+2*n.mlx.mlxPadding,n.h=n.CV_SIZE_H/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.CV_SIZE_W/2,n.CV_SIZE_H/2),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.CV_SIZE_W,n.CV_SIZE_H),n.img_bg,n.img_pointer,n.img_logo,n.img_btbbig_n,n.img_btbbig_d,n.img_round_n,n.img_round_d,n.img_point,n.img_doctor,n.img_howto1,n.img_howto2,n.img_howto3,n.img_win,n.img_lose,n.img_virus=[],n.img_virus_1,n.img_virus_2,n.img_virus_3,n.font,n.ui,n.pointer,n.sound_button_activated,n.sound_button_touch,n.sound_button_discontact,n.sound_contact_point,n.sound_levelcomplete,n.sound_virus,n.sound_sneeze,n.sound_virus_hit,n.levelPos=[],n.levelPointCount,n.levelNotDrawLint,n.levelNotDrawLintCount,n.levelFinish=!1,n.levelOver=!1,n.level1Sequence=[201,209,648,208,286,470,424,45,563,470,201,209],n.level1PointCount=6,n.level1NotDrawLint=[],n.level1NotDrawLintCount=0,n.numBalls=10,n.spring=.05,n.gravity=0,n.friction=-.9,n.virusBalls=[],n.currentPoint,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_bg=this.p5.loadImage("assets_game/mlxNoseArtist/img_bg.png"),this.img_pointer=this.p5.loadImage("assets_game/mlxNoseArtist/img_pointer.png"),this.img_logo=this.p5.loadImage("assets_game/mlxNoseArtist/logo.png"),this.img_btbbig_n=this.p5.loadImage("assets_game/mlxNoseArtist/img_btbig_n.png"),this.img_btbbig_d=this.p5.loadImage("assets_game/mlxNoseArtist/img_btbig_d.png"),this.img_round_n=this.p5.loadImage("assets_game/mlxNoseArtist/img_round_n.png"),this.img_round_d=this.p5.loadImage("assets_game/mlxNoseArtist/img_round_d.png"),this.img_howto1=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_1.png"),this.img_howto2=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_2.png"),this.img_howto3=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_3.png"),this.img_point=this.p5.loadImage("assets_game/mlxNoseArtist/img_pointer_w.png"),this.img_win=this.p5.loadImage("assets_game/mlxNoseArtist/img_win.png"),this.img_lose=this.p5.loadImage("assets_game/mlxNoseArtist/img_lose.png"),this.img_doctor=this.p5.loadImage("assets_game/mlxNoseArtist/doctor.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxNoseArtist/waiting.png"),this.font=this.p5.loadFont("assets_game/mlxNoseArtist/JSJindara-Bold.otf"),this.sound_button_activated=this.p5.loadSound("assets_game/mlxNoseArtist/button_activated.mp3"),this.sound_button_touch=this.p5.loadSound("assets_game/mlxNoseArtist/button_touch.mp3"),this.sound_button_discontact=this.p5.loadSound("assets_game/mlxNoseArtist/button_discontact.mp3"),this.sound_contact_point=this.p5.loadSound("assets_game/mlxNoseArtist/contact_point.mp3"),this.sound_levelcomplete=this.p5.loadSound("assets_game/mlxNoseArtist/levelcomplete.mp3"),this.sound_sneeze=this.p5.loadSound("assets_game/mlxNoseArtist/sneeze.mp3"),this.sound_virus_hit=this.p5.loadSound("assets_game/mlxNoseArtist/contact.mp3"),this.sound_virus=this.p5.loadSound("assets_game/mlxNoseArtist/virus.mp3"),this.img_virus_1=this.p5.loadImage("assets_game/mlxNoseArtist/virus5.png"),this.img_virus_2=this.p5.loadImage("assets_game/mlxNoseArtist/virus6.png"),this.img_virus_3=this.p5.loadImage("assets_game/mlxNoseArtist/virus7.png")}},{key:"setup",value:function(){this.pg=this.p5.createGraphics(this.CV_SIZE_W,this.CV_SIZE_H),this.ui=new d(this),this.pointer=new g(this),this.img_virus=[this.img_virus_1,this.img_virus_2,this.img_virus_3]}},{key:"doProcess",value:function(){return this.poses=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture?(this.gameConnected||(this.gameMode="WELCOME",this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.CV_SIZE_W,0)),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.image(this.pg,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop(),this.precanvas.push(),this.posNose=this.p5.createVector(this.CV_SIZE_W-this.noseX,this.noseY),this.ui.draw(),this.pointer.draw(),this.precanvas.pop()):(this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop(),this.gameConnected=!1),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.CV_SIZE_W,this.CV_SIZE_W),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.CV_SIZE_W;var t=(this.h-110)/this.CV_SIZE_H;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.CV_SIZE_W*this.fullscreen_scale,this.CV_SIZE_H*this.fullscreen_scale)}},{key:"gameButtonAction",value:function(t){switch(t){case 1:this.pointer.currentActivatedButton=null,this.gameMode="LEVEL";break;case 23:this.pointer.currentActivatedButton=null,this.gameMode="PLAY",this.gameLevel=1,this.hp=100,this.levelPos=[],this.levelPointCount=this.level1PointCount,this.levelNotDrawLint=this.level1NotDrawLint,this.levelNotDrawLintCount=this.level1NotDrawLintCount;for(var e=0;e<this.levelPointCount;e++)this.levelPos[e]=new v(this.p5.createVector(this.level1Sequence[2*e],this.level1Sequence[2*e+1]),e,this);this.currentPoint=0,this.levelFinish=!1,this.levelOver=!1,this.clearnVirusBall();break;case 3:this.pointer.currentActivatedButton=null,this.gameMode="LEVEL"}}},{key:"getKeypoints",value:function(){if(null!=this.poses)for(var t=0,e=0;e<this.poses.length;e++){if(null==this.poses[e].pose)return;var i=this.poses[e].pose.keypoints[0];if(i.score>.2&&t<i.score){t=i.score;var s=i.position.x;this.inElement.inElement.flip||(s=this.inElement.inElement.videoWidth-i.position.x);var n=this.CV_SIZE_W/this.inElement.inElement.videoWidth,a=this.CV_SIZE_H/this.inElement.inElement.videoHeight;this.noseX=s*n,this.noseY=i.position.y*a,this.isDraw&&(this.pg.push(),this.pg.stroke(230,234,0,200),this.pg.strokeWeight(7),this.pg.line(this.noseX,this.noseY,this.pNoseX,this.pNoseY),this.pg.pop()),this.pNoseX=this.noseX,this.pNoseY=this.noseY}}}},{key:"setupVirusBall",value:function(){this.virusBalls=[];for(var t=0;t<this.numBalls;t++)this.virusBalls[t]=new x(this,this.p5.random(this.CV_SIZE_W),this.p5.random(this.CV_SIZE_H),this.p5.random(30,70),t,this.virusBalls)}},{key:"clearnVirusBall",value:function(){for(var t=0;t<this.numBalls;t++)this.virusBalls[t]=null;this.virusBalls=null}}]),i}(c)),d=function(){"use strict";function t(e){s(this,t),this.parent=e,this.b_welcome=new f(this.parent,this.parent.img_btbbig_n,this.parent.img_btbbig_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2+150,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),0,1,"\u0e40\u0e23\u0e34\u0e48\u0e21"),this.b_level3=new f(this.parent,this.parent.img_round_n,this.parent.img_round_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2-0,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),40,23,"\u0e15\u0e01\u0e25\u0e07"),this.b_win=new f(this.parent,this.parent.img_btbbig_n,this.parent.img_btbbig_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2+150,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),0,3,"\u0e15\u0e01\u0e25\u0e07"),this.alpha_1=0,this.alpha_2=0,this.flashScreen=!1,this.countdown=7e3}return n(t,[{key:"draw",value:function(){var t=this.parent.CV_SIZE_W,e=this.parent.CV_SIZE_H;if(this.parent.precanvas.push(),this.parent.precanvas.textFont(this.parent.font),this.setTextSizeStrokeWeight(22,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.parent.precanvas.text(this.cornerText,5,e-15),this.parent.precanvas.pop(),this.parent.precanvas.push(),"WELCOME"==this.parent.gameMode)this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_logo,t/2,e/2-50,250,250),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(38,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text(this.parent.GAMENAME,t/2,e/2+80),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,0),this.parent.precanvas.fill(0),this.parent.precanvas.text("\u0e40\u0e01\u0e21\u0e19\u0e35\u0e49\u0e43\u0e0a\u0e49\u0e08\u0e21\u0e39\u0e01\u0e43\u0e19\u0e01\u0e32\u0e23\u0e40\u0e25\u0e48\u0e19",t/2-this.parent.BG_SIZE_W/2+10,e/2+125),this.parent.precanvas.text("\u0e02\u0e22\u0e31\u0e1a\u0e21\u0e32\u0e17\u0e35\u0e48\u0e1b\u0e38\u0e48\u0e21\u0e41\u0e25\u0e30\u0e04\u0e49\u0e32\u0e07\u0e44\u0e27\u0e49\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e23\u0e34\u0e48\u0e21\u0e40\u0e25\u0e48\u0e19",t/2-this.parent.BG_SIZE_W/2+10,e/2+150),this.b_welcome.draw();else if("LEVEL"==this.parent.gameMode)this.flashScreen=!1,this.alpha_2=0,this.countdown=7e3,this.parent.isDraw=!1,this.parent.pg.clear(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_howto1,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+60,100,100),this.parent.precanvas.image(this.parent.img_howto2,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+160,100,100),this.parent.precanvas.image(this.parent.img_howto3,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+260,100,100),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.rectMode(this.parent.p5.CORNER),this.parent.precanvas.text("1.\u0e25\u0e32\u0e01\u0e40\u0e2a\u0e49\u0e19\u0e1c\u0e48\u0e32\u0e19\u0e08\u0e38\u0e14\u0e17\u0e35\u0e48\u0e01\u0e33\u0e2b\u0e19\u0e14 \u0e15\u0e32\u0e21\u0e25\u0e33\u0e14\u0e31\u0e1a\u0e08\u0e19\u0e2b\u0e21\u0e14",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+50,this.parent.BG_SIZE_W-150,300),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.parent.precanvas.text("2.\u0e2b\u0e25\u0e1a\u0e44\u0e27\u0e23\u0e31\u0e2a\u0e17\u0e35\u0e48\u0e08\u0e30\u0e25\u0e2d\u0e22\u0e40\u0e02\u0e49\u0e32\u0e08\u0e21\u0e39\u0e01",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+150),this.parent.precanvas.text("3.\u0e16\u0e49\u0e32\u0e42\u0e14\u0e19\u0e44\u0e27\u0e23\u0e31\u0e2a\u0e08\u0e19\u0e1e\u0e25\u0e31\u0e07\u0e2b\u0e21\u0e14\u0e08\u0e30\u0e41\u0e1e\u0e49",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+250),this.setTextSizeStrokeWeight(30,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.b_level3.draw();else if("PLAY"==this.parent.gameMode){if(this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.push(),a=(a=this.parent.p5.createVector(79,96,88)).lerp(268,100,79,1-this.parent.hp/100),this.parent.precanvas.colorMode(this.parent.p5.HSB,339,100,100,100),this.parent.precanvas.fill(a.x,a.y,a.z,25),this.parent.precanvas.rect(0,0,t,e),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.parent.levelFinish)for(var i=0;i<this.parent.currentPoint-1;i++){for(var s=!0,n=0;n<this.parent.levelNotDrawLintCount;n++)if(this.parent.levelNotDrawLint[n]-1==i){s=!1;break}s&&(this.parent.precanvas.push(),this.parent.precanvas.stroke(0,255),this.parent.precanvas.strokeWeight(25),this.parent.precanvas.line(this.parent.levelPos[i].position.x,this.parent.levelPos[i].position.y,this.parent.levelPos[i+1].position.x,this.parent.levelPos[i+1].position.y),this.parent.precanvas.pop())}for(i=0;i<this.parent.currentPoint-1;i++){for(s=!0,n=0;n<this.parent.levelNotDrawLintCount;n++)if(this.parent.levelNotDrawLint[n]-1==i){s=!1;break}s&&(this.parent.precanvas.stroke(255,234,0,this.parent.levelFinish?255:220),this.parent.precanvas.strokeWeight(this.parent.levelFinish?15:10),this.parent.precanvas.line(this.parent.levelPos[i].position.x,this.parent.levelPos[i].position.y,this.parent.levelPos[i+1].position.x,this.parent.levelPos[i+1].position.y))}if(this.parent.precanvas.pop(),this.parent.levelFinish)this.countdown-=this.parent.p5.deltaTime,this.countdown<0&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_win,t/2,e/2-50,250,170),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text(this.parent.FINISH_MESSAGE,t/2-this.parent.BG_SIZE_W/2+15,e/2+125),this.b_win.draw(),this.parent.precanvas.pop());else{for(i=0;i<this.parent.levelPointCount;i++)this.parent.levelPos[i].draw();var a;null!=this.parent.virusBalls&&this.parent.virusBalls.forEach((function(t){t.collide(),t.move(),t.display()})),this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(5,5,150,40),a=(a=this.parent.p5.createVector(79,96,88)).lerp(0,96,88,1-this.parent.hp/100),this.parent.precanvas.colorMode(this.parent.p5.HSB,339,100,100),this.parent.precanvas.fill(a.x,a.y,a.z),this.parent.precanvas.rect(8,8,this.parent.hp/100*144,34),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.setTextSizeStrokeWeight(25,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.textAlign(this.parent.p5.RIGHT,this.parent.p5.CENTER);var r="\u0e40\u0e2b\u0e25\u0e37\u0e2d\u0e2d\u0e35\u0e01 "+(this.parent.levelPointCount-this.parent.currentPoint)+"\u0e08\u0e38\u0e14";0==this.parent.currentPoint&&(r="\u0e44\u0e1b\u0e17\u0e35\u0e48\u0e08\u0e38\u0e14\u0e01\u0e23\u0e30\u0e1e\u0e23\u0e34\u0e1a\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19"),this.parent.precanvas.text(r,t-40,25),this.parent.currentPoint>0&&this.parent.currentPoint<=this.parent.displayText.length&&(this.setTextSizeStrokeWeight(25,0,3),this.parent.precanvas.fill(255,230),this.parent.precanvas.rect(t-500,e-60,480,50,10),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_doctor,t-100,e-176,100,176),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(25,0,3),this.parent.precanvas.text(this.parent.displayText[this.parent.currentPoint-1],t-480,e-35,30,30)),this.parent.precanvas.pop(),this.parent.levelOver&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_lose,t/2,e/2-50,220,250),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(161,9,225),this.parent.precanvas.text("\u0e40\u0e2a\u0e35\u0e22\u0e43\u0e08\u0e14\u0e49\u0e27\u0e22 \u0e04\u0e38\u0e13\u0e1b\u0e48\u0e27\u0e22\u0e0b\u0e30\u0e41\u0e25\u0e49\u0e27!!",t/2-this.parent.BG_SIZE_W/2+15,e/2+125),this.b_win.draw(),this.parent.precanvas.pop())}}this.parent.precanvas.pop()}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),g=function(){"use strict";function t(e){s(this,t),this.parent=e,this.position,this.radius=5,this.timer=1e3,this.buttonActivated=!1,this.currentActivatedButton=null,this.timerDotPoint=1e3,this.currentDotPoint=null}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.position=this.parent.p5.createVector(this.parent.posNose.x,this.parent.posNose.y),this.parent.precanvas.image(this.parent.img_pointer,this.parent.posNose.x,this.parent.posNose.y),this.parent.precanvas.pop(),null==this.currentActivatedButton||this.buttonActivated?null!=this.currentActivatedButton&&this.buttonActivated||(this.timer=0,this.buttonActivated=!1):this.showTimer(),null!=this.currentDotPoint&&this.currentDotPoint.pointCount==this.parent.currentPoint?this.showTimerForDotPoint():this.timerDotPoint=0}},{key:"showTimerForDotPoint",value:function(){0==this.timerDotPoint&&this.parent.sound_button_touch.play(),this.timerDotPoint+=this.parent.p5.deltaTime,this.timerDotPoint>this.parent.DOTPOINT_ACTIVATED_TIME?(this.timerDotPoint=this.parent.DOTPOINT_ACTIVATED_TIME,this.currentDotPoint.doAction()):(this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,50,15),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,this.timerDotPoint/this.parent.DOTPOINT_ACTIVATED_TIME*50,15),this.parent.precanvas.pop())}},{key:"showTimer",value:function(){this.buttonActivated||(0==this.timer&&this.parent.sound_button_touch.play(),this.timer+=this.parent.p5.deltaTime,this.timer>this.parent.BUTTON_ACTIVATED_TIME?(this.timer=this.parent.BUTTON_ACTIVATED_TIME,this.currentActivatedButton.doAction(),this.buttonActivated=!0,this.parent.sound_button_activated.play()):(this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,50,15),this.parent.precanvas.fill(255,0,0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,this.timer/this.parent.BUTTON_ACTIVATED_TIME*50,15),this.parent.precanvas.pop()))}}]),t}(),v=function(){"use strict";function t(e,i,n){s(this,t),this.parent=n,this.position=e,this.pointCount=i,this.alpha_1=0,this.radius=23}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.pointCount==this.parent.currentPoint?(this.alpha_1+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.tint(255,0,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.image(this.parent.img_point,this.position.x,this.position.y,45,45),this.collideRound(this.parent.posNose)?this.parent.pointer.currentDotPoint=this:this.parent.pointer.currentDotPoint==this&&(this.parent.pointer.currentDotPoint=null)):(this.pointCount<this.parent.currentPoint?this.parent.precanvas.tint(80,100):this.pointCount>this.parent.currentPoint&&this.pointCount<this.parent.currentPoint+5?this.parent.precanvas.tint(255,234,0,(5-(this.pointCount-this.parent.currentPoint))/5*150):this.parent.precanvas.tint(80,24),this.parent.precanvas.image(this.parent.img_point,this.position.x,this.position.y,25,25)),this.parent.precanvas.pop()}},{key:"collideRound",value:function(t){return this.parent.p5.sqrt(this.parent.p5.pow(this.position.x-t.x,2)+this.parent.p5.pow(this.position.y-t.y,2))<=this.radius}},{key:"doAction",value:function(){if(!this.parent.levelOver)if(0==this.parent.currentPoint&&(this.parent.setupVirusBall(),this.parent.sound_virus.play()),this.parent.sound_contact_point.play(),this.parent.currentPoint++,this.parent.pointer.currentDotPoint=null,this.parent.pointer.timerDotPoint=0,this.parent.pg.clear(),this.parent.currentPoint==this.parent.levelPointCount)this.parent.sound_levelcomplete.play(),this.parent.levelFinish=!0,this.parent.isDraw=!1;else{this.parent.isDraw=!0;for(var t=0;t<this.parent.levelNotDrawLintCount;t++)if(this.parent.levelNotDrawLint[t]==this.parent.currentPoint){this.parent.isDraw=!1;break}}}}]),t}(),f=function(){"use strict";function t(e,i,n,a,r,o,h,l){s(this,t),this.parent=e,this.img=i,this.img_down=n,this.position=a,this.size=r,this.isDown=!1,this.radius=o,this.actionIndex=h,this.VectorOne=this.parent.p5.createVector(1,1),this.text=l}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),0!=this.radius&&this.collideRound(this.parent.posNose)||0==this.radius&&this.collideRect(this.parent.posNose,this.VectorOne)?(this.parent.precanvas.image(this.img_down,this.position.x,this.position.y,this.size.x,this.size.y),this.parent.pointer.currentActivatedButton=this):(this.parent.precanvas.image(this.img,this.position.x,this.position.y,this.size.x,this.size.y),this.parent.pointer.currentActivatedButton==this&&(this.parent.pointer.buttonActivated||this.parent.sound_button_discontact.play(),this.parent.pointer.currentActivatedButton=null)),null!=this.text&&(this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.text,this.position.x,this.position.y)),this.parent.precanvas.pop()}},{key:"collideRound",value:function(t){return this.parent.p5.sqrt(this.parent.p5.pow(this.position.x-t.x,2)+this.parent.p5.pow(this.position.y-t.y,2))<=this.radius}},{key:"collideRect",value:function(t,e){return this.position.x-this.size.x/2<t.x+e.x&&this.position.x-this.size.x/2+this.size.x>t.x&&this.position.y-this.size.y/2<t.y+e.y&&this.position.y-this.size.y/2+this.size.y>t.y}},{key:"doAction",value:function(){this.parent.gameButtonAction(this.actionIndex)}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),x=function(){"use strict";function t(e,i,n,a,r,o){s(this,t),this.parent=e,this.x=i,this.y=n,this.vx=this.parent.p5.random(0,5),this.vy=this.parent.p5.random(0,5),this.diameter=a,this.id=r,this.others=o,this.image=this.parent.img_virus[this.parent.p5.int(this.parent.p5.random(100)%3)]}return n(t,[{key:"collide",value:function(){for(var t=this.id+1;t<this.parent.numBalls;t++){var e=this.others[t].x-this.x,i=this.others[t].y-this.y,s=this.parent.p5.sqrt(e*e+i*i),n=this.others[t].diameter/2+this.diameter/2;if(s<n){var a=this.parent.p5.atan2(i,e),r=this.x+this.parent.p5.cos(a)*n,o=this.y+this.parent.p5.sin(a)*n,h=(r-this.others[t].x)*this.parent.spring,l=(o-this.others[t].y)*this.parent.spring;this.vx-=h,this.vy-=l,this.others[t].vx+=h,this.others[t].vy+=l}}var u,p;0==this.parent.currentPoint?(u=[this.parent.levelPos[this.parent.currentPoint]],p=1):(u=[this.parent.levelPos[this.parent.currentPoint],this.parent.levelPos[this.parent.currentPoint-1]],p=2);for(var c=0;c<p;c++){var m=u[c].position.x-this.x,d=u[c].position.y-this.y,g=this.parent.p5.sqrt(m*m+d*d),v=u[c].radius+this.diameter/2;if(g<v){var f=this.parent.p5.atan2(d,m),x=this.x+this.parent.p5.cos(f)*v,y=this.y+this.parent.p5.sin(f)*v,E=(x-u[c].position.x)*this.parent.spring,_=(y-u[c].position.y)*this.parent.spring;this.vx-=E,this.vy-=_}}var w=this.parent.pointer.position.x-this.x,S=this.parent.pointer.position.y-this.y,k=this.parent.p5.sqrt(w*w+S*S),b=this.parent.pointer.radius+this.diameter/2;if(k<b){this.parent.hp-=1,this.parent.hp<=0&&!this.parent.levelOver?(this.parent.hp=0,this.parent.levelOver=!0,this.parent.sound_sneeze.isPlaying()||this.parent.sound_sneeze.play()):this.parent.levelOver||this.parent.sound_virus_hit.isPlaying()||this.parent.sound_virus_hit.play();var C=this.parent.p5.atan2(S,w),T=this.x+this.parent.p5.cos(C)*b,I=this.y+this.parent.p5.sin(C)*b,M=(T-this.parent.pointer.position.x)*this.parent.spring,R=(I-this.parent.pointer.position.y)*this.parent.spring;this.vx-=M,this.vy-=R}}},{key:"move",value:function(){this.vy+=this.parent.gravity,this.x+=this.vx,this.y+=this.vy,this.x+this.diameter/2>this.parent.CV_SIZE_W?(this.x=this.parent.CV_SIZE_W-this.diameter/2,this.vx*=this.parent.friction):this.x-this.diameter/2<0&&(this.x=this.diameter/2,this.vx*=this.parent.friction),this.y+this.diameter/2>this.parent.CV_SIZE_H?(this.y=this.parent.CV_SIZE_H-this.diameter/2,this.vy*=this.parent.friction):this.y-this.diameter/2<0&&(this.y=this.diameter/2,this.vy*=this.parent.friction)}},{key:"display",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.image,this.x,this.y,this.diameter+3,this.diameter+3),this.parent.precanvas.fill(255,150),this.parent.precanvas.pop()}}]),t}();t.exports={mlxNoseArtist:m}},35946:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput);p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput;var m=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Nose Artist",n.category="Output",n.type="NoseArtistMobileGame",n.inType="posenet",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=854,n.poses=[],n.skeletons=[],n.pg,n.noseX=0,n.noseY=0,n.pNoseX,n.pNoseY,n.isDraw=!1,n.posNose,n.gameMode="WELCOME",n.gameLevel,n.BUTTON_ACTIVATED_TIME=1200,n.DOTPOINT_ACTIVATED_TIME=800,n.hp,n.CAPTURE_IMAGE=!0,n.displayText=["1.\u0e04\u0e27\u0e23\u0e43\u0e2a\u0e48\u0e2b\u0e19\u0e49\u0e32\u0e01\u0e32\u0e01\u0e2d\u0e19\u0e32\u0e21\u0e31\u0e22\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e1b\u0e49\u0e2d\u0e07\u0e01\u0e31\u0e19","2.\u0e2b\u0e21\u0e31\u0e48\u0e19\u0e25\u0e49\u0e32\u0e07\u0e21\u0e37\u0e2d\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e0a\u0e47\u0e14\u0e14\u0e49\u0e27\u0e22\u0e41\u0e2d\u0e25\u0e01\u0e2d\u0e2e\u0e2d\u0e25\u0e4c","3.\u0e07\u0e14\u0e40\u0e14\u0e34\u0e19\u0e17\u0e32\u0e07\u0e44\u0e1b\u0e22\u0e31\u0e07\u0e1e\u0e37\u0e49\u0e19\u0e17\u0e35\u0e48\u0e40\u0e2a\u0e35\u0e48\u0e22\u0e07\u0e42\u0e23\u0e04\u0e23\u0e30\u0e1a\u0e32\u0e14","4.\u0e44\u0e21\u0e48\u0e43\u0e0a\u0e49\u0e2a\u0e34\u0e48\u0e07\u0e02\u0e2d\u0e07\u0e23\u0e48\u0e27\u0e21\u0e01\u0e31\u0e1a\u0e1c\u0e39\u0e49\u0e2d\u0e37\u0e48\u0e19","5.\u0e16\u0e49\u0e32\u0e21\u0e35\u0e2d\u0e32\u0e01\u0e32\u0e23\u0e23\u0e35\u0e1a\u0e44\u0e1b\u0e1e\u0e1a\u0e41\u0e1e\u0e17\u0e22\u0e4c\u0e17\u0e31\u0e19\u0e17\u0e35!"],n.cornerText="\u0e40\u0e01\u0e21\u0e1b\u0e23\u0e30\u0e01\u0e2d\u0e1a\u0e1a\u0e17\u0e40\u0e23\u0e35\u0e22\u0e19 AI&IoT Junior",n.GAMENAME="Nose Artist",n.OPEN_WEB_ON_FINISH="",n.FINISH_MESSAGE="\u0e22\u0e34\u0e19\u0e14\u0e35\u0e14\u0e49\u0e27\u0e22 \u0e04\u0e38\u0e13\u0e27\u0e32\u0e14\u0e23\u0e39\u0e1b\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08\u0e41\u0e25\u0e49\u0e27!!",n.CV_SIZE_W=450,n.CV_SIZE_H=732,n.BG_SIZE_W=450,n.BG_SIZE_H=400,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.CV_SIZE_W/2+2*n.mlx.mlxPadding,n.h=n.CV_SIZE_H/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.CV_SIZE_W/2,n.CV_SIZE_H/2),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.CV_SIZE_W,n.CV_SIZE_H),n.img_bg,n.img_pointer,n.img_logo,n.img_btbbig_n,n.img_btbbig_d,n.img_round_n,n.img_round_d,n.img_point,n.img_doctor,n.img_howto1,n.img_howto2,n.img_howto3,n.img_win,n.img_lose,n.img_virus=[],n.img_virus_1,n.img_virus_2,n.img_virus_3,n.font,n.ui,n.pointer,n.sound_button_activated,n.sound_button_touch,n.sound_button_discontact,n.sound_contact_point,n.sound_levelcomplete,n.sound_virus,n.sound_sneeze,n.sound_virus_hit,n.levelPos=[],n.levelPointCount,n.levelNotDrawLint,n.levelNotDrawLintCount,n.levelFinish=!1,n.levelOver=!1,n.level1Sequence=[26,312,410,312,50,601,222,167,393,601,26,312],n.level1PointCount=6,n.level1NotDrawLint=[],n.level1NotDrawLintCount=0,n.level2Sequence=[30,346,70,241,165,177,278,180,367,250,398,361,360,469,266,530,153,527,62,453,30,346,129,407,159,436,210,450,261,436,291,406,159,303,159,255,261,255,261,303],n.level2PointCount=20,n.level2NotDrawLint=[11,16,18],n.level2NotDrawLintCount=3,n.level3Sequence=[58,611,58,409,58,204,387,409,58,611,387,611,387,409,387,204,58,409,387,611,387,409,58,409,58,204,387,204,255,60,58,204,109,160,109,78,159,78,159,117],n.level3PointCount=20,n.level3NotDrawLint=[10,12,16],n.level3NotDrawLintCount=3,n.numBalls=10,n.spring=.05,n.gravity=0,n.friction=-.9,n.virusBalls=[],n.currentPoint,n.cameraMode=!1,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_bg=this.p5.loadImage("assets_game/mlxNoseArtist/img_bg.png"),this.img_pointer=this.p5.loadImage("assets_game/mlxNoseArtist/img_pointer.png"),this.img_logo=this.p5.loadImage("assets_game/mlxNoseArtist/logo.png"),this.img_btflip_n=this.p5.loadImage("assets_game/mlxNoseArtist/flipcamera_bt_n.png"),this.img_btflip_d=this.p5.loadImage("assets_game/mlxNoseArtist/flipcamera_bt_d.png"),this.img_btbbig_n=this.p5.loadImage("assets_game/mlxNoseArtist/img_btbig_n.png"),this.img_btbbig_d=this.p5.loadImage("assets_game/mlxNoseArtist/img_btbig_d.png"),this.img_round_n=this.p5.loadImage("assets_game/mlxNoseArtist/img_round_n.png"),this.img_round_d=this.p5.loadImage("assets_game/mlxNoseArtist/img_round_d.png"),this.img_howto1=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_1.png"),this.img_howto2=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_2.png"),this.img_howto3=this.p5.loadImage("assets_game/mlxNoseArtist/img_howto_3.png"),this.img_point=this.p5.loadImage("assets_game/mlxNoseArtist/img_pointer_w.png"),this.img_win=this.p5.loadImage("assets_game/mlxNoseArtist/img_win.png"),this.img_lose=this.p5.loadImage("assets_game/mlxNoseArtist/img_lose.png"),this.img_doctor=this.p5.loadImage("assets_game/mlxNoseArtist/doctor.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxNoseArtist/waiting_mobile.png"),this.font=this.p5.loadFont("assets_game/mlxNoseArtist/JSJindara-Bold.otf"),this.sound_button_activated=this.p5.loadSound("assets_game/mlxNoseArtist/button_activated.mp3"),this.sound_button_touch=this.p5.loadSound("assets_game/mlxNoseArtist/button_touch.mp3"),this.sound_button_discontact=this.p5.loadSound("assets_game/mlxNoseArtist/button_discontact.mp3"),this.sound_contact_point=this.p5.loadSound("assets_game/mlxNoseArtist/contact_point.mp3"),this.sound_levelcomplete=this.p5.loadSound("assets_game/mlxNoseArtist/levelcomplete.mp3"),this.sound_sneeze=this.p5.loadSound("assets_game/mlxNoseArtist/sneeze.mp3"),this.sound_virus_hit=this.p5.loadSound("assets_game/mlxNoseArtist/contact.mp3"),this.sound_virus=this.p5.loadSound("assets_game/mlxNoseArtist/virus.mp3"),this.img_virus_1=this.p5.loadImage("assets_game/mlxNoseArtist/virus5.png"),this.img_virus_2=this.p5.loadImage("assets_game/mlxNoseArtist/virus6.png"),this.img_virus_3=this.p5.loadImage("assets_game/mlxNoseArtist/virus7.png")}},{key:"setup",value:function(){this.pg=this.p5.createGraphics(this.CV_SIZE_W,this.CV_SIZE_H),this.ui=new d(this),this.pointer=new g(this),this.img_virus=[this.img_virus_1,this.img_virus_2,this.img_virus_3]}},{key:"doProcess",value:function(){return this.poses=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture?(this.gameConnected||(this.gameMode="WELCOME",this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.CV_SIZE_W,0)),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.image(this.pg,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop(),this.precanvas.push(),this.posNose=this.p5.createVector(this.CV_SIZE_W-this.noseX,this.noseY),this.ui.draw(),this.pointer.draw(),this.precanvas.pop()):(this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.CV_SIZE_W,this.CV_SIZE_H),this.precanvas.pop(),this.gameConnected=!1),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.CV_SIZE_W,this.CV_SIZE_W),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.CV_SIZE_W;var t=(this.h-110)/this.CV_SIZE_H;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.CV_SIZE_W*this.fullscreen_scale,this.CV_SIZE_H*this.fullscreen_scale)}},{key:"gameButtonAction",value:function(t){switch(t){case 1:this.pointer.currentActivatedButton=null,this.gameMode="LEVEL";break;case 21:this.pointer.currentActivatedButton=null,this.gameMode="PLAY",this.gameLevel=1,this.hp=100,this.levelPos=[],this.levelPointCount=this.level1PointCount,this.levelNotDrawLint=this.level1NotDrawLint,this.levelNotDrawLintCount=this.level1NotDrawLintCount;for(var e=0;e<this.levelPointCount;e++)this.levelPos[e]=new v(this.p5.createVector(this.level1Sequence[2*e],this.level1Sequence[2*e+1]),e,this);this.currentPoint=0,this.levelFinish=!1,this.levelOver=!1,this.clearnVirusBall();break;case 22:this.pointer.currentActivatedButton=null,this.gameMode="PLAY",this.gameLevel=2,this.hp=100,this.levelPos=[],this.levelPointCount=this.level2PointCount,this.levelNotDrawLint=this.level2NotDrawLint,this.levelNotDrawLintCount=this.level2NotDrawLintCount;for(e=0;e<this.levelPointCount;e++)this.levelPos[e]=new v(this.p5.createVector(this.level2Sequence[2*e],this.level2Sequence[2*e+1]),e,this);this.currentPoint=0,this.levelFinish=!1,this.levelOver=!1,this.clearnVirusBall();break;case 23:this.pointer.currentActivatedButton=null,this.gameMode="PLAY",this.gameLevel=3,this.hp=100,this.levelPos=[],this.levelPointCount=this.level3PointCount,this.levelNotDrawLint=this.level3NotDrawLint,this.levelNotDrawLintCount=this.level3NotDrawLintCount;for(e=0;e<this.levelPointCount;e++)this.levelPos[e]=new v(this.p5.createVector(this.level3Sequence[2*e],this.level3Sequence[2*e+1]),e,this);this.currentPoint=0,this.levelFinish=!1,this.levelOver=!1,this.clearnVirusBall();break;case 3:this.pointer.currentActivatedButton=null,this.gameMode="LEVEL";break;case 4:this.pointer.currentActivatedButton=null,null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.cameraMenu&&(this.cameraMode=!this.cameraMode,this.inElement.inElement.switchCamera(this.cameraMode))}}},{key:"getKeypoints",value:function(){if(null!=this.poses)for(var t=0,e=0;e<this.poses.length;e++){if(null==this.poses[e].pose)return;var i=this.poses[e].pose.keypoints[0];if(i.score>.2&&t<i.score){t=i.score;var s=i.position.x;this.inElement.inElement.flip||(s=this.inElement.inElement.videoWidth-i.position.x);var n=this.CV_SIZE_W/this.inElement.inElement.videoWidth,a=this.CV_SIZE_H/this.inElement.inElement.videoHeight;this.noseX=s*n,this.noseY=i.position.y*a,this.isDraw&&(this.pg.push(),this.pg.stroke(230,234,0,200),this.pg.strokeWeight(7),this.pg.line(this.noseX,this.noseY,this.pNoseX,this.pNoseY),this.pg.pop()),this.pNoseX=this.noseX,this.pNoseY=this.noseY}}}},{key:"setupVirusBall",value:function(){this.virusBalls=[];for(var t=0;t<this.numBalls;t++)this.virusBalls[t]=new x(this,this.p5.random(this.CV_SIZE_W),this.p5.random(this.CV_SIZE_H),this.p5.random(30,70),t,this.virusBalls)}},{key:"clearnVirusBall",value:function(){for(var t=0;t<this.numBalls;t++)this.virusBalls[t]=null;this.virusBalls=null}}]),i}(c),d=function(){"use strict";function t(e){s(this,t),this.parent=e,this.b_welcome=new f(this.parent,this.parent.img_btbbig_n,this.parent.img_btbbig_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2+150,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),0,1,"\u0e40\u0e23\u0e34\u0e48\u0e21"),this.b_flipcamera=new f(this.parent,this.parent.img_btflip_n,this.parent.img_btflip_d,this.parent.p5.createVector(this.parent.CV_SIZE_W-50,50),this.parent.p5.createVector(80,80),0,4,""),this.b_level1=new f(this.parent,this.parent.img_round_n,this.parent.img_round_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2-150-20,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),40,21,"1"),this.b_level2=new f(this.parent,this.parent.img_round_n,this.parent.img_round_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2-75-10,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),40,22,"2"),this.b_level3=new f(this.parent,this.parent.img_round_n,this.parent.img_round_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2-0,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),40,23,"3"),this.b_win=new f(this.parent,this.parent.img_btbbig_n,this.parent.img_btbbig_d,this.parent.p5.createVector(this.parent.CV_SIZE_W/2+150,this.parent.CV_SIZE_H/2+150),this.parent.p5.createVector(80,80),0,3,"\u0e15\u0e01\u0e25\u0e07"),this.alpha_1=0,this.alpha_2=0,this.flashScreen=!1,this.countdown=7e3}return n(t,[{key:"draw",value:function(){var t=this.parent.CV_SIZE_W,e=this.parent.CV_SIZE_H;if(this.parent.precanvas.push(),"WELCOME"==this.parent.gameMode)this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_logo,t/2,e/2-50,250,250),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(38,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text(this.parent.GAMENAME,t/2,e/2+80),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,0),this.parent.precanvas.fill(0),this.parent.precanvas.text("\u0e40\u0e01\u0e21\u0e19\u0e35\u0e49\u0e43\u0e0a\u0e49\u0e08\u0e21\u0e39\u0e01\u0e43\u0e19\u0e01\u0e32\u0e23\u0e40\u0e25\u0e48\u0e19",t/2-this.parent.BG_SIZE_W/2+10,e/2+125),this.parent.precanvas.text("\u0e02\u0e22\u0e31\u0e1a\u0e21\u0e32\u0e17\u0e35\u0e48\u0e1b\u0e38\u0e48\u0e21\u0e41\u0e25\u0e30\u0e04\u0e49\u0e32\u0e07\u0e44\u0e27\u0e49\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e23\u0e34\u0e48\u0e21\u0e40\u0e25\u0e48\u0e19",t/2-this.parent.BG_SIZE_W/2+10,e/2+150),this.b_welcome.draw();else if("LEVEL"==this.parent.gameMode)this.flashScreen=!1,this.alpha_2=0,this.countdown=7e3,this.parent.isDraw=!1,this.parent.pg.clear(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_howto1,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+60,100,100),this.parent.precanvas.image(this.parent.img_howto2,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+160,100,100),this.parent.precanvas.image(this.parent.img_howto3,t/2-this.parent.BG_SIZE_W/2+60,e/2-this.parent.BG_SIZE_W/2+260,100,100),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.rectMode(this.parent.p5.CORNER),this.parent.precanvas.text("1.\u0e25\u0e32\u0e01\u0e40\u0e2a\u0e49\u0e19\u0e1c\u0e48\u0e32\u0e19\u0e08\u0e38\u0e14\u0e17\u0e35\u0e48\u0e01\u0e33\u0e2b\u0e19\u0e14 \u0e15\u0e32\u0e21\u0e25\u0e33\u0e14\u0e31\u0e1a\u0e08\u0e19\u0e2b\u0e21\u0e14",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+50,this.parent.BG_SIZE_W-150,300),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.parent.precanvas.text("2.\u0e2b\u0e25\u0e1a\u0e44\u0e27\u0e23\u0e31\u0e2a\u0e17\u0e35\u0e48\u0e08\u0e30\u0e25\u0e2d\u0e22\u0e40\u0e02\u0e49\u0e32\u0e08\u0e21\u0e39\u0e01",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+150),this.parent.precanvas.text("3.\u0e16\u0e49\u0e32\u0e42\u0e14\u0e19\u0e44\u0e27\u0e23\u0e31\u0e2a\u0e08\u0e19\u0e1e\u0e25\u0e31\u0e07\u0e2b\u0e21\u0e14\u0e08\u0e30\u0e41\u0e1e\u0e49",t/2-this.parent.BG_SIZE_W/2+120,e/2-this.parent.BG_SIZE_W/2+250),this.setTextSizeStrokeWeight(30,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.parent.precanvas.text("\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e14\u0e48\u0e32\u0e19",t/2,e/2-this.parent.BG_SIZE_W/2+310),this.b_level1.draw(),this.b_level2.draw(),this.b_level3.draw();else if("PLAY"==this.parent.gameMode){if(this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.push(),a=(a=this.parent.p5.createVector(79,96,88)).lerp(268,100,79,1-this.parent.hp/100),this.parent.precanvas.colorMode(this.parent.p5.HSB,339,100,100,100),this.parent.precanvas.fill(a.x,a.y,a.z,25),this.parent.precanvas.rect(0,0,t,e),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.parent.levelFinish)for(var i=0;i<this.parent.currentPoint-1;i++){for(var s=!0,n=0;n<this.parent.levelNotDrawLintCount;n++)if(this.parent.levelNotDrawLint[n]-1==i){s=!1;break}s&&(this.parent.precanvas.push(),this.parent.precanvas.stroke(0,255),this.parent.precanvas.strokeWeight(25),this.parent.precanvas.line(this.parent.levelPos[i].position.x,this.parent.levelPos[i].position.y,this.parent.levelPos[i+1].position.x,this.parent.levelPos[i+1].position.y),this.parent.precanvas.pop())}for(i=0;i<this.parent.currentPoint-1;i++){for(s=!0,n=0;n<this.parent.levelNotDrawLintCount;n++)if(this.parent.levelNotDrawLint[n]-1==i){s=!1;break}s&&(this.parent.precanvas.stroke(255,234,0,this.parent.levelFinish?255:220),this.parent.precanvas.strokeWeight(this.parent.levelFinish?15:10),this.parent.precanvas.line(this.parent.levelPos[i].position.x,this.parent.levelPos[i].position.y,this.parent.levelPos[i+1].position.x,this.parent.levelPos[i+1].position.y))}if(this.parent.precanvas.pop(),this.parent.levelFinish)this.countdown-=this.parent.p5.deltaTime,this.countdown<0&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_win,t/2,e/2-50,250,170),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.text(this.parent.FINISH_MESSAGE,t/2-this.parent.BG_SIZE_W/2+15,e/2+125),this.b_win.draw(),this.parent.precanvas.pop());else{for(i=0;i<this.parent.levelPointCount;i++)this.parent.levelPos[i].draw();var a;null!=this.parent.virusBalls&&this.parent.virusBalls.forEach((function(t){t.collide(),t.move(),t.display()})),this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(5,5,150,40),a=(a=this.parent.p5.createVector(79,96,88)).lerp(0,96,88,1-this.parent.hp/100),this.parent.precanvas.colorMode(this.parent.p5.HSB,339,100,100),this.parent.precanvas.fill(a.x,a.y,a.z),this.parent.precanvas.rect(8,8,this.parent.hp/100*144,34),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.setTextSizeStrokeWeight(25,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.textAlign(this.parent.p5.RIGHT,this.parent.p5.CENTER);var r="\u0e40\u0e2b\u0e25\u0e37\u0e2d\u0e2d\u0e35\u0e01 "+(this.parent.levelPointCount-this.parent.currentPoint)+"\u0e08\u0e38\u0e14";0==this.parent.currentPoint&&(r="\u0e44\u0e1b\u0e17\u0e35\u0e48\u0e08\u0e38\u0e14\u0e01\u0e23\u0e30\u0e1e\u0e23\u0e34\u0e1a\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19"),this.parent.precanvas.text(r,t-40,25),this.parent.currentPoint>0&&this.parent.currentPoint<=this.parent.displayText.length&&(this.setTextSizeStrokeWeight(25,0,3),this.parent.precanvas.fill(255,230),this.parent.precanvas.rect(0,e-60,450,50,10),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_doctor,t-50,e-98,50,98),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.text(this.parent.displayText[this.parent.currentPoint-1],10,e-60,440,50)),this.parent.precanvas.pop(),this.parent.levelOver&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.CENTER),this.parent.precanvas.image(this.parent.img_bg,t/2,e/2,this.parent.BG_SIZE_W,this.parent.BG_SIZE_H),this.parent.precanvas.image(this.parent.img_lose,t/2,e/2-50,220,250),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(161,9,225),this.parent.precanvas.text("\u0e40\u0e2a\u0e35\u0e22\u0e43\u0e08\u0e14\u0e49\u0e27\u0e22 \u0e04\u0e38\u0e13\u0e1b\u0e48\u0e27\u0e22\u0e0b\u0e30\u0e41\u0e25\u0e49\u0e27!!",t/2-this.parent.BG_SIZE_W/2+15,e/2+125),this.b_win.draw(),this.parent.precanvas.pop())}}this.parent.precanvas.pop()}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),g=function(){"use strict";function t(e){s(this,t),this.parent=e,this.position,this.radius=5,this.timer=1e3,this.buttonActivated=!1,this.currentActivatedButton=null,this.timerDotPoint=1e3,this.currentDotPoint=null}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.position=this.parent.p5.createVector(this.parent.posNose.x,this.parent.posNose.y),this.parent.precanvas.image(this.parent.img_pointer,this.parent.posNose.x,this.parent.posNose.y),this.parent.precanvas.pop(),null==this.currentActivatedButton||this.buttonActivated?null!=this.currentActivatedButton&&this.buttonActivated||(this.timer=0,this.buttonActivated=!1):this.showTimer(),null!=this.currentDotPoint&&this.currentDotPoint.pointCount==this.parent.currentPoint?this.showTimerForDotPoint():this.timerDotPoint=0}},{key:"showTimerForDotPoint",value:function(){0==this.timerDotPoint&&this.parent.sound_button_touch.play(),this.timerDotPoint+=this.parent.p5.deltaTime,this.timerDotPoint>this.parent.DOTPOINT_ACTIVATED_TIME?(this.timerDotPoint=this.parent.DOTPOINT_ACTIVATED_TIME,this.currentDotPoint.doAction()):(this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,50,15),this.parent.precanvas.fill(255,234,0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,this.timerDotPoint/this.parent.DOTPOINT_ACTIVATED_TIME*50,15),this.parent.precanvas.pop())}},{key:"showTimer",value:function(){this.buttonActivated||(0==this.timer&&this.parent.sound_button_touch.play(),this.timer+=this.parent.p5.deltaTime,this.timer>this.parent.BUTTON_ACTIVATED_TIME?(this.timer=this.parent.BUTTON_ACTIVATED_TIME,this.currentActivatedButton.doAction(),this.buttonActivated=!0,this.parent.sound_button_activated.play()):(this.parent.precanvas.push(),this.parent.precanvas.fill(0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,50,15),this.parent.precanvas.fill(255,0,0),this.parent.precanvas.rect(this.parent.posNose.x-25,this.parent.posNose.y-33,this.timer/this.parent.BUTTON_ACTIVATED_TIME*50,15),this.parent.precanvas.pop()))}}]),t}(),v=function(){"use strict";function t(e,i,n){s(this,t),this.parent=n,this.position=e,this.pointCount=i,this.alpha_1=0,this.radius=25}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),this.pointCount==this.parent.currentPoint?(this.alpha_1+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.tint(255,0,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_1))),this.parent.precanvas.image(this.parent.img_point,this.position.x,this.position.y,50,50),this.collideRound(this.parent.posNose)?this.parent.pointer.currentDotPoint=this:this.parent.pointer.currentDotPoint==this&&(this.parent.pointer.currentDotPoint=null)):(this.pointCount<this.parent.currentPoint?this.parent.precanvas.tint(80,100):this.pointCount>this.parent.currentPoint&&this.pointCount<this.parent.currentPoint+5?this.parent.precanvas.tint(255,234,0,(5-(this.pointCount-this.parent.currentPoint))/5*150):this.parent.precanvas.tint(80,24),this.parent.precanvas.image(this.parent.img_point,this.position.x,this.position.y,25,25)),this.parent.precanvas.pop()}},{key:"collideRound",value:function(t){return this.parent.p5.sqrt(this.parent.p5.pow(this.position.x-t.x,2)+this.parent.p5.pow(this.position.y-t.y,2))<=this.radius}},{key:"doAction",value:function(){if(!this.parent.levelOver)if(0==this.parent.currentPoint&&(this.parent.setupVirusBall(),this.parent.sound_virus.play()),this.parent.sound_contact_point.play(),this.parent.currentPoint++,this.parent.pointer.currentDotPoint=null,this.parent.pointer.timerDotPoint=0,this.parent.pg.clear(),this.parent.currentPoint==this.parent.levelPointCount)this.parent.sound_levelcomplete.play(),this.parent.levelFinish=!0,this.parent.isDraw=!1;else{this.parent.isDraw=!0;for(var t=0;t<this.parent.levelNotDrawLintCount;t++)if(this.parent.levelNotDrawLint[t]==this.parent.currentPoint){this.parent.isDraw=!1;break}}}}]),t}(),f=function(){"use strict";function t(e,i,n,a,r,o,h,l){s(this,t),this.parent=e,this.img=i,this.img_down=n,this.position=a,this.size=r,this.isDown=!1,this.radius=o,this.actionIndex=h,this.VectorOne=this.parent.p5.createVector(1,1),this.text=l}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),0!=this.radius&&this.collideRound(this.parent.posNose)||0==this.radius&&this.collideRect(this.parent.posNose,this.VectorOne)?(this.parent.precanvas.image(this.img_down,this.position.x,this.position.y,this.size.x,this.size.y),this.parent.pointer.currentActivatedButton=this):(this.parent.precanvas.image(this.img,this.position.x,this.position.y,this.size.x,this.size.y),this.parent.pointer.currentActivatedButton==this&&(this.parent.pointer.buttonActivated||this.parent.sound_button_discontact.play(),this.parent.pointer.currentActivatedButton=null)),null!=this.text&&(this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(20,0,3),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.text,this.position.x,this.position.y)),this.parent.precanvas.pop()}},{key:"collideRound",value:function(t){return this.parent.p5.sqrt(this.parent.p5.pow(this.position.x-t.x,2)+this.parent.p5.pow(this.position.y-t.y,2))<=this.radius}},{key:"collideRect",value:function(t,e){return this.position.x-this.size.x/2<t.x+e.x&&this.position.x-this.size.x/2+this.size.x>t.x&&this.position.y-this.size.y/2<t.y+e.y&&this.position.y-this.size.y/2+this.size.y>t.y}},{key:"doAction",value:function(){this.parent.gameButtonAction(this.actionIndex)}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),x=function(){"use strict";function t(e,i,n,a,r,o){s(this,t),this.parent=e,this.x=i,this.y=n,this.vx=this.parent.p5.random(0,5),this.vy=this.parent.p5.random(0,5),this.diameter=a,this.id=r,this.others=o,this.image=this.parent.img_virus[this.parent.p5.int(this.parent.p5.random(100)%3)]}return n(t,[{key:"collide",value:function(){for(var t=this.id+1;t<this.parent.numBalls;t++){var e=this.others[t].x-this.x,i=this.others[t].y-this.y,s=this.parent.p5.sqrt(e*e+i*i),n=this.others[t].diameter/2+this.diameter/2;if(s<n){var a=this.parent.p5.atan2(i,e),r=this.x+this.parent.p5.cos(a)*n,o=this.y+this.parent.p5.sin(a)*n,h=(r-this.others[t].x)*this.parent.spring,l=(o-this.others[t].y)*this.parent.spring;this.vx-=h,this.vy-=l,this.others[t].vx+=h,this.others[t].vy+=l}}var u,p;0==this.parent.currentPoint?(u=[this.parent.levelPos[this.parent.currentPoint]],p=1):(u=[this.parent.levelPos[this.parent.currentPoint],this.parent.levelPos[this.parent.currentPoint-1]],p=2);for(var c=0;c<p;c++){var m=u[c].position.x-this.x,d=u[c].position.y-this.y,g=this.parent.p5.sqrt(m*m+d*d),v=u[c].radius+this.diameter/2;if(g<v){var f=this.parent.p5.atan2(d,m),x=this.x+this.parent.p5.cos(f)*v,y=this.y+this.parent.p5.sin(f)*v,E=(x-u[c].position.x)*this.parent.spring,_=(y-u[c].position.y)*this.parent.spring;this.vx-=E,this.vy-=_}}var w=this.parent.pointer.position.x-this.x,S=this.parent.pointer.position.y-this.y,k=this.parent.p5.sqrt(w*w+S*S),b=this.parent.pointer.radius+this.diameter/2;if(k<b){this.parent.hp-=1,this.parent.hp<=0&&!this.parent.levelOver?(this.parent.hp=0,this.parent.levelOver=!0,this.parent.sound_sneeze.isPlaying()||this.parent.sound_sneeze.play()):this.parent.levelOver||this.parent.sound_virus_hit.isPlaying()||this.parent.sound_virus_hit.play();var C=this.parent.p5.atan2(S,w),T=this.x+this.parent.p5.cos(C)*b,I=this.y+this.parent.p5.sin(C)*b,M=(T-this.parent.pointer.position.x)*this.parent.spring,R=(I-this.parent.pointer.position.y)*this.parent.spring;this.vx-=M,this.vy-=R}}},{key:"move",value:function(){this.vy+=this.parent.gravity,this.x+=this.vx,this.y+=this.vy,this.x+this.diameter/2>this.parent.CV_SIZE_W?(this.x=this.parent.CV_SIZE_W-this.diameter/2,this.vx*=this.parent.friction):this.x-this.diameter/2<0&&(this.x=this.diameter/2,this.vx*=this.parent.friction),this.y+this.diameter/2>this.parent.CV_SIZE_H?(this.y=this.parent.CV_SIZE_H-this.diameter/2,this.vy*=this.parent.friction):this.y-this.diameter/2<0&&(this.y=this.diameter/2,this.vy*=this.parent.friction)}},{key:"display",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.image,this.x,this.y,this.diameter+3,this.diameter+3),this.parent.precanvas.fill(255,150),this.parent.precanvas.pop()}}]),t}();t.exports={mlxNoseArtistMobile:m}},75184:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,!0),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Doodle QuickDraw",n.category="Output",n.type="DoodleQuickDraw",n.inType="results",n.outType="results",n.needMouse=!0,n.lastSpeakeWord,n.gameMode="INTRO",n.timeShowFound=4e3,n.welcomeSound=!1,n.canvas,n.drawCanvas,n.imageFromDrawCanvas,n.currentWord,n.currentGuess,n.currentIndex=0,n.isPlaying=!1,n.words=["shoe","book","keyboard","pants","cup"],n.myVoice=new p5.Speech,n.isModelReady=!1,n.previousResultWord=null,n.timeLeft=6e4,n.sound_blip,n.font,n.canvas_w=407,n.canvas_h=151,n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.w=n.canvas_w+2*n.mlx.mlxPadding,n.h=n.canvas_h+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=10,n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w,n.canvas_h),n.canvas=n.offScreen.offScreen,n.preload(),n.setup(),n.createElementMenu(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.myVoice.cancel(),t.mlx.removeElement(t)}))}},{key:"preload",value:function(){this.img_1=this.p5.loadImage("assets_game/mlxQuickDraw/img1.png"),this.img_2=this.p5.loadImage("assets_game/mlxQuickDraw/img2.png"),this.img_3=this.p5.loadImage("assets_game/mlxQuickDraw/img3.png"),this.img_4=this.p5.loadImage("assets_game/mlxQuickDraw/img4.png"),this.img_5=this.p5.loadImage("assets_game/mlxQuickDraw/img5.png"),this.sound_blip=this.p5.loadSound("assets_game/mlxQuickDraw/Blip.mp3"),this.sound_start=this.p5.loadSound("assets_game/mlxQuickDraw/start.mp3"),this.font=this.p5.loadFont("assets_game/mlxQuickDraw/JSJindara-Bold.otf")}},{key:"setup",value:function(){this.precanvas.textFont(this.font),this.myVoice.onEnd=this.speechEnded}},{key:"resetGame",value:function(){this.clearCanvas(),this.currentIndex=0,this.gameMode="INTRO",this.timeShowFound=4e3,this.timeLeft=6e4}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),"INTRO"==this.gameMode)this.precanvas.image(this.img_1,0,0,this.canvas_w,this.canvas_h),this.welcomeSound||(this.welcomeSound=!0,this.myVoice.speak("Welcome, Press Start to begin!! "));else if("FINDING"==this.gameMode)this.precanvas.push(),this.precanvas.image(this.img_2,0,0,this.canvas_w,this.canvas_h),this.setTextSizeStrokeWeight(30,0,2),this.precanvas.fill(255),this.precanvas.textAlign(this.p5.LEFT,this.p5.CENTER),this.precanvas.text(this.currentWord,231,8,173,33),this.setTextSizeStrokeWeight(45,0,2),this.precanvas.textAlign(this.p5.CENTER,this.p5.CENTER),this.precanvas.text(this.p5.floor(this.timeLeft/1e3),18,70,70,63),this.precanvas.fill(255,234,0),this.setTextSizeStrokeWeight(26,0,2),this.precanvas.text(this.currentGuess,113,98,205,46),this.precanvas.pop(),this.timeLeft-=this.p5.deltaTime,this.timeLeft<=0&&(this.gameMode="OVER",this.myVoice.cancel(),this.myVoice.speak("Sorry , I do not know what you are drawing"),this.timeShowFound=6e3);else if("FOUND"==this.gameMode){this.precanvas.push();var e=this.img_3;this.currentIndex==this.words.length&&(e=this.img_5),this.precanvas.image(e,0,0,this.canvas_w,this.canvas_h),this.timeShowFound-=this.p5.deltaTime,this.timeShowFound<=0&&(this.currentIndex!=this.words.length?(this.gameMode="FINDING",this.timeShowFound=4e3,this.playNextWord(),this.currentIndex++,this.timeLeft=6e4,this.clearCanvas()):this.resetGame())}else"OVER"==this.gameMode&&(this.precanvas.push(),this.precanvas.image(this.img_4,0,0,this.canvas_w,this.canvas_h),this.timeShowFound-=this.p5.deltaTime,this.timeShowFound<=0&&this.resetGame());this.canvas.push(),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),null!=this.inElement&&null!=this.inElement.inElement||this.myVoice.stop()}},{key:"mousePressed",value:function(){"INTRO"==this.gameMode&&(this.sound_blip.play(),this.gameMode="FINDING",this.playNextWord(),this.currentIndex++)}},{key:"clearCanvas",value:function(){null!=this.inElement&&null!=this.inElement.inElement&&"DrawCanvas"==this.inElement.inElement.type&&this.inElement.inElement.canvas.background(255)}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.precanvas.textSize(t),this.precanvas.stroke(e)}},{key:"playNextWord",value:function(){this.isPlaying=!0,this.currentWord=this.words[this.currentIndex]}},{key:"doProcess",value:function(){if(this.results=this.inElement.output,void 0!=this.results){this.result=this.results[0].label;for(var t=this.result.split(",")[0],e=this.results.map((function(t){return t.label})),i=!1,s=0;s<e.length;s++)if(e[s]==this.currentWord){i=!0;break}if(i&&"FINDING"==this.gameMode)this.isPlaying=!1,this.currentIndex==this.words.length?(this.currentGuess="Congratulations. You won.",this.sound_start.play(),this.myVoice.cancel(),this.myVoice.speak("Congratulations. You won.")):(this.currentGuess="Oh I know. it's "+this.currentWord,this.myVoice.cancel(),this.myVoice.speak("Oh I know. it's ".concat(this.currentWord,"!"))),this.gameMode="FOUND";else if("FINDING"==this.gameMode&&(null==this.previousResultWord||this.previousResultWord!=t))if("line"==t)this.currentGuess="Please  draw "+this.currentWord,m&&this.lastSpeakeWord!=this.currentGuess&&(m=!1,this.myVoice.cancel(),this.myVoice.speak("Please  draw ".concat(this.currentWord)),this.lastSpeakeWord=this.currentGuess);else{if(null==t)return;this.currentGuess="I see "+t,m&&this.lastSpeakeWord!=this.currentGuess&&(m=!1,this.myVoice.cancel(),this.myVoice.speak("I see ".concat(t)),this.lastSpeakeWord=this.currentGuess)}return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}}},{key:"speechEnded",value:function(){m=!0}}]),i}(c);t.exports={mlxQuickDraw:d}},81502:function(t,e,i){var s=i(809),n=i(38561),a=i(2553),r=i(62012),o=i(50450),h=i(18770),l=i(9807),u=i(27690),p=i(99828);function c(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"===typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(t,e)}(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var s=0,n=function(){};return{s:n,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,o=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){o=!0,a=t},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw a}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=new Array(e);i<e;i++)s[i]=t[i];return s}function d(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p(t);if(e){var n=p(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return u(this,i)}}var g=i(46120).mlxElementInput,v=i(7597),f=i(20640),x=function(t){"use strict";l(i,t);var e=d(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="RTCVideo",s.title="RTCVideo Capture",s.inType="none",s.outType="image",s.replaceImage=null,s.contentAspectRatio=16/9,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.contentW=3616/9,s.contentH=s.contentW/s.contentAspectRatio,s.contentScale=1,s.setElementSizeByContentSize(),s.resizable=!0,s.flip=!1,s.needMouse=!0,s.autoMaximize=!1,s.createElementMenu(),s.isVideoCaptureReady=!1,s.doCaptureScreen=!1,s.constraints={audio:!1,video:{facingMode:s.facingMode}},/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(s.constraints.video.aspectRatio=16/9),s.doCreateVideoCapture(),console.log("video capture ready"),s.flipButton=s.mlx.createButton(o(s),"Camera",(function(){s.switchCamera(!s.cameraMode)}),10+s.mlx.mlxPadding,s.h-10-22-s.mlx.mlxPadding,80,22),s.flipButton.border=!0,s.flipButton.hidden=!0,s.outputIsReady=!1,s.busy=!1,s.beepSound=s.p5.loadSound("/assets/shutterbeep.mp3"),s.shutterSound=s.p5.loadSound("/assets/shuttersound.mp3"),s.divW=100,s.divH=20,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.inputX=s.contentX,s.inputY=s.contentY+40,s.label=s.mlx.createLabel(o(s),"Waiting for the video signal..",10,30,s.contentW,24),s.labelPeerId=s.mlx.createButton(o(s),"",(function(){var t=s.labelPeerId.text,e=f(t,{debug:!0,format:"text/plain",onCopy:function(){s.labelPeerId.setText("".concat(t," Copied")),setTimeout((function(){s.labelPeerId.setText("".concat(t))}),500)}});console.log(e)}),-10,50,s.contentW,24),s.qrid=v.generate(),s.div=t.p5.createDiv(),s.div.id(s.qrid),s.div.size(256,256),s.div.position(s.x+10,s.y+70),s.div.style("background-color","#FFFF00"),s.div.style("text-align","left"),s.div.style("font-size","x-small"),s.div.style("display","block"),s.qrcode=new QRCode(s.qrid,{width:256,height:256}),s.mh=s.h,s.mw=s.w,s}return r(i,[{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.inputX,s=this.y+this.inputY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale),this.div.size(256*this.mlx.userScale,256*this.mlx.userScale)}},{key:"update",value:function(){h(p(i.prototype),"update",this).call(this,this.x,this.y),this.setPosition(this.x,this.y)}},{key:"inactivateUI",value:function(){this.div.hide()}},{key:"activateUI",value:function(){this.div.show()}},{key:"doCreateVideoCapture",value:function(){var t=this;this.ready&&this.videoCapture.remove();var e=new Peer(v.generate().substring(0,4));this.peer=e,e.on("open",function(){var e=n(s.mark((function e(i){var n,a;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.peerId=i,n=window.location.host,a="".concat(location.protocol,"//").concat(n,"/rtc?uid=").concat(t.peerId),console.log(a),t.labelPeerId.setText(a),t.qrcode.makeCode(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("call",(function(e){console.log("Call received!"),t.ready=!1,e.on("stream",function(){var e=n(s.mark((function e(i){var n,a,r,o;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.label.hidden=!0,t.div.style("display","none"),(n=t.videoCapture.elt).srcObject=i,n.setAttribute("playsinline",""),n.onloadedmetadata=function(e){t.videoRawWidth=e.target.videoWidth,t.videoRawHeight=e.target.videoHeight,t.contentAspectRatio=t.videoRawWidth/t.videoRawHeight,t.videoWidth=t.w-2*t.mlx.mlxPadding,t.videoHeight=t.videoWidth/t.contentAspectRatio,t.videoCapture.size(t.videoWidth,t.videoHeight),t.videoCapture.hide(),t.contentW=t.videoWidth,t.contentH=t.videoHeight,n.play(),t.videoCapture.play(),t.setVideoCaptureSize(),t.setElementSizeByContentSize(),t.labelPeerId.hidden=!0,t.videoCapture.play(),t.ready=!0},a=c(i.getTracks()),e.prev=7,a.s();case 9:if((r=a.n()).done){e.next=15;break}return o=r.value,e.next=13,o.addEventListener("ended",(function(){console.log("track end!")}));case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[7,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()),e.on("close",(function(t){console.log("call.on close")})),e.answer()}));try{this.ready=!1,this.videoCapture=this.mlx.p5.createVideo(),this.isVideoCaptureReady=!1,this.videoRawWidth=800,this.videoRawHeight=600,this.contentAspectRatio=this.videoRawWidth/this.videoRawHeight,this.videoWidth=this.w-2*this.mlx.mlxPadding,this.videoHeight=this.videoWidth/this.contentAspectRatio,this.videoCapture.size(this.videoWidth,this.videoHeight),this.videoCapture.hide(),this.contentW=this.videoWidth,this.contentH=this.videoHeight,this.setElementSizeByContentSize(),this.isMaximize&&this.scaleContentToFillSize(!1),this.autoMaximize&&this.enterMaximize(),window.xyz=this.videoCapture,this.output=this.videoCapture,window.videoCapture=this.videoCapture}catch(i){console.log("ERROR",i),this.loading.html("ERROR: "+i),this.ready=!1}}},{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.flip=this.flip,t.autoMaximize=this.autoMaximize,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.flip=t.flip,this.flipMenu.value=this.flip,t.autoMaximize?this.autoMaximize=t.autoMaximize:this.autoMaximize=!1,this.autoMaxMenu.value=this.autoMaximize,this.autoMaximize&&(this.lockMaximize=!0,this.enterMaximize())}},{key:"setVideoCaptureSize",value:function(){this.videoWidth=this.contentW,this.videoHeight=this.contentH,this.videoCapture.size(this.videoWidth,this.videoHeight)}},{key:"resizeByMouse",value:function(){h(p(i.prototype),"resizeByMouse",this).call(this),this.ready||(this.h<this.mh&&(this.h=this.mh),this.w<this.mw&&(this.w=this.mw)),this.setVideoCaptureSize(),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding}},{key:"endFullScreen",value:function(){h(p(i.prototype),"endFullScreen",this).call(this),this.setVideoCaptureSize(),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!0}},{key:"enterFullScreen",value:function(){h(p(i.prototype),"enterFullScreen",this).call(this),this.setVideoCaptureSize(),this.isFullScreen?this.flipButton.yy=this.p5.height-10-22-this.mlx.mlxPadding:this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.doCreateVideoCapture()}},{key:"enterMaximize",value:function(){h(p(i.prototype),"enterMaximize",this).call(this),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!1}},{key:"exitMaximize",value:function(){h(p(i.prototype),"exitMaximize",this).call(this),this.isMaximize=!1,this.maxMenu.value=!1,this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!0}},{key:"captureScreen",value:function(){this.captureCountdown=2999,this.captureBeepCountdown=0,this.doCaptureScreen=!0}},{key:"switchCamera",value:function(t){this.cameraMode=t,0==t?(this.face="user",this.constraints={audio:!1,video:{facingMode:this.face}},this.flip=!0):(this.face="environment",this.constraints={audio:!1,video:{facingMode:{exact:this.face}}},this.flip=!1),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(this.constraints.video.aspectRatio=16/9),this.doCreateVideoCapture()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),this.maxMenu=e.addCheckedMenu("Maximize",this.isMaximize,(function(e,i){t.hideMenu(),t.isMaximize=i,t.isMaximize?t.enterMaximize():t.exitMaximize()})),this.autoMaxMenu=e.addCheckedMenu("Auto Maximize",this.autoMaximize,(function(e,i){t.hideMenu(),t.autoMaximize=i})),e.addSeparator(),e.addCommand("Capture Canvas",(function(e){t.hideMenu(),t.captureScreen()})),e.addSeparator(),this.flipMenu=e.addCheckedMenu("Flip",this.flip,(function(e,i){t.hideMenu(),t.flip=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"remove",value:function(){this.videoCapture&&(this.videoCapture.stop(),this.isVideoCaptureReady&&this.videoCapture.remove(),this.videoCapture=null),this.peer.destroy(),h(p(i.prototype),"remove",this).call(this)}},{key:"doProcess",value:function(){return this.div.style("display","none"),this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0,!0}},{key:"doDraw",value:function(t){this.backgroundImage&&t.image(this.backgroundImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH),this.replaceImage?t.image(this.replaceImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH):t.image(this.videoCapture,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH)}},{key:"draw",value:function(t){if(h(p(i.prototype),"draw",this).call(this,t),this.ready&&(this.noDraw||(t.push(),this.flip&&(t.translate(2*(this.x+this.contentX)+this.contentW,0),t.scale(-1,1)),this.doDraw(t),t.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(t,this.extraDraw),this.doCaptureScreen))if(this.captureCountdown-=t.deltaTime,this.captureCountdown>0)this.captureBeepCountdown-=t.deltaTime,this.captureBeepCountdown<0&&(null!=this.beepSound&&this.beepSound.isLoaded()&&this.beepSound.play(),this.captureBeepCountdown=1e3),t.push(),t.fill(255),t.textSize(40),t.text(t.floor(this.captureCountdown/1e3)+1,this.x+this.contentX+this.contentW-50,this.y+this.contentY,50,50),t.pop();else{null!=this.shutterSound&&this.shutterSound.isLoaded()&&this.shutterSound.play(),t.push(),t.resetMatrix(),t.translate(0,0),t.scale(1);var e=t.createGraphics(t.width,t.height);this.noDraw||(e.push(),this.flip&&(e.translate(2*(this.x+this.contentX)+this.contentW,0),e.scale(-1,1)),this.doDraw(e),e.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(e,this.extraDraw),e.get(this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH).save("myVideoCanvas.jpg"),t.pop(),this.doCaptureScreen=!1}}},{key:"mousePressed",value:function(){h(p(i.prototype),"mousePressed",this).call(this),3==this.p5.touches.length&&this.exitMaximize()}}]),i}(g);t.exports={mlxRTCVideo:x}},8896:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput),m=(p.mlxElementLocakableOutput,p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,!0),d=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="Scaventure Hunt",n.category="Output",n.type="ScaventureHunt",n.inType="results",n.outType="results",n.needMouse=!0,n.lastSpeakeWord,n.gameMode="INTRO",n.timeShowFound=4e3,n.welcomeSound=!1,n.canvas,n.drawCanvas,n.imageFromDrawCanvas,n.currentWord,n.currentGuess,n.currentIndex=0,n.isPlaying=!1,n.words=["shoe","book","keyboard","shirt","pants","cup","clock"],n.myVoice=new p5.Speech,n.isModelReady=!1,n.previousResultWord=null,n.timeLeft=6e4,n.sound_blip,n.font,n.canvas_w=407,n.canvas_h=151,n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.w=n.canvas_w+2*n.mlx.mlxPadding,n.h=n.canvas_h+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=10,n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w,n.canvas_h),n.canvas=n.offScreen.offScreen,n.speakObject=!1,n.preload(),n.setup(),n.createElementMenu(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.myVoice.cancel(),t.mlx.removeElement(t)}))}},{key:"preload",value:function(){this.img_1=this.p5.loadImage("assets_game/mlxScaventureHunt/simg1.png"),this.img_2=this.p5.loadImage("assets_game/mlxScaventureHunt/simg2.png"),this.img_3=this.p5.loadImage("assets_game/mlxScaventureHunt/simg3.png"),this.img_4=this.p5.loadImage("assets_game/mlxScaventureHunt/simg4.png"),this.img_5=this.p5.loadImage("assets_game/mlxScaventureHunt/simg5.png"),this.sound_blip=this.p5.loadSound("assets_game/mlxScaventureHunt/Blip.mp3"),this.sound_start=this.p5.loadSound("assets_game/mlxScaventureHunt/start.mp3"),this.font=this.p5.loadFont("assets_game/mlxScaventureHunt/JSJindara-Bold.otf")}},{key:"setup",value:function(){this.precanvas.textFont(this.font),this.myVoice.setVoice(1),this.myVoice.onEnd=this.speechEnded}},{key:"resetGame",value:function(){this.clearCanvas(),this.currentIndex=0,this.gameMode="INTRO",this.timeShowFound=4e3,this.timeLeft=6e4}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),"INTRO"==this.gameMode)this.precanvas.image(this.img_1,0,0,this.canvas_w,this.canvas_h),this.welcomeSound||(this.welcomeSound=!0,this.myVoice.speak("Welcome, Press Start to begin!! "));else if("FINDING"==this.gameMode)this.precanvas.push(),this.precanvas.image(this.img_2,0,0,this.canvas_w,this.canvas_h),this.setTextSizeStrokeWeight(30,0,2),this.precanvas.fill(255),this.precanvas.textAlign(this.p5.LEFT,this.p5.CENTER),this.precanvas.text(this.currentWord,231,8,173,33),this.setTextSizeStrokeWeight(45,0,2),this.precanvas.textAlign(this.p5.CENTER,this.p5.CENTER),this.precanvas.fill(255,234,0),this.setTextSizeStrokeWeight(26,0,2),this.precanvas.text(this.currentGuess,24,97,280,46),this.precanvas.pop();else if("FOUND"==this.gameMode){this.speakObject=!1,this.precanvas.push();var e=this.img_3;this.currentIndex==this.words.length&&(e=this.img_5),this.precanvas.image(e,0,0,this.canvas_w,this.canvas_h),this.timeShowFound-=this.p5.deltaTime,this.timeShowFound<=0&&(this.currentIndex!=this.words.length?(this.gameMode="FINDING",this.timeShowFound=4e3,this.playNextWord(),this.currentIndex++,this.timeLeft=6e4,this.clearCanvas()):this.resetGame())}else"OVER"==this.gameMode&&(this.precanvas.push(),this.precanvas.image(this.img_4,0,0,this.canvas_w,this.canvas_h),this.timeShowFound-=this.p5.deltaTime,this.timeShowFound<=0&&this.resetGame());this.canvas.push(),this.canvas.image(this.precanvas,0,0),this.canvas.pop()}},{key:"mousePressed",value:function(){"INTRO"==this.gameMode&&(this.sound_blip.play(),this.gameMode="FINDING",this.playNextWord(),this.currentIndex++)}},{key:"clearCanvas",value:function(){}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.precanvas.textSize(t),this.precanvas.stroke(e),this.precanvas.strokeWeight(i)}},{key:"playNextWord",value:function(){this.isPlaying=!0,this.currentWord=this.words[this.currentIndex]}},{key:"doProcess",value:function(){if(this.results=this.inElement.output,void 0!=this.results){this.result=this.results[0].label;for(var t=this.result.split(",")[0],e=this.results.map((function(t){return t.label})),i=!1,s=0;s<e.length;s++)if(e[s]==this.currentWord){i=!0;break}if(i&&"FINDING"==this.gameMode)this.isPlaying=!1,this.currentIndex==this.words.length?(this.currentGuess="Congratulations. You won.",this.sound_start.play(),this.myVoice.cancel(),this.myVoice.speak("Congratulations. You won.")):(this.currentGuess="Oh I know. it's "+this.currentWord,this.myVoice.cancel(),this.myVoice.speak("Oh I know. it's ".concat(this.currentWord,"!"))),this.gameMode="FOUND";else if("FINDING"==this.gameMode&&(null==this.previousResultWord||this.previousResultWord!=t))if(0==this.speakObject)this.speakObject=!0,this.currentGuess="Please  find "+this.currentWord,m&&(this.myVoice.speak("Please  find ".concat(this.currentWord)),this.lastSpeakeWord=this.currentGuess);else{if(null==t)return;this.currentGuess="I see "+t,m&&this.lastSpeakeWord!=this.currentGuess&&(this.myVoice.speak("I see ".concat(t)),this.lastSpeakeWord=this.currentGuess)}return this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}}},{key:"speechEnded",value:function(){m=!0}}]),i}(c);t.exports={mlxScaventureHunt:d}},41911:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=i(46120),c=(p.mlxElement,p.mlxElementInput,p.mlxElementModel,p.mlxElementOutput,p.mlxElementLocakableOutput),m=(p.mlxLabel,p.mlxOscillator,p.mlxConsoleLog,p.mlxSpeech,p.mlxAudioInput,p.mlxFFTSpectrum,p.mlxTextInput,function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).title="SortingFactory",n.category="Output",n.type="SortingFactoryGame",n.inType="posenet",n.outType="results",n.needMouse=!1,n.score=0,n.canvasSize=854,n.canvas_w=854,n.canvas_h=560,n.fullscreen=!1,n.fullscreen_scale=1,n.w=n.canvas_w/2+2*n.mlx.mlxPadding,n.h=n.canvas_h/2+n.mlx.mlxCaptionHeight+2*n.mlx.mlxPadding,n.fps=15,n.createElementMenu(),n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvas_w/2,n.canvas_h/2),n.canvas=n.offScreen.offScreen,n.precanvas=n.p5.createGraphics(n.canvas_w,n.canvas_h),n.poseNet,n.poses=[],n.skeletons=[],n.posNose=[],n.posLeftWrist=[],n.posRightWrist=[],n.posLeftElbow=[],n.posRightElbow=[],n.prevLeftElbowPos=null,n.prevRightElbowPos=null,n.gameMode="SETUP",n.gameLevel,n.MIN_L_ANGLE,n.MIN_R_ANGLE,n.MAX_L_ANGLE,n.MAX_R_ANGLE,n.SPEED=62,n.INITIAL_RELEASE_TIME=6e3,n.RELESEBOX_CONDITION_1=1600,n.RELESEBOX_CONDITION_2=2600,n.RELESEBOX_CONDITION_3=3700,n.HP=5,n.SCORE=0,n.ALLOWED_CALIBRATE_MOVING_PIXEL=40,n.BOX_WH=54,n.img_logo,n.img_marker_red,n.img_marker,n.img_mask,n.img_step1,n.img_step2,n.img_building_left,n.img_building_right,n.img_heart,n.img_box_blue,n.img_box_red,n.img_box_yellow,n.img_right,n.img_wrong,n.img_heart,n.img_heart_empty,n.ui_calibrate,n.ui_game,n.boxes=[],n.font,n.sound_beep,n.sound_changepoint,n.sound_ok,n.sound_falldown,n.sound_correct,n.sound_movebridge,n.sound_wrong,n.sound_over,n.sound_start,n.sound_yes,n.sound_no,n.preload(),n.setup(),n.output=n.canvas,n.ready=!0,n}return n(i,[{key:"preload",value:function(){this.img_logo=this.p5.loadImage("assets_game/mlxSortingFactory/logo.png"),this.img_marker_red=this.p5.loadImage("assets_game/mlxSortingFactory/p_marker_red.png"),this.img_marker=this.p5.loadImage("assets_game/mlxSortingFactory/p_marker_black.png"),this.img_mask=this.p5.loadImage("assets_game/mlxSortingFactory/mask.png"),this.img_step1=this.p5.loadImage("assets_game/mlxSortingFactory/step2.png"),this.img_step2=this.p5.loadImage("assets_game/mlxSortingFactory/step3.png"),this.img_building_left=this.p5.loadImage("assets_game/mlxSortingFactory/factory_left.png"),this.img_building_right=this.p5.loadImage("assets_game/mlxSortingFactory/factory_right.png"),this.img_heart=this.p5.loadImage("assets_game/mlxSortingFactory/heart.png"),this.img_box_blue=this.p5.loadImage("assets_game/mlxSortingFactory/box_blue.png"),this.img_box_red=this.p5.loadImage("assets_game/mlxSortingFactory/box_red.png"),this.img_box_yellow=this.p5.loadImage("assets_game/mlxSortingFactory/box_yellow.png"),this.img_right=this.p5.loadImage("assets_game/mlxSortingFactory/box_right.png"),this.img_wrong=this.p5.loadImage("assets_game/mlxSortingFactory/box_wrong.png"),this.img_heart=this.p5.loadImage("assets_game/mlxSortingFactory/heart.png"),this.img_heart_empty=this.p5.loadImage("assets_game/mlxSortingFactory/heart_empty.png"),this.img_waiting=this.p5.loadImage("assets_game/mlxSortingFactory/waittoconnect.png"),this.font=this.p5.loadFont("assets_game/mlxSortingFactory/Anakotmai-Bold.ttf"),this.sound_beep=this.p5.loadSound("assets_game/mlxSortingFactory/beep.mp3"),this.sound_changepoint=this.p5.loadSound("assets_game/mlxSortingFactory/beep.mp3"),this.sound_ok=this.p5.loadSound("assets_game/mlxSortingFactory/ok.mp3"),this.sound_falldown=this.p5.loadSound("assets_game/mlxSortingFactory/falldown.mp3"),this.sound_correct=this.p5.loadSound("assets_game/mlxSortingFactory/correct.mp3"),this.sound_movebridge=this.p5.loadSound("assets_game/mlxSortingFactory/movebridge.mp3"),this.sound_wrong=this.p5.loadSound("assets_game/mlxSortingFactory/wrong.mp3"),this.sound_over=this.p5.loadSound("assets_game/mlxSortingFactory/gameover.mp3"),this.sound_start=this.p5.loadSound("assets_game/mlxSortingFactory/start.mp3"),this.sound_yes=this.p5.loadSound("assets_game/mlxSortingFactory/yes.mp3"),this.sound_no=this.p5.loadSound("assets_game/mlxSortingFactory/no.mp3")}},{key:"setup",value:function(){this.ui_calibrate=new v(this),this.ui_game=new g(this),this.precanvas.textFont(this.font)}},{key:"doProcess",value:function(){return this.poses=this.inElement.output,this.getKeypoints(),this.busy=!1,this.outputIsReady=!0,this.output=this.inElement.output,this.inElement.outputIsReady=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){this.lockCanvasToThisElement||r(l(i.prototype),"draw",this).call(this,t),null!=this.inElement&&null!=this.inElement.inElement&&null!=this.inElement.inElement.videoCapture?(this.gameConnected||(this.ui_calibrate.calibrateStep="step1",this.gameMode="SETUP",this.gameConnected=!0),this.precanvas.push(),this.inElement.inElement.flip&&(this.precanvas.scale(-1,1),this.precanvas.translate(0-this.canvas_w,0)),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.inElement.inElement.videoCapture,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop(),"SETUP"==this.gameMode?this.ui_calibrate.draw():this.ui_game.draw()):(this.precanvas.push(),this.precanvas.imageMode(this.p5.CORNER),this.precanvas.image(this.img_waiting,0,0,this.canvas_w,this.canvas_h),this.precanvas.pop(),this.gameConnected=!1),this.canvas.push(),this.fullscreen?this.canvas.scale(this.fullscreen_scale):this.canvas.scale(.5),this.canvas.image(this.precanvas,0,0),this.canvas.pop(),this.adjustThisElementToLockCanvas()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),e.addCommand("Focus",(function(e){t.hideMenu(),t.mlx.hideNavBar(),window.dispatchEvent(new Event("resize")),t.mlx.focusedElement=t,t.lockCanvasToThisElement=!0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"endFullScreen",value:function(){r(l(i.prototype),"endFullScreen",this).call(this),this.canvas.resizeCanvas(this.canvas_w,this.canvas_h),this.fullscreen=!1}},{key:"enterFullScreen",value:function(){r(l(i.prototype),"enterFullScreen",this).call(this),this.fullscreen=!0,this.fullscreen_scale=this.contentW/this.canvas_w;var t=(this.h-110)/this.canvas_h;this.fullscreen_scale>t&&(this.fullscreen_scale=t),this.canvas.resizeCanvas(this.canvas_w*this.fullscreen_scale,this.canvas_h*this.fullscreen_scale)}},{key:"degree",value:function(t,e){var i=this.p5.degrees(this.p5.atan2(e.y-t.y,e.x-t.x));return i<0&&(i+=360),i<270&&(i+=360),i}},{key:"distance",value:function(t,e){return this.p5.sqrt(this.p5.pow(e.x-t.x,2)+this.p5.pow(e.y-t.y,2))}},{key:"checkRaiseHand",value:function(){return null!=this.posRightElbow[0]&&null!=this.posLeftElbow[0]&&null!=this.posNose[0]&&null!=this.prevRightElbowPos&&null!=this.prevRightElbowPos&&(this.degree(this.posNose[0],this.posRightElbow[0])>=300&&this.degree(this.posNose[0],this.posRightElbow[0])<=380&&this.degree(this.posNose[0],this.posLeftElbow[0])<=600&&this.degree(this.posNose[0],this.posLeftElbow[0])>=520&&this.distance(this.posLeftElbow[0],this.prevLeftElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL&&this.distance(this.posRightElbow[0],this.prevRightElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL)}},{key:"checkLowerHand",value:function(){return null!=this.posLeftWrist[0]&&null!=this.posRightWrist[0]&&null!=this.posRightElbow[0]&&null!=this.posLeftElbow[0]&&null!=this.posNose[0]&&null!=this.prevRightElbowPos&&null!=this.prevRightElbowPos&&(this.posNose[0].y<=this.posLeftWrist[0].y&&this.posNose[0].y<=this.posRightWrist[0].y&&this.posLeftWrist[0].y<this.posLeftElbow[0].y&&this.posRightWrist[0].y<this.posRightElbow[0].y&&this.distance(this.posLeftElbow[0],this.prevLeftElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL&&this.distance(this.posRightElbow[0],this.prevRightElbowPos)<=this.ALLOWED_CALIBRATE_MOVING_PIXEL)}},{key:"getKeypoints",value:function(){if(null!=this.poses)for(var t=0,e=0,i=0,s=0,n=0,a=0;a<this.poses.length;a++){if(null==this.poses[a].pose)return;var r=this.poses[a].pose.keypoints,o=r[0];if(o.score>.1&&t<o.score){var h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posNose[0]=this.p5.createVector(h,o.position.y),t=o.score}if((o=r[7]).score>.1&&e<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posLeftElbow[0]=this.p5.createVector(h,o.position.y),e=o.score}if((o=r[8]).score>.1&&i<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posRightElbow[0]=this.p5.createVector(h,o.position.y),i=o.score}if((o=r[10]).score>.1&&n<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posRightWrist[0]=this.p5.createVector(h,o.position.y),n=o.score}if((o=r[9]).score>.1&&s<o.score){h=o.position.x;this.inElement.inElement.flip&&(h=this.inElement.inElement.videoWidth-o.position.x),this.posLeftWrist[0]=this.p5.createVector(h,o.position.y),s=o.score}}}}]),i}(c)),d=function(){"use strict";function t(e,i,n){s(this,t),this.parent=n,this.xPos=[232,633],this.yPos=[190,326,460],this.originPlatform=e,this.targetPlatform=i,this.imageList=[this.parent.img_box_yellow,this.parent.img_box_red,this.parent.img_box_blue],this.myImage=this.imageList[this.targetPlatform],this.x=0,this.y=0,this.onBridge=!1,this.onTarget=!1,this.drop=!1,this.bridgeWidth=this.xPos[1]-this.xPos[0],this.checked=!1,this.correct=0,this.delete=!1}return n(t,[{key:"draw",value:function(){this.delete||(this.x+=this.parent.p5.floor(this.parent.SPEED*(this.parent.p5.deltaTime/1e3)),this.x>this.parent.canvas_w+this.parent.BOX_WH/2&&(this.delete=!0),this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),1==this.correct?this.myImage=this.parent.img_right:2==this.correct&&(this.myImage=this.parent.img_wrong),this.drop||(this.x<this.xPos[0]?(this.parent.precanvas.translate(this.x,this.yPos[this.originPlatform]),this.parent.precanvas.image(this.myImage,-this.parent.BOX_WH/2,-this.parent.BOX_WH,this.parent.BOX_WH,this.parent.BOX_WH)):this.x>=this.xPos[0]&&!this.onBridge&&!this.onTarget?this.parent.ui_game.selectedPointL==this.originPlatform?(this.onBridge=!0,this.parent.precanvas.translate(this.x,this.calculateHeight()),this.parent.precanvas.image(this.myImage,-this.parent.BOX_WH/2,-this.parent.BOX_WH,this.parent.BOX_WH,this.parent.BOX_WH)):(this.drop=!0,this.parent.sound_falldown.play(),this.y=this.yPos[this.originPlatform],this.parent.HP--,this.parent.HP<=0&&(this.parent.gameMode="OVER",this.parent.sound_over.play())):this.x>=this.xPos[0]&&this.onBridge&&!this.onTarget?(this.parent.precanvas.translate(this.x,this.calculateHeight()),this.parent.precanvas.image(this.myImage,-this.parent.BOX_WH/2,-this.parent.BOX_WH,this.parent.BOX_WH,this.parent.BOX_WH),this.x>=this.xPos[1]&&(this.onTarget=!0,this.originPlatform=this.parent.ui_game.selectedPointR)):(this.parent.precanvas.translate(this.x,this.yPos[this.originPlatform]),this.parent.precanvas.image(this.myImage,-this.parent.BOX_WH/2,-this.parent.BOX_WH,this.parent.BOX_WH,this.parent.BOX_WH),!this.checked&&this.x<this.parent.canvas_w-70&&this.targetPlatform==this.originPlatform?(this.correct=1,this.parent.sound_correct.play(),this.parent.SCORE++,this.checked=!0):!this.checked&&this.x<this.parent.canvas_w-70&&this.targetPlatform!=this.originPlatform&&(this.parent.sound_wrong.play(),this.correct=2,this.parent.HP--,this.parentHP<=0&&(this.parent.gameMode="OVER",this.parent.sound_over.play()),this.checked=!0))),this.drop&&(this.parent.precanvas.translate(this.x,this.y),this.y+=.02*this.y,this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.myImage,-this.parent.BOX_WH/2,-this.parent.BOX_WH,this.parent.BOX_WH,this.parent.BOX_WH),this.y>this.parent.canvas_h+this.parent.BOX_WH/2&&(this.delete=!0)),this.parent.precanvas.pop())}},{key:"calculateHeight",value:function(){var t=(this.x-this.xPos[0])/this.bridgeWidth;return this.yPos[this.parent.ui_game.selectedPointL]+t*(this.yPos[this.parent.ui_game.selectedPointR]-this.yPos[this.parent.ui_game.selectedPointL])}}]),t}(),g=function(){"use strict";function t(e){s(this,t),this.parent=e,this.leftPos=[this.parent.p5.createVector(232,190),this.parent.p5.createVector(232,326),this.parent.p5.createVector(232,460)],this.rightPos=[this.parent.p5.createVector(633,190),this.parent.p5.createVector(633,326),this.parent.p5.createVector(633,460)],this.previousPointL=2,this.previousPointR=2,this.alpha_2=0,this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.degreeL=null,this.degreeR=null,this.nextBox=new d(this.parent.p5.random([0,1,2]),this.parent.p5.random([0,1,2]),this.parent),this.releasebox=this.parent.INITIAL_RELEASE_TIME}return n(t,[{key:"draw",value:function(){this.getCurrentAngle(),this.calculateCurrentSelectedPoint(),this.drawBackground(),this.parent.precanvas.push(),this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.LEFT,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(40,0,5),this.parent.precanvas.text("SCORE: "+this.parent.SCORE,20,30);for(var t=0;t<5;t++)this.parent.precanvas.imageMode(this.parent.p5.CENTER),t<this.parent.HP?this.parent.precanvas.image(this.parent.img_heart,this.parent.canvas_w-30-54*t,28):this.parent.precanvas.image(this.parent.img_heart_empty,this.parent.canvas_w-30-54*t,28);if(this.parent.precanvas.pop(),this.parent.precanvas.push(),this.parent.precanvas.stroke(156,129,76),this.parent.precanvas.strokeWeight(12),this.parent.precanvas.line(this.leftPos[this.selectedPointL].x,this.leftPos[this.selectedPointL].y,this.rightPos[this.selectedPointR].x,this.rightPos[this.selectedPointR].y),this.parent.precanvas.pop(),this.drawMarkerPoint(),"INTRO"==this.parent.gameMode)this.drawIntro();else if("PLAY"==this.parent.gameMode){if(this.parent.SCORE<15?this.parent.SPEED=65:this.parent.SCORE<35?this.parent.SPEED=90:this.parent.SCORE<50?this.parent.SPEED=100:this.parent.SCORE<70&&(this.parent.SPEED=115),this.releasebox-=this.parent.p5.deltaTime,this.releasebox<0)if(0==this.parent.boxes.length)this.releasebox=this.parent.INITIAL_RELEASE_TIME,this.parent.boxes[this.parent.boxes.length]=this.nextBox,this.nextBox=new d(this.parent.p5.random([0,1,2]),this.parent.p5.random([0,1,2]),this.parent);else{var e=this.parent.p5.random([0,1,2]);if(1==e)this.releasebox=this.parent.RELESEBOX_CONDITION_1-(this.parent.SPEED-65)/50*850,this.parent.boxes[this.parent.boxes.length]=this.nextBox,this.nextBox=new d(this.parent.boxes[this.parent.boxes.length-1].originPlatform,this.parent.boxes[this.parent.boxes.length-1].targetPlatform,this.parent);else if(2==e){this.releasebox=this.parent.RELESEBOX_CONDITION_2-(this.parent.SPEED-65)/50*1200,this.parent.boxes[this.parent.boxes.length]=this.nextBox;for(var i=this.parent.p5.random([0,1,2]),s=this.parent.p5.random([0,1,2]);this.parent.boxes[this.parent.boxes.length-1].originPlatform==s;)i=this.parent.p5.random([0,1,2]),s=this.parent.p5.random([0,1,2]);this.nextBox=new d(s,this.parent.p5.random([0,1,2]),this.parent)}else{this.releasebox=this.parent.RELESEBOX_CONDITION_3-(this.parent.SPEED-65)/50*1500,this.parent.boxes[this.parent.boxes.length]=this.nextBox;for(i=this.parent.p5.random([0,1,2]),s=this.parent.p5.random([0,1,2]);this.parent.boxes[this.parent.boxes.length-1].originPlatform==s||this.parent.boxes[this.parent.boxes.length-1].targetPlatform==i;)i=this.parent.p5.random([0,1,2]),s=this.parent.p5.random([0,1,2]);this.nextBox=new d(s,i,this.parent)}}for(t=0;t<this.parent.boxes.length;t++)this.parent.boxes[t].draw()}else"OVER"==this.parent.gameMode&&this.drawOver()}},{key:"initialRangeCalculate",value:function(){var t=this.parent.MAX_L_ANGLE-this.parent.MIN_L_ANGLE,e=this.parent.MAX_R_ANGLE-this.parent.MIN_R_ANGLE;this.upperL=.8*t+this.parent.MIN_L_ANGLE,this.lowerL=.35*t+this.parent.MIN_L_ANGLE,this.upperR=this.parent.MAX_R_ANGLE-.8*e,this.lowerR=this.parent.MAX_R_ANGLE-.35*e}},{key:"calculateCurrentSelectedPoint",value:function(){this.selectedPointL=1,this.degreeL>this.upperL?this.selectedPointL=0:this.degreeL<this.lowerL&&(this.selectedPointL=2),this.selectedPointR=1,this.degreeR<this.upperR?this.selectedPointR=0:this.degreeR>this.lowerR&&(this.selectedPointR=2),this.previousPointL!=this.selectedPointL&&this.parent.sound_movebridge.play(),this.previousPointR!=this.selectedPointR&&this.parent.sound_movebridge.play(),this.previousPointL=this.selectedPointL,this.previousPointR=this.selectedPointR}},{key:"getCurrentAngle",value:function(){null==this.degreeL&&(this.degreeL=this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),null==this.degreeR&&(this.degreeR=this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.degreeL=(this.degreeL+this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0]))/2,this.degreeR=(this.degreeR+this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0]))/2}},{key:"drawBackground",value:function(){this.parent.precanvas.push(),this.parent.precanvas.fill(0,200),this.parent.precanvas.rect(0,0,this.parent.canvas_w,this.parent.precanvas.canvas_h),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_building_left,0,43,231,516),this.parent.precanvas.image(this.parent.img_building_right,630,43,223,516),this.parent.precanvas.pop()}},{key:"drawMarkerPoint",value:function(){for(var t=0;t<3;t++)this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),t==this.selectedPointL?this.parent.precanvas.image(this.parent.img_marker_red,this.leftPos[t].x,this.leftPos[t].y):this.parent.precanvas.image(this.parent.img_marker,this.leftPos[t].x,this.leftPos[t].y),t==this.selectedPointR?this.parent.precanvas.image(this.parent.img_marker_red,this.rightPos[t].x,this.rightPos[t].y):this.parent.precanvas.image(this.parent.img_marker,this.rightPos[t].x,this.rightPos[t].y),this.parent.precanvas.pop()}},{key:"drawIntro",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_logo,0,0,this.parent.canvas_w,this.parent.canvas_h),this.parent.precanvas.pop(),this.parent.precanvas.push(),this.alpha_2+=this.parent.p5.deltaTime/50%50,this.parent.precanvas.fill(255,170,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_2))),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(35,0,5),this.parent.precanvas.text("raise both hands to start !!",this.parent.canvas_w/2,this.parent.canvas_h-70),this.parent.precanvas.pop(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.beepSoundTime-=this.parent.p5.deltaTime,this.checkingCountDown<=2001&&(this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.canvas_w,this.parent.vanvas_h),this.parent.precanvas.push(),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(100,0,5),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.parent.p5.floor(this.checkingCountDown/1e3)+1,this.parent.canvas_w/2,this.parent.canvas_h/2),this.parent.precanvas.pop(),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.parent.gameMode="PLAY",this.parent.sound_start.play())):(this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])}},{key:"drawOver",value:function(){this.parent.precanvas.push(),this.alpha_2+=this.parent.p5.deltaTime/50%20,this.parent.precanvas.fill(255,170,0,255*this.parent.p5.abs(this.parent.p5.sin(this.parent.p5.TWO_PI/50*this.alpha_2))),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(35,0,5),this.parent.precanvas.text("raise both hands to restart!!",this.parent.canvas_w/2,this.parent.canvas_h-70),this.parent.precanvas.pop(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.beepSoundTime-=this.parent.p5.deltaTime,this.checkingCountDown<=2001&&(this.parent.precanvas.push(),this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.canvas_w,this.parent.canvas_h),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(100,0,5),this.parent.precanvas.fill(255),this.parent.precanvas.text(this.parent.p5.floor(this.checkingCountDown/1e3)+1,this.parent.canvas_w/2,this.parent.canvas_h/2),this.parent.precanvas.pop(),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.checkingCountDown<0&&(this.checkingCountDown=3e3,this.parent.sound_yes.play(),this.parent.HP=5,this.parent.SCORE=0,this.parent.boxes=[],this.releasebox=this.parent.INITIAL_RELEASE_TIME,this.beepSoundTime=1e3,this.parent.gameMode="PLAY",this.parent.sound_start.play())):(this.parent.precanvas.push(),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.parent.precanvas.fill(255,234,0),this.setTextSizeStrokeWeight(50,0,5),this.parent.precanvas.text("GAME OVER",this.parent.canvas_w/2,this.parent.canvas_h/2),this.parent.precanvas.pop(),this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}(),v=function(){"use strict";function t(e){s(this,t),this.parent=e,this.calibrateStep="step1",this.checkingCountDown=3e3,this.beepSoundTime=1e3}return n(t,[{key:"draw",value:function(){this.parent.precanvas.push(),"SETUP"==this.parent.gameMode&&(this.parent.precanvas.push(),this.drawSetupText(),this.parent.precanvas.pop()),this.parent.precanvas.pop()}},{key:"drawSetupText",value:function(){this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CORNER),this.parent.precanvas.image(this.parent.img_mask,0,0,this.parent.canvas_w,this.parent.canvas_h),this.parent.precanvas.fill(255),this.parent.precanvas.rect(20,this.parent.canvas_h-120,this.parent.canvas_w-40,100,15),"step1"==this.calibrateStep?(this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(35,0,5),this.checkingCountDown>=2001?this.parent.precanvas.text("stand 2 meter away and raise both hands",this.parent.canvas_w/2,this.parent.canvas_h-70):(this.parent.precanvas.text("Stay Still("+(this.parent.p5.int(this.checkingCountDown/1e3)+1)+" s.)",this.parent.canvas_w/2,this.parent.canvas_h-70),this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.canvas_w,this.parent.canvas_h),this.beepSoundTime-=this.parent.p5.deltaTime,this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.parent.precanvas.image(this.parent.img_step1,20,this.parent.canvas_h-120-231,263,231),this.ratio_w=this.parent.canvas_w/this.parent.inElement.inElement.videoWidth,this.ratio_h=this.parent.canvas_h/this.parent.inElement.inElement.videoHeight,this.drawElbowMarker(),this.drawNoseMarker(),this.parent.checkRaiseHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.parent.MAX_L_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.parent.MIN_R_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0])),this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.calibrateStep="step2")):(this.checkingCountDown=3e3,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])):"step2"==this.calibrateStep&&(this.parent.precanvas.fill(255,170,0),this.parent.precanvas.textAlign(this.parent.p5.CENTER,this.parent.p5.CENTER),this.setTextSizeStrokeWeight(35,0,5),this.checkingCountDown>=2001?this.parent.precanvas.text("lower both elbows",this.parent.canvas_w/2,this.parent.canvas_h-70):(this.parent.precanvas.text("Stay Still("+(this.parent.p5.int(this.checkingCountDown/1e3)+1)+" s.)",this.parent.canvas_w/2,this.parent.canvas_h-70),this.beepSoundTime-=this.parent.p5.deltaTime,this.parent.precanvas.fill(3,143,0,60),this.parent.precanvas.rect(0,0,this.parent.canvas_w,this.parent.canvas_h),this.beepSoundTime<=0&&(this.beepSoundTime+=1e3,this.parent.sound_beep.play())),this.parent.precanvas.image(this.parent.img_step2,20,this.parent.canvas_h-120-225,228,225),this.ratio_w=this.parent.canvas_w/this.parent.inElement.inElement.videoWidth,this.ratio_h=this.parent.canvas_h/this.parent.inElement.inElement.videoHeight,this.drawElbowMarker(),this.drawWristMarker(),this.parent.checkLowerHand()?(this.checkingCountDown-=this.parent.p5.deltaTime,this.checkingCountDown<0&&(this.parent.sound_yes.play(),this.parent.MIN_L_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posLeftElbow[0])),this.parent.MAX_R_ANGLE=this.parent.p5.int(this.parent.degree(this.parent.posNose[0],this.parent.posRightElbow[0])),this.parent.HP=5,this.parent.SCORE=0,this.parent.boxes=[],this.releasebox=this.parent.INITIAL_RELEASE_TIME,this.checkingCountDown=3e3,this.beepSoundTime=1e3,this.parent.gameMode="INTRO",this.parent.ui_game.initialRangeCalculate())):(this.checkingCountDown,this.parent.prevLeftElbowPos=this.parent.posLeftElbow[0],this.parent.prevRightElbowPos=this.parent.posRightElbow[0])),this.parent.precanvas.pop()}},{key:"drawElbowMarker",value:function(){null!=this.parent.posLeftElbow[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posLeftElbow[0].x*this.ratio_w,this.parent.posLeftElbow[0].y*this.ratio_h),this.parent.precanvas.pop()),null!=this.parent.posRightElbow[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posRightElbow[0].x*this.ratio_w,this.parent.posRightElbow[0].y*this.ratio_h),this.parent.precanvas.pop())}},{key:"drawWristMarker",value:function(){null!=this.parent.posLeftWrist[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posLeftWrist[0].x*this.ratio_w,this.parent.posLeftWrist[0].y*this.ratio_h),this.parent.precanvas.pop()),null!=this.parent.posRightWrist[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posRightWrist[0].x*this.ratio_w,this.parent.posRightWrist[0].y*this.ratio_h),this.parent.precanvas.pop())}},{key:"drawNoseMarker",value:function(){null!=this.parent.posNose[0]&&(this.parent.precanvas.push(),this.parent.precanvas.imageMode(this.parent.p5.CENTER),this.parent.precanvas.image(this.parent.img_marker_red,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h),this.parent.precanvas.stroke(255,0,0),this.parent.precanvas.strokeWeight(10),null!=this.parent.posLeftElbow[0]&&this.parent.precanvas.line(this.parent.posLeftElbow[0].x*this.ratio_w,this.parent.posLeftElbow[0].y*this.ratio_h,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h),null!=this.parent.posRightElbow[0]&&this.parent.precanvas.line(this.parent.posRightElbow[0].x*this.ratio_w,this.parent.posRightElbow[0].y*this.ratio_h,this.parent.posNose[0].x*this.ratio_w,this.parent.posNose[0].y*this.ratio_h),this.parent.precanvas.pop())}},{key:"setTextSizeStrokeWeight",value:function(t,e,i){this.parent.precanvas.textSize(t),this.parent.precanvas.stroke(e),this.parent.precanvas.strokeWeight(i)}}]),t}();t.exports={mlxSortingFactory:m}},95592:function(t,e,i){var s=i(2553),n=i(62012),a=i(50450),r=i(18770),o=i(9807),h=i(27690),l=i(99828);function u(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var p=function(t){"use strict";o(i,t);var e=u(i);function i(t){var n;return s(this,i),(n=e.call(this,t)).category="Output",n.type="FFT",n.title="Sound Viz",n.inType="audio",n.outType="image",n.counter=0,n.startFrame=0,n.needMouse=!0,n.w=200+2*n.mlx.mlxPadding,n.levelLen=120,n.h=700,n.contentX=n.mlx.mlxPadding,n.contentY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.text="",n.createElementMenu(),n.label=n.mlx.createLabel(a(n),"Loading...",18,n.mlx.mlxCaptionHeight+5,n.w-20,24),n.fft=new p5.FFT(.8,512),window.fft=n.fft,n.canvasSize=200,n.offScreenX=n.mlx.mlxPadding,n.offScreenY=n.mlx.mlxCaptionHeight+n.mlx.mlxPadding,n.offScreen=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY,n.canvasSize,n.canvasSize),n.canvas=n.offScreen.offScreen,window.mycanvas=n.canvas,n.canvas2=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY+0+10,n.canvasSize,n.canvasSize),n.canvas2.hidden=!0,n.canvas3=n.mlx.createCanvas(a(n),n.offScreenX,n.offScreenY+200+200+0+10+10,n.canvasSize,n.canvasSize),n.canvas.strokeWeight(10),n.canvas.stroke(0),n.canvas.frameRate(60),n.startFunc=function(){console.log("START!"),console.log(new Date),n.loopSound=!0,n.prevLevels=new Array(n.levelLen),n.startFrame=n.p5.frameCount,n.startFlag=!0,n.frameElapse=0},n.startButton=n.mlx.createButton(a(n),"Start",(function(){n.startFunc()}),n.w-60-n.mlx.mlxPadding,n.h-28,60,22),n.sendButton=n.mlx.createButton(a(n),"Loop",(function(){n.loopSound=!0}),n.w-60-n.mlx.mlxPadding-60,n.h-28,60,22),n.sendButton.hidden=!0,n.startButton.hidden=!0,n.startFlag=!1,n.startButton.border=!0,n.label.setText("FFT ready."),n.ready=!0,n.busy=!1,n.outputIsReady=!1,n.startFunc(),n}return n(i,[{key:"createElementMenu",value:function(){var t=this;this._createMenu().addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.inElement&&"audio"==this.inElement.outType&&(this.amplitude=this.inElement.output,console.log("do process"),this.busy=!0),this.busy=!1,this.inElement&&(this.inElement.outputIsReady=!1),this.alreadyRunInLoop=!0,!0}},{key:"update",value:function(){r(l(i.prototype),"update",this).call(this)}},{key:"draw",value:function(t){if(r(l(i.prototype),"draw",this).call(this,t),this.inElement&&"audio"==this.inElement.outType&&this.ready){var e=this.x+this.contentX,s=this.y+this.contentY;this.frameElapse=this.p5.frameCount-this.startFrame,this.amplitude&&(this.prevLevels.push(this.amplitude.getLevel()),this.counter++);var n=this;!function(t,i){t.beginShape(),t.noFill(),t.stroke(20);for(var a=0;a<i.length;a++){var r=t.map(e+a,e,e+i.length,e+n.w-2*n.mlx.mlxPadding,e),o=200/1.5+s+t.map(i[a],0,1,250,0);t.vertex(r,o)}t.endShape()}(t,this.prevLevels),function(t,e){if(n.startFlag){console.log("internal",n.frameElapse);var i=new Array(e.length);i[n.frameElapse]=100,t.noStroke(),t.rectMode(t.CENTER),t.background(230),n.canvas2.offScreen.noStroke(),n.canvas2.offScreen.rectMode(n.canvas2.offScreen.CENTER),n.canvas2.offScreen.background(230);for(var s=t.width/(10*e.length),a=0;a<e.length;a++){var r=t.map(a,e.length,0,0,t.width),o=t.map(a,e.length,0,t.width,0),h=t.map(e[a],0,1,0,t.height);t.fill(255,0,0),t.rect(o,t.height/2,s,i[a]),t.fill(0),t.rect(r,t.height/2,s,h),n.canvas2.offScreen.fill(255,0,0),n.canvas2.offScreen.fill(0),n.canvas2.offScreen.rect(r,t.height/2,s,h)}}}(this.canvas,this.prevLevels),this.prevLevels.splice(0,1),this.startFlag&&n.frameElapse>0&&n.frameElapse%this.levelLen==0&&(this.loopSound?(this.startFunc(),this.startFlag=!0):this.startFlag=!1,this.endFrame=n.p5.frameCount,this.frameElapse=0,this.startFrame=n.p5.frameCount,console.log(new Date),console.log(n.frameElapse),console.log("FRAME COUNT!"),n.canvas3.offScreen.reset(),n.canvas3.offScreen.rectMode(this.p5.CENTER),this.canvas3.offScreen.image(this.canvas2.offScreen,0,0,this.canvas.width,this.canvas.height),this.outputIsReady=!0,this.output=this.canvas3.offScreen)}}}]),i}(i(46120).mlxElementOutput);t.exports={mlxElementSoundViz:p}},79226:function(t,e,i){var s,n,a=i(18770),r=i(50450),o=i(9807),h=i(27690),l=i(99828),u=i(2553),p=i(62012);function c(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=l(t);if(e){var n=l(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return h(this,i)}}var m=function(){"use strict";function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;u(this,t),this.xx=i,this.yy=n,this.w=a,this.h=r,this.children=[],this.p5=s,this.hidden=!1,this.alwaysOnTop=!1,this.text=null,this.highlight=!1,this.colorBackground=this.p5.color(240),this.setParent(e)}return p(t,[{key:"setText",value:function(t){this.text=t}},{key:"update",value:function(){this.parent?(this.x=this.parent.x+this.xx,this.y=this.parent.y+this.yy):(this.x=this.xx,this.y=this.yy)}},{key:"isHitElement",value:function(t,e){return t>this.x&&t<this.x+this.w&&e>this.y&&e<this.y+this.h}},{key:"_update",value:function(){this.update(),this._updateChildren()}},{key:"_updateChildren",value:function(){for(var t in this.children){this.children[t]._update()}}},{key:"_draw",value:function(t){this.hidden||(this.draw(t),this._drawChildren(t))}},{key:"draw",value:function(t){}},{key:"_drawChildren",value:function(t){for(var e in this.children){this.children[e]._draw(t)}}},{key:"_clearParent",value:function(){if(this.parent){var t=this.parent.children.indexOf(this);t>=0&&this.parent.children.splice(t,1),this.parent=null}}},{key:"setParent",value:function(t){if(this.parent){if(this.parent==t)return;this._clearParent()}this.parent=t,this.parent&&(this.parent.children.push(this),this.p5=this.parent.p5)}},{key:"remove",value:function(){this.parent}},{key:"mouseMoved",value:function(){for(var t in this.isHitElement(n.mouseX,n.mouseY)?this.highlight=!0:this.highlight=!1,this.children){var e=this.children[t];0==e.hidden&&e.mouseMoved()}}},{key:"mousePressed",value:function(){if(this.isHitElement(n.mouseX,n.mouseY))for(var t in this.children){var e=this.children[t];if(!e.hidden&&e.isHitElement(n.mouseX,n.mouseY)&&!e.mousePressed())return!1}return!0}},{key:"mouseDragged",value:function(){return!0}},{key:"mouseReleased",value:function(){return!0}}]),t}(),d=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r){return u(this,i),e.call(this,t,s,n,a,r)}return p(i,[{key:"draw",value:function(t){this.p5.fill(255),this.p5.stroke(0),this.p5.strokeWeight(1),this.p5.rect(this.x,this.y,this.w,this.h)}}]),i}(m),g=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h,l,p){var c;return u(this,i),(c=e.call(this,t,o,h,l,p)).callback=s,c.value=n,c.min=a,c.max=r,c.decimal=0,c}return p(i,[{key:"draw",value:function(t){this.p5.fill(128),this.p5.stroke(128),this.p5.strokeWeight(2);var e=(this.h-14)/2;this.p5.line(this.x+e,this.y+e,this.x+this.w-e,this.y+e),this.p5.strokeWeight(1),this.drawKnob(t)}},{key:"drawKnob",value:function(t){var e=(this.h-14)/2,i=this.p5.map(this.value,this.min,this.max,this.x+e,this.x+this.w-e);this.p5.stroke(0),this.p5.ellipse(i,this.y+e,this.h-14,this.h-14),this.p5.noStroke(),this.p5.fill(64),this.p5.textAlign(this.p5.CENTER,this.p5.TOP),this.p5.text("".concat(this.value.toFixed(this.decimal)),i,this.y+this.h-14)}},{key:"mousePressed",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){var t=this.h/2;return this.value=this.p5.map(n.mouseX,this.x+t,this.x+this.w-t,this.min,this.max),this.max-this.min>1&&(this.value=this.p5.floor(this.value)),this.value=this.p5.constrain(this.value,this.min,this.max),this.callback&&this.callback(this.value),!1}return!0}},{key:"mouseDragged",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){var t=this.h/2;this.value=this.p5.map(n.mouseX,this.x+t,this.x+this.w-t,this.min,this.max),this.max-this.min>1&&(this.value=this.p5.floor(this.value)),this.value=this.p5.constrain(this.value,this.min,this.max),this.callback&&this.callback(this.value)}}}]),i}(m),v=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h,l,p){var c;return u(this,i),(c=e.call(this,t,o,h,l,p)).callback=s,c.value=n,c.min=a,c.max=r,c}return p(i,[{key:"draw",value:function(t){this.p5.fill(128),this.p5.stroke(128),this.p5.strokeWeight(2);var e=this.w/2;this.p5.line(this.x+e,this.y+e,this.x+e,this.y+this.h-e),this.p5.strokeWeight(1),this.drawKnob(t)}},{key:"drawKnob",value:function(t){var e=this.w/2,i=this.p5.map(this.value,this.min,this.max,this.y+this.h-e,this.y+e);this.p5.stroke(0),this.p5.ellipse(this.x+e,i,this.w,this.w),this.p5.noStroke(),this.p5.fill(64),this.p5.textAlign(this.p5.LEFT,this.p5.CENTER),this.p5.text("".concat(this.value.toFixed(2)),this.x+this.w+10,i-4)}},{key:"mousePressed",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){var t=this.w/2;return this.value=this.p5.map(n.mouseY,this.y+this.h-t,this.y+t,this.min,this.max),this.max-this.min>1&&(this.value=this.p5.floor(this.value)),this.value=this.p5.constrain(this.value,this.min,this.max),this.callback&&this.callback(this.value),!1}return!0}},{key:"mouseDragged",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){var t=this.w/2;this.value=this.p5.map(n.mouseY,this.y+this.h-t,this.y+t,this.min,this.max),this.max-this.min>1&&(this.value=this.p5.floor(this.value)),this.value=this.p5.constrain(this.value,this.min,this.max),this.callback&&this.callback(this.value)}}}]),i}(m),f=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h,l){var p;return u(this,i),(p=e.call(this,t,r,o,h,l)).callback=a,null==n&&(n="text"),p.input=p.p5.createInput(s,n),p.input.size(h),p.setText(s),p}return p(i,[{key:"getText",value:function(){return this.input.value()}},{key:"setText",value:function(t){this.input.value(t)}},{key:"draw",value:function(t){var e=this.x,i=this.y;e=e+this.parent.mlx.userTranslateX+this.parent.mlx.userScaleX/this.parent.mlx.userScale-this.parent.mlx.userScaleX,i=i+this.parent.mlx.userTranslateY+this.parent.mlx.userScaleY/this.parent.mlx.userScale-this.parent.mlx.userScaleY,this.input.position(e,i)}}]),i}(m),x=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h){var l;u(this,i),(l=e.call(this,t,a,r,o,h)).callback=n,l.radio=l.p5.createRadio();for(var p=0;p<s.length;p++)l.radio.option(p,s[p]);return l.radio.style("width",o+"px"),l.radio.style("height",h+"px"),l.radio.position(a,r),l.radio.selected("0"),l}return p(i,[{key:"getValue",value:function(){return this.radio.value()}},{key:"setValue",value:function(t){this.radio.selected(t)}},{key:"draw",value:function(t){var e=this.x,i=this.y;e=e+this.parent.mlx.userTranslateX+this.parent.mlx.userScaleX/this.parent.mlx.userScale-this.parent.mlx.userScaleX,i=i+this.parent.mlx.userTranslateY+this.parent.mlx.userScaleY/this.parent.mlx.userScale-this.parent.mlx.userScaleY,this.radio.position(e,i)}}]),i}(m),y=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h){var l;u(this,i),(l=e.call(this,t,a,r,o,h)).callback=n,l.select=l.p5.createSelect();for(var p=0;p<s.length;p++)l.select.option(s[p],p);return l.select.style("width",o+"px"),l.select.style("height",h+"px"),l.select.position(a,r),l.select.selected("0"),l}return p(i,[{key:"getValue",value:function(){return this.select.value()}},{key:"setValue",value:function(t){this.select.selected(t)}},{key:"draw",value:function(t){var e=this.x,i=this.y;e=e+this.parent.mlx.userTranslateX+this.parent.mlx.userScaleX/this.parent.mlx.userScale-this.parent.mlx.userScaleX,i=i+this.parent.mlx.userTranslateY+this.parent.mlx.userScaleY/this.parent.mlx.userScale-this.parent.mlx.userScaleY,this.select.position(e,i)}}]),i}(m),E=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h){var l;return u(this,i),(l=e.call(this,t,a,r,o,h)).setText(s),l.callback=n,l.border=!1,l}return p(i,[{key:"draw",value:function(){this.p5.noStroke();this.highlight&&(this.p5.fill(192,192,192),this.p5.rect(this.x,this.y,this.w,this.h)),this.border?(this.p5.fill(210),this.p5.stroke(192),this.p5.rect(this.x+2,this.y+2,this.w-4,this.h-4,10,10,10,10),this.p5.fill(0),this.p5.textSize(14),this.p5.textAlign(this.p5.CENTER,this.p5.TOP),this.p5.text(this.text,this.x+this.w/2,this.y+5)):(this.p5.fill(0),this.p5.textSize(14),this.p5.textAlign(this.p5.LEFT,this.p5.TOP),this.p5.text(this.text,this.x+20,this.y+5))}},{key:"mousePressed",value:function(){return!this.isHitElement(n.mouseX,n.mouseY)||(this.callback&&this.callback(this),!1)}}]),i}(m),_=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,a,o,h,l,p,c){var m;return u(this,i),(m=e.call(this,t,s,(function(t){m.dropdownMenu.hidden=!1,n.popup.push(m.dropdownMenu)}),h,l,p,c)).callback2=o,m.alwaysOnTop=!0,m.list=a,m.dropdownMenu=new T(t,h,l+c),m.dropdownMenu.hidden=!0,m.dropdownMenu.w=m.w,m.dropdownMenu._adjustChildrenWidth(),m.dropdownMenu.addSelectMenu(a,0,(function(t,e){if(n.hidePopup(m.dropdownMenu),m.callback2){var i=parseInt(e);m.text=m.list[i],m.callback2(r(m),m.text)}})),m.dropdownMenu.alwaysOnTop=!0,m}return p(i,[{key:"hideDropdownMenu",value:function(){this.dropdownMenu.hidden=!0}},{key:"draw",value:function(){this.p5.noStroke(),this.highlight&&(this.p5.fill(192,192,192),this.p5.rect(this.x,this.y,this.w,this.h)),this.p5.image(n.imgDropdown,this.x+this.w-10,this.y+5,10,10),this.p5.fill(0),this.p5.textSize(14),this.p5.textAlign(this.p5.RIGHT,this.p5.TOP),this.p5.text(this.text,this.x+this.w-20,this.y)}}]),i}(E),w=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,o,h){var l;return u(this,i),(l=e.call(this,t,s,null,n,a,o,h)).subMenu=new T(r(l),l.x,l.y),l.subMenu.hidden=!0,l}return p(i,[{key:"draw",value:function(){a(l(i.prototype),"draw",this).call(this),this.p5.image(n.imgPlay,this.x+this.w-12,this.y+6,10,10)}},{key:"mousePressed",value:function(){if(this.subMenu){if(this.subMenu.x+this.subMenu.w>this.p5.width-10){var t=this.parent;t.xx=this.p5.width-(t.w+this.subMenu.w)-10}this.subMenu.xx=this.w+1,this.subMenu.yy=0,this.y+this.subMenu.h>this.p5.height-50&&(this.subMenu.yy=this.p5.height-(this.y+this.subMenu.h)-50),this.subMenu.hidden=!1,n.popup.push(this.subMenu)}return!0}}]),i}(E),S=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o,h,l){var p;return u(this,i),(p=e.call(this,t,s,n,r,o,h,l)).value=a,p.showBox=!1,p}return p(i,[{key:"draw",value:function(){a(l(i.prototype),"draw",this).call(this),this.value?this.showBox?this.p5.image(n.imgCheckedBox,this.x+4,this.y+6,10,10):this.p5.image(n.imgChecked,this.x+4,this.y+6,10,10):this.showBox&&this.p5.image(n.imgUncheckedBox,this.x+4,this.y+6,10,10)}},{key:"mousePressed",value:function(){return!this.isHitElement(n.mouseX,n.mouseY)||(this.value=!this.value,this.highlight=!1,this.callback&&this.callback(this,this.value),!1)}}]),i}(E),k=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,a,o,h,l){var p;for(var c in u(this,i),(p=e.call(this,t,h,l,0,0)).value=o,p.callback=a,p.list=s,p.selectList=[],s){var m,d=s[c],g=null===(m=n.myFont)||void 0===m?void 0:m.textBounds(d,0,0,14);g.w+50>p.w&&(p.w=g.w+50);var v=new S(r(p),d,(function(t,e){for(var i in p.value=-1,p.children){var s=p.children[i];s==t&&(p.value=i),s.value=!1}t.value=!0,p.callback&&p.callback(r(p),p.value)}),c==o,0,p.h-1,g.w+50,24);p.selectList.push(v),p.h+=24}return p._adjustChildrenWidth(),p}return p(i,[{key:"setValue",value:function(t){for(var e in this.value=t,this.children){var i=this.children[e];i.value=e==t}}},{key:"setTitle",value:function(t,e){t>=0&&t<this.selectList.length&&(this.selectList[t].text=e)}},{key:"_adjustChildrenWidth",value:function(){for(var t in this.children){var e=this.children[t];if(e.w<this.w-2&&(e.w=this.w-2),e.selectList)for(var i in e.selectList){var s=e.selectList[i];s.w<this.w-2&&(s.w=this.w-2)}}}}]),i}(m),b=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r){return u(this,i),e.call(this,t,s,n,a,r)}return p(i,[{key:"draw",value:function(){this.p5.stroke(0),this.p5.line(this.x,this.y+this.h/2,this.x+this.w,this.y+this.h/2)}}]),i}(m),C=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r){return u(this,i),e.call(this,t,s,n,a,r)}return p(i,[{key:"draw",value:function(){this.p5.stroke(0)}}]),i}(m),T=function(t){"use strict";o(i,t);var e=c(i);function i(t){var s,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return u(this,i),(s=e.call(this,t,n,a,100,2)).menuList=[],s.gap=[],s}return p(i,[{key:"addCommand",value:function(t,e){var i=n.myFont.textBounds(t,0,0,14);i.w+52>this.w&&(this.w=i.w+52);var s=new E(this,t,e,1,this.h-1,i.w+50,24);return this.h+=24,this._adjustChildrenWidth(),s}},{key:"addSubmenu",value:function(t){var e=n.myFont.textBounds(t,0,0,14);e.w+72>this.w&&(this.w=e.w+72);var i=new w(this,t,1,this.h-1,e.w+50,24);return this.h+=24,this._adjustChildrenWidth(),i}},{key:"addCheckedMenu",value:function(t,e,i){var s=n.myFont.textBounds(t,0,0,14);s.w+50>this.w&&(this.w=s.w+52);var a=new S(this,t,i,e,1,this.h-1,s.w+50,24);return this.h+=24,this._adjustChildrenWidth(),a}},{key:"addSelectMenu",value:function(t,e,i){var s=new k(this,t,i,e,1,this.h-1);return this.h+=s.h,this.w<s.w+2&&(this.w=s.w+2),this._adjustChildrenWidth(),s}},{key:"addSeparator",value:function(){var t=new b(this,1,this.h-1,this.w,6);return this.h+=6,this._adjustChildrenWidth(),t}},{key:"addGapSeparator",value:function(){this.gap.push(this.h);var t=new C(this,1,this.h,this.w,6);return this.h+=7,this._adjustChildrenWidth(),t}},{key:"_adjustChildrenWidth",value:function(){for(var t in this.children){var e=this.children[t];if(e.w<this.w-2&&(e.w=this.w-2),e.selectList)for(var i in e.selectList){var s=e.selectList[i];s.w<this.w-2&&(s.w=this.w-2)}}}},{key:"draw",value:function(t){if(this.p5.fill(255),this.p5.stroke(0),this.p5.strokeWeight(1),0==this.gap.length)this.p5.rect(this.x,this.y,this.w,this.h);else{var e=this.y;for(var i in this.gap){var s=this.gap[i]-(e-this.y);this.p5.rect(this.x,e,this.w,s),e=e+s+6}this.p5.rect(this.x,e-1,this.w,this.y+this.h-e+1)}this.p5.fill(0),this.p5.noStroke()}}]),i}(m),I=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o){var h;return u(this,i),void 0==o&&(o=20),(h=e.call(this,t,n,a,r,o)).fontSize=14,h.label=h.p5.createGraphics(h.w,h.h),h.text=s,h.setText(s),h}return p(i,[{key:"setFontSize",value:function(t){this.fontSize=t}},{key:"resize",value:function(t,e){this.w=t,this.h=e,this.label=this.p5.createGraphics(this.w,this.h),this.setText(this.text)}},{key:"setText",value:function(t){this.text=t,this.label.background(this.colorBackground),this.label.fill(0),this.label.noStroke(),this.label.textSize(this.fontSize),this.label.textAlign(this.p5.LEFT,this.p5.CENTER),this.label.text(this.text,0,this.h/2)}},{key:"draw",value:function(t){this.p5.image(this.label,this.x,this.y)}}]),i}(m),M=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r,o){var h;return u(this,i),void 0==o&&(o=20),(h=e.call(this,t,n,a,r,o)).img=h.p5.loadImage(s),h}return p(i,[{key:"draw",value:function(t){this.p5.image(this.img,this.x,this.y,this.w,this.h)}}]),i}(m),R=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r){var o;return u(this,i),(o=e.call(this,t,s,n,a,r)).offScreen=o.p5.createGraphics(o.w,o.h),o.offScreen.background(255),o}return p(i,[{key:"draw",value:function(t){this.p5.image(this.offScreen,this.x,this.y)}},{key:"remove",value:function(){this.offScreen.remove()}}]),i}(m),P=function(t){"use strict";o(i,t);var e=c(i);function i(t,s,n,a,r){var o;return u(this,i),o=e.call(this,t,s,n,a,r),console.log("graph"),o.graphData=null,o.initOffScreen(),o.day0=0,o.draggingDay0=!1,o.country0=0,o.leftGap=16,o.leftPanelWidth=146,o.rightPanelWidth=80,o.expoNum=7,o.maxY=[[2e6,1e5],[15e5,1e5],[12e5,1e5],[1e6,1e5],[8e5,1e4],[5e5,1e4],[3e5,2e4],[28e4,2e4],[24e4,2e4],[22e4,1e4],[2e5,1e4],[15e4,1e4],[12e4,1e4],[1e5,1e4],[8e4,1e4],[5e4,1e4],[3e4,5e3],[1e4,1e3],[8e3,1e3],[5e3,1e3],[3e3,500],[1500,100],[1e3,100],[800,100],[500,100],[300,50],[200,10],[100,10]],o.currentYScale=0,o.dataType=0,o.graphType=1,o.graphMode=0,o.plotType=0,o.isShow=[],o.dateRangeStart=-1,o.dateRangeEnd=-1,o.linearRegression=!1,o.movingStartRange=!1,o.movingEndRange=!1,o.maxDate=0,o}return p(i,[{key:"setGraphMode",value:function(t){this.graphMode=t,1==this.graphMode&&(this.graphType=0),this.drawGraph()}},{key:"showAll",value:function(){for(var t=0;t<this.isShow.length;t++)this.isShow[t]=!0;this.drawGraph()}},{key:"clearAll",value:function(){for(var t=0;t<this.isShow.length;t++)this.isShow[t]=!1;this.drawGraph()}},{key:"resize",value:function(t,e){this.w=t,this.h=e,this.offScreen=this.p5.createGraphics(this.w,this.h),this.initOffScreen(),this.graphData={}}},{key:"initOffScreen",value:function(){this.offScreen.background(255),this.offScreen.fill(240),this.offScreen.noStroke(),this.offScreen.rect(0,0,130,this.offScreen.height)}},{key:"getY",value:function(t){return 1==this.graphType?Math.log10(t)*((this.offScreen.height-50)/this.expoNum):t/this.maxY[this.currentYScale][0]*(this.offScreen.height-50)}},{key:"setData",value:function(t){if(this.graphData=t,this.isShow.length!=this.graphData.length)for(var e in this.isShow=[],this.graphData)e<2?this.isShow.push(!0):this.isShow.push(!1);if(-1==this.dateRangeStart){for(var i in this.dateRangeStart=0,this.maxDate=0,this.graphData){var s=this.graphData[i];s[1][0].length>this.maxDate&&(this.maxDate=s[1][0].length)}this.dateRangeEnd=this.maxDate-1}this.drawGraph()}},{key:"numberWithCommas",value:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{key:"setMaxDate",value:function(t){this.maxDate=t}},{key:"polygon",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.offScreen.TWO_PI/s,r=this.offScreen.radians(n);this.offScreen.beginShape();for(var o=r;o<this.offScreen.TWO_PI+r;o+=a){var h=t+this.offScreen.cos(o)*i,l=e+this.offScreen.sin(o)*i;this.offScreen.vertex(h,l)}this.offScreen.endShape(this.offScreen.CLOSE)}},{key:"setDataType",value:function(t){this.dataType=t,this.drawGraph()}},{key:"setGraphType",value:function(t){this.graphType=t,this.drawGraph()}},{key:"setPlotType",value:function(t){this.plotType=t,2==this.plotType&&(this.graphType=0),this.drawGraph()}},{key:"setLinearRegression",value:function(t){this.linearRegression=t,this.drawGraph()}},{key:"HSBtoRGB",value:function(t,e,i,s){var n,a,r,o,h,l,u,p;switch(void 0===s&&(s=1),t=this.clamp(t,0,1),e=this.clamp(e,0,1),i=this.clamp(i,0,1),1===arguments.length&&(e=t.s,i=t.v,t=t.h),l=i*(1-e),u=i*(1-(h=6*t-(o=Math.floor(6*t)))*e),p=i*(1-(1-h)*e),o%6){case 0:n=i,a=p,r=l;break;case 1:n=u,a=i,r=l;break;case 2:n=l,a=i,r=p;break;case 3:n=l,a=u,r=i;break;case 4:n=p,a=l,r=i;break;case 5:n=i,a=l,r=u}return{r:Math.round(255*n),g:Math.round(255*a),b:Math.round(255*r),a:255*s/1,mode:this.p5.RGB}}},{key:"RGBtoHSB",value:function(t,e,i,s){void 0===s&&(s=1),1===arguments.length&&(e=t.g,i=t.b,t=t.r);var n,a=Math.max(t,e,i),r=Math.min(t,e,i),o=a-r,h=0===a?0:o/a,l=a/255;switch(a){case r:n=0;break;case t:n=e-i+o*(e<i?6:0),n/=6*o;break;case e:n=i-t+2*o,n/=6*o;break;case i:n=t-e+4*o,n/=6*o}return{h:n,s:h,v:l,a:1*s/255,mode:this.p5.HSB}}},{key:"drawGraph",value:function(){if(null!=this.graphData&&0!=this.graphData.length){this.offScreen.background(255),this.offScreen.noStroke(),this.offScreen.fill(240),this.offScreen.rect(0,0,130,this.offScreen.height),this.offScreen.textAlign(this.p5.LEFT,this.p5.CENTER);for(var t=0;t<this.graphData.length;t++)if(t>=this.country0){var e=this.isShow[t],i=this.graphData[t][2],s=this.graphData[t][0];this.offScreen.strokeWeight(1),this.offScreen.fill(i);var n=14*(t-this.country0)+10;e&&this.offScreen.ellipse(10,n,5,5),this.offScreen.noStroke(),this.offScreen.textAlign(this.p5.LEFT,this.p5.CENTER),this.offScreen.text(s,15,n)}if(this.offScreen.fill(255),this.offScreen.rect(this.leftPanelWidth-this.leftGap,0,this.offScreen.width-this.leftPanelWidth+this.leftGap,this.offScreen.height),0==this.graphType){this.currentYScale=this.maxY.length-1;for(var a=0;a<this.graphData.length;a++){var r=this.isShow[a],o=(this.graphData[a][2],this.graphData[a][0],this.graphData[a][1][this.dataType]),h=0;if(0==this.graphMode)h=o[o.length-1];else if(1==this.graphMode)for(var l=1;l<this.graphData[a][1][this.dataType].length;l++){var u=this.graphData[a][1][this.dataType][l-1],p=this.graphData[a][1][this.dataType][l];p-u>h&&(h=p-u)}if(r)for(;h>this.maxY[this.currentYScale][0];)if(this.currentYScale--,this.currentYScale<0){this.currentYScale=0;break}}}this.offScreen.stroke(1);var c=(this.offScreen.width-(this.leftPanelWidth+this.rightPanelWidth))/this.maxDate,m=this.offScreen.height-50,d=this.leftPanelWidth;if(this.offScreen.stroke(192),this.offScreen.line(d,this.h-50,this.offScreen.width,this.h-50),1==this.graphType)for(var g=10;g<=1e7;g*=10){var v=this.getY(g);this.offScreen.stroke(192),this.offScreen.line(d,this.h-50-v,this.offScreen.width,this.h-50-v),this.offScreen.noStroke(),this.offScreen.fill(192),this.offScreen.textAlign(this.p5.LEFT,this.p5.TOP),this.offScreen.text(this.numberWithCommas(g),132,this.h-50-v+1)}else for(var f=this.maxY[this.currentYScale][1];f<=this.maxY[this.currentYScale][0];f+=this.maxY[this.currentYScale][1]){var x=this.getY(f);this.offScreen.stroke(192),this.offScreen.line(d,this.h-50-x,this.offScreen.width,this.h-50-x),this.offScreen.noStroke(),this.offScreen.fill(192),this.offScreen.textAlign(this.p5.LEFT,this.p5.TOP),this.offScreen.text(this.numberWithCommas(f),132,this.h-50-x+1)}this.offScreen.fill(64),this.offScreen.stroke(192),this.offScreen.textAlign(this.p5.CENTER,this.p5.TOP);for(var y=0;y<this.maxDate;y++){if(this.offScreen.stroke(192),this.offScreen.line(d,this.h-50,d,this.h-45),y%7==4){var E=new Date("January 22, 2020");this.offScreen.noStroke(),E.setDate(E.getDate()+y),0==this.day0?this.offScreen.text("".concat(E.getDate(),"/").concat(E.getMonth()+1),d,this.h-40):this.offScreen.text("d".concat(y),d,this.h-40)}d+=c}this.offScreen.textAlign(this.p5.LEFT,this.p5.TOP),0!=this.day0?this.offScreen.text("Total ".concat(this.graphData.length-4," countries. Day 0 when ").concat(Math.floor(this.day0)," confirmed cases."),135,this.h-20):this.offScreen.text("Total ".concat(this.graphData.length-4," countries. Start date: January 22, 2020"),135,this.h-20);var _=this.getY(this.day0);0==this.day0&&(_=0),this.offScreen.fill(255,0,0),this.offScreen.stroke(0),this.polygon(125,m-_,8,3,0),this.offScreen.fill(0,0,255),this.polygon(this.leftPanelWidth+this.dateRangeStart*c,m,8,3,270),this.polygon(this.leftPanelWidth+this.dateRangeEnd*c,m,8,3,270),this.offScreen.textAlign(this.p5.LEFT,this.p5.CENTER);for(var w=0;w<this.graphData.length;w++){var S=this.isShow[w],k=this.graphData[w][2],b=this.graphData[w][0];if(this.offScreen.stroke(k),0==this.plotType?this.offScreen.strokeWeight(2):this.offScreen.strokeWeight(1),d=this.leftPanelWidth,S){var C=[],T=[],I=0,M=0,R=0,P=0;if(0==this.graphMode){for(var L=1;L<this.graphData[w][1][this.dataType].length;L++){var N=this.getY(this.graphData[w][1][this.dataType][L-1]),D=this.getY(this.graphData[w][1][this.dataType][L]),W=this.getY(this.graphData[w][1][1][L]),B=this.getY(this.graphData[w][1][2][L]);if(0==this.day0||this.graphData[w][1][this.dataType][L]>this.day0){if(0==this.plotType)this.offScreen.stroke(k),this.offScreen.line(d,m-N,d+c,m-D);else if(1==this.plotType)this.offScreen.stroke(k),this.offScreen.line(d,m-N,d+c,m-D),this.offScreen.ellipse(d+c,m-D,5,5),1==L&&this.offScreen.ellipse(d,m-N,5,5);else{this.offScreen.stroke(0),this.offScreen.fill(k),this.offScreen.rect(d+c-3,m-D,6,D);this.p5.color(k.r+32,255,255);this.offScreen.fill(255),this.offScreen.rect(d+c-3,m-B-W,6,B),this.offScreen.fill(32),this.offScreen.rect(d+c-3,m-W,6,W)}d+=c}L>=this.dateRangeStart&&L<=this.dateRangeEnd&&(1==L&&0==this.dateRangeStart&&(C.push(L-1),I+=L-1,T.push(N),M+=N),C.push(L),I+=L,T.push(D),M+=D)}this.offScreen.noStroke(),this.offScreen.strokeWeight(3),this.offScreen.fill(k),this.offScreen.text(b,d+5,m-this.getY(this.graphData[w][1][this.dataType][this.graphData[w][1][this.dataType].length-1]))}else if(1==this.graphMode&&this.graphData[w][1][this.dataType].length>2){d+=c;for(var A=2;A<this.graphData[w][1][this.dataType].length;A++){var H=this.getY(this.graphData[w][1][this.dataType][A-2]),O=this.getY(this.graphData[w][1][this.dataType][A-1]),z=this.getY(this.graphData[w][1][this.dataType][A]);(0==this.day0||this.graphData[w][1][this.dataType][A]>this.day0)&&(0==this.plotType?this.offScreen.line(d,m-(O-H),d+c,m-(z-O)):1==this.plotType?(this.offScreen.line(d,m-(O-H),d+c,m-(z-O)),this.offScreen.ellipse(d+c,m-(z-O),5,5),2==A&&this.offScreen.ellipse(d,m-(O-H),5,5)):(this.offScreen.stroke(0),this.offScreen.fill(k),this.offScreen.rect(d+c-3,m-O,6,O)),d+=c),A>=this.dateRangeStart&&A<=this.dateRangeEnd&&(2==A&&this.dateRangeStart<2&&(C.push(A-1),I+=A-1,T.push(O-H),M+=O-H),C.push(A),I+=A,T.push(z-O),M+=z-O)}this.offScreen.noStroke(),this.offScreen.fill(k);var F=this.graphData[w][1][this.dataType][this.graphData[w][1][this.dataType].length-1]-this.graphData[w][1][this.dataType][this.graphData[w][1][this.dataType].length-2];this.offScreen.text(b,d+5,m-this.getY(F))}if(this.linearRegression){I/=C.length,M/=T.length;var V=0,X=0;for(var Y in C)V+=(C[Y]-I)*(T[Y]-M),X+=(C[Y]-I)*(C[Y]-I);P=M-(R=V/X)*I,this.offScreen.stroke(k),this.offScreen.strokeWeight(1),d=this.leftPanelWidth;var G=0,Z=this.maxDate+this.rightPanelWidth/c,U=R*G+P,j=R*Z+P;this.offScreen.line(d+G*c,m-U,d+Z*c,m-j),this.offScreen.strokeWeight(5),U=R*(G=this.dateRangeStart)+P,j=R*(Z=this.dateRangeEnd)+P,this.offScreen.line(d+G*c,m-U,d+Z*c,m-j)}}}}}},{key:"mousePressed",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){if(n.mouseX-this.x<120){var t=Math.floor((n.mouseY-this.y-5)/14+this.country0);if(t>=0&&t<this.graphData.length){this.graphData[t][0];this.isShow[t]=!this.isShow[t],this.drawGraph()}}else if(n.mouseX-this.x<this.leftPanelWidth){this.draggingDay0=!0;var e=this.y+this.h-50-n.mouseY;this.day0=e<=0?0:Math.floor(Math.pow(10,e/((this.offScreen.height-50)/this.expoNum))),this.drawGraph()}if(this.graphData){var i=this.y+this.offScreen.height-50,s=this.x+this.leftPanelWidth,a=(this.offScreen.width-(this.leftPanelWidth+this.rightPanelWidth))/this.maxDate;if(n.mouseY>=i-8&&n.mouseY<=i+8){var r=s+this.dateRangeStart*a,o=s+this.dateRangeEnd*a;n.mouseX>=r-8&&n.mouseX<=r+8&&(console.log("Move start range"),this.movingStartRange=!0),n.mouseX>=o-8&&n.mouseX<=o+8&&(console.log("Move end range"),this.movingEndRange=!0)}}}}},{key:"mouseDragged",value:function(){if(this.isHitElement(n.mouseX,n.mouseY)){if(n.mouseX-this.x<100);else if(n.mouseX-this.x<140&&this.draggingDay0){var t=this.y+this.h-50-n.mouseY;this.day0=t<=0?0:Math.pow(10,t/((this.offScreen.height-50)/this.expoNum)),this.drawGraph()}if(this.movingStartRange){console.log("Moving start range");var e=this.x+this.leftPanelWidth,i=(this.offScreen.width-(this.leftPanelWidth+this.rightPanelWidth))/this.maxDate,s=Math.round((n.mouseX-e)/i);s<0&&(s=0),s>=this.graphData[0][1][0].length&&(s=this.graphData[0][1][0].length-1),s>=this.dateRangeEnd&&(s=this.dateRangeEnd-1),this.dateRangeStart=s,this.drawGraph()}if(this.movingEndRange){console.log("Moving end range");var a=this.x+this.leftPanelWidth,r=(this.offScreen.width-(this.leftPanelWidth+this.rightPanelWidth))/this.maxDate,o=Math.round((n.mouseX-a)/r);o<0&&(o=0),o>=this.maxDate&&(o=this.maxDate-1),o<=this.dateRangeStart&&(o=this.dateRangeStart+1),this.dateRangeEnd=o,this.drawGraph()}}}},{key:"mouseReleased",value:function(){this.draggingDay0&&(this.draggingDay0=!1),this.movingStartRange&&(console.log("End start range"),this.movingStartRange=!1),this.movingEndRange&&(console.log("End end range"),this.movingEndRange=!1)}},{key:"mouseWheel",value:function(t){this.graphData&&(this.country0+=t.delta,this.country0<0?this.country0=0:this.country0>this.graphData.length-this.offScreen.height/14+1&&(this.country0=this.graphData.length-this.offScreen.height/14+1),this.drawGraph())}},{key:"draw",value:function(t){this.p5.image(this.offScreen,this.x,this.y)}}]),i}(R);t.exports={mlxUI_Init:function(t,e){s=e,n=t,console.log(">",n,t)},mlxUI:m,uiFrame:d,uiHorizontalSlider:g,uiVerticalSlider:v,uiTextInput:f,uiRadioBox:x,uiSelect:y,uiCommand:E,uiDropdown:_,uiSubMenu:w,uiCheckedMenu:S,uiSelectMenu:k,uiSeparator:b,uiGapSeparator:C,uiMenu:T,uiLabel:I,uiImage:M,uiCanvas:R,uiGraph:P}},77945:function(t,e,i){var s=i(809),n=i(38561),a=i(2553),r=i(62012),o=i(50450),h=i(18770),l=i(9807),u=i(27690),p=i(99828);function c(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p(t);if(e){var n=p(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return u(this,i)}}var m=i(46120),d=(m.mlxElement,m.mlxElementInput),g=(m.mlxElementModel,m.mlxElementOutput,m.mlxElementLocakableOutput,m.mlxLabel,m.mlxOscillator,m.mlxConsoleLog,m.mlxSpeech,m.mlxAudioInput,m.mlxFFTSpectrum,m.mlxTextInput,i(23671)),v=function(t){"use strict";l(i,t);var e=c(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="VideoCapture",s.title="Video Capture",s.inType="none",s.outType="image",s.replaceImage=null,s.contentAspectRatio=16/9,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.contentW=320,s.contentH=s.contentW/s.contentAspectRatio,s.contentScale=1,s.setElementSizeByContentSize(),s.resizable=!0,s.flip=!0,s.cameraMode=0,s.facingMode="user",s.needMouse=!0,s.autoMaximize=!1,s.createElementMenu(),s.isVideoCaptureReady=!1,s.doCaptureScreen=!1,s.constraints={audio:!1,video:{facingMode:s.facingMode}},/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(s.constraints.video.aspectRatio=16/9),s.doCreateVideoCapture(),console.log("video capture ready"),s.flipButton=s.mlx.createButton(o(s),"Camera",(function(){s.switchCamera(!s.cameraMode)}),10+s.mlx.mlxPadding,s.h-10-22-s.mlx.mlxPadding,80,22),s.flipButton.border=!0,s.flipButton.hidden=!0,s.outputIsReady=!0,s.busy=!1,console.log(">>",s.p5.loadSound),console.log(">>",s.p5.loadSound),console.log(">>",s.p5.soundFormats),s}return r(i,[{key:"doCreateVideoCapture",value:function(){var t=this;this.ready&&this.videoCapture.remove();try{this.ready=!1,this.videoCapture=this.mlx.p5.createCapture(this.constraints,(function(){t.isVideoCaptureReady=!0,t.videoRawWidth=t.videoCapture._pixelsState.width,t.videoRawHeight=t.videoCapture._pixelsState.height,t.contentAspectRatio=t.videoRawWidth/t.videoRawHeight,t.videoWidth=t.w-2*t.mlx.mlxPadding,t.videoHeight=t.videoWidth/t.contentAspectRatio,t.videoCapture.size(t.videoWidth,t.videoHeight),t.videoCapture.hide(),t.contentW=t.videoWidth,t.contentH=t.videoHeight,t.setElementSizeByContentSize(),t.isMaximize&&t.scaleContentToFillSize(!1),t.isFullScreen?(t.flipButton.yy=t.p5.height-10-22-t.mlx.mlxPadding,t.flipButton.hidden=!1):t.flipButton.yy=t.h-10-22-t.mlx.mlxPadding,t.autoMaximize&&t.enterMaximize(),t.output=t.videoCapture,t.ready=!0}))}catch(e){console.log("ERROR",e),this.loading.html("ERROR: "+e),this.ready=!1}}},{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.flip=this.flip,t.autoMaximize=this.autoMaximize,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.flip=t.flip,this.flipMenu.value=this.flip,t.autoMaximize?this.autoMaximize=t.autoMaximize:this.autoMaximize=!1,this.autoMaxMenu.value=this.autoMaximize,this.autoMaximize&&(this.lockMaximize=!0,this.enterMaximize())}},{key:"setVideoCaptureSize",value:function(){this.videoWidth=this.contentW,this.videoHeight=this.contentH,this.videoCapture.size(this.videoWidth,this.videoHeight),console.log(this.videoWidth,this.videoHeight)}},{key:"resizeByMouse",value:function(){h(p(i.prototype),"resizeByMouse",this).call(this),this.setVideoCaptureSize(),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding}},{key:"endFullScreen",value:function(){h(p(i.prototype),"endFullScreen",this).call(this),this.setVideoCaptureSize(),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!0}},{key:"enterFullScreen",value:function(){h(p(i.prototype),"enterFullScreen",this).call(this),this.setVideoCaptureSize(),this.isFullScreen?this.flipButton.yy=this.p5.height-10-22-this.mlx.mlxPadding:this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.doCreateVideoCapture()}},{key:"enterMaximize",value:function(){h(p(i.prototype),"enterMaximize",this).call(this),this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!1}},{key:"exitMaximize",value:function(){h(p(i.prototype),"exitMaximize",this).call(this),this.isMaximize=!1,this.maxMenu.value=!1,this.flipButton.yy=this.h-10-22-this.mlx.mlxPadding,this.flipButton.hidden=!0}},{key:"captureScreen",value:function(){this.captureCountdown=2999,this.captureBeepCountdown=0,this.doCaptureScreen=!0}},{key:"switchCamera",value:function(t){this.cameraMode=t,0==t?(this.face="user",this.constraints={audio:!1,video:{facingMode:this.face}},this.flip=!0):(this.face="environment",this.constraints={audio:!1,video:{facingMode:{exact:this.face}}},this.flip=!1),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(this.constraints.video.aspectRatio=16/9),this.doCreateVideoCapture()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Full screen",(function(e){t.hideMenu(),t.enterFullScreen()})),this.maxMenu=e.addCheckedMenu("Maximize",this.isMaximize,(function(e,i){t.hideMenu(),t.isMaximize=i,t.isMaximize?t.enterMaximize():t.exitMaximize()})),this.autoMaxMenu=e.addCheckedMenu("Auto Maximize",this.autoMaximize,(function(e,i){t.hideMenu(),t.autoMaximize=i})),e.addSeparator(),e.addCommand("Capture Canvas",(function(e){t.hideMenu(),t.captureScreen()})),e.addSeparator(),this.cameraMenu=e.addSelectMenu(["Front camera","Back camera"],this.cameraMode,(function(e,i){t.hideMenu(),t.switchCamera(i)})),e.addSeparator(),this.flipMenu=e.addCheckedMenu("Flip",this.flip,(function(e,i){t.hideMenu(),t.flip=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"remove",value:function(){this.videoCapture&&(this.videoCapture.stop(),this.isVideoCaptureReady&&this.videoCapture.remove(),this.videoCapture=null),h(p(i.prototype),"remove",this).call(this)}},{key:"doProcess",value:function(){return this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0,!0}},{key:"doDraw",value:function(t){this.backgroundImage&&t.image(this.backgroundImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH),this.replaceImage?t.image(this.replaceImage,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH):t.image(this.videoCapture,this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH)}},{key:"draw",value:function(t){if(h(p(i.prototype),"draw",this).call(this,t),this.ready&&(this.noDraw||(t.push(),this.flip&&(t.translate(2*(this.x+this.contentX)+this.contentW,0),t.scale(-1,1)),this.doDraw(t),t.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(t,this.extraDraw),this.doCaptureScreen))if(this.captureCountdown-=t.deltaTime,this.captureCountdown>0)this.captureBeepCountdown-=t.deltaTime,this.captureBeepCountdown<0&&(null!=this.beepSound&&this.beepSound.isLoaded()&&this.beepSound.play(),this.captureBeepCountdown=1e3),t.push(),t.fill(255),t.textSize(40),t.text(t.floor(this.captureCountdown/1e3)+1,this.x+this.contentX+this.contentW-50,this.y+this.contentY,50,50),t.pop();else{null!=this.shutterSound&&this.shutterSound.isLoaded()&&this.shutterSound.play(),t.push(),t.resetMatrix(),t.translate(0,0),t.scale(1);var e=t.createGraphics(t.width,t.height);this.noDraw||(e.push(),this.flip&&(e.translate(2*(this.x+this.contentX)+this.contentW,0),e.scale(-1,1)),this.doDraw(e),e.pop()),this.extraDraw&&this.extraDraw.doExtraDraw(e,this.extraDraw),e.get(this.x+this.contentX,this.y+this.contentY,this.contentW,this.contentH).save("myVideoCanvas.jpg"),t.pop(),this.doCaptureScreen=!1}}},{key:"mousePressed",value:function(){h(p(i.prototype),"mousePressed",this).call(this),3==this.p5.touches.length&&this.exitMaximize()}}]),i}(d),f=function(t){"use strict";l(i,t);var e=c(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="DrawCanvas",s.title="Draw Canvas",s.inType="none",s.outType="image",s.createElementMenu(),s.needMouse=!0,s.canvasSize=280,s.offScreenX=s.mlx.mlxPadding,s.offScreenY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.offScreen=s.mlx.createCanvas(o(s),s.offScreenX,s.offScreenY,s.canvasSize,s.canvasSize),s.canvas=s.offScreen.offScreen,s.canvas.strokeWeight(10),s.canvas.stroke(0),s.w=s.canvasSize+2*s.mlx.mlxPadding,s.h=s.canvasSize+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding,s.output=s.canvas,s.ready=!0,s.currentData=!1,s}return r(i,[{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Clear",(function(e){t.hideMenu(),t.canvas.background(255)})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return this.alreadyRunInLoop=!0,this.outputIsReady=!0,!0}},{key:"draw",value:function(t){h(p(i.prototype),"draw",this).call(this,t)}},{key:"mousePressed",value:function(){return this.busy=!0,console.log("Mouse Pressed"),this.pmouseX=this.mlx.mouseX-this.offScreenX-this.x,this.pmouseY=this.mlx.mouseY-this.offScreenY-this.y,this.canvas.line(this.pmouseX-1,this.pmouseY,this.pmouseX,this.pmouseY),!1}},{key:"mouseReleased",value:function(){this.busy=!1}},{key:"mouseMoved",value:function(){}},{key:"mouseDragged",value:function(){var t=this.mlx.mouseX-this.offScreenX-this.x,e=this.mlx.mouseY-this.offScreenY-this.y;this.canvas.line(this.pmouseX,this.pmouseY,t,e),this.pmouseX=t,this.pmouseY=e}}]),i}(d),x=function(t){"use strict";l(i,t);var e=c(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="2DCoord",s.inType="none",s.outType="tensor",console.log("2D Coord"),s.title="2D Point Generator",s.createElementMenu(),s.needMouse=!0,s.canvasSize=280,s.isTraining=!1,s.needMouse=!0,s.needResults=s.getResults,s.trainingData=[],s.activeData=null,s.currentLabel="A",s.w=s.canvasSize+2*s.mlx.mlxPadding,s.h=s.canvasSize+s.mlx.mlxCaptionHeight+2*s.mlx.mlxPadding+32,s.trainCheckbox=s.mlx.createCheckBox(o(s),"train",(function(t,e){s.isTraining=e,s.isTraining||s.createBackgroundMap()}),s.isTraining,s.mlx.mlxPadding,s.mlx.mlxCaptionHeight+10,100,20),s.trainCheckbox.showBox=!0,s.dropdownLabel=s.mlx.createDropdownButton(o(s),"A",["A","B","C","D","E"],(function(t,e){s.currentLabel=e}),s.w-s.mlx.mlxPadding-60,s.mlx.mlxCaptionHeight+10,60,20),s.offScreenX=s.mlx.mlxPadding,s.offScreenY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding+32,s.offScreen=s.mlx.createCanvas(o(s),s.offScreenX,s.offScreenY,s.canvasSize,s.canvasSize),s.canvas=s.offScreen.offScreen,s.canvas.strokeWeight(1),s.canvas.stroke(0),s.canvas.fill(0),s.color={A:s.p5.color(255,192,192),B:s.p5.color(192,255,192),C:s.p5.color(192,192,255),D:s.p5.color(192,255,255),E:s.p5.color(255,255,192)},s.resenndTrainingData=!1,s.sendingTrainingDataIndex=-1,s.data=[],s.output=[],s.ready=!0,s.backgroundMap=s.p5.createGraphics(s.canvasSize,s.canvasSize),s.backgroundMap.background(255),s}return r(i,[{key:"getResults",value:function(t){this.activeData&&t.data[0]===this.activeData.data[0]&&t.data[1]===this.activeData.data[1]&&(this.activeData.label=t.label,t.distances&&(this.activeData.distances=t.distances))}},{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.trainingData=this.trainingData,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.trainingData=t.trainingData}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Clear",(function(e){t.hideMenu(),t.trainingData=[]})),e.addSeparator(),e.addCommand("Load data...",(function(e){t.hideMenu(),showOpenDialog(t.type,"data",(function(e){console.log("Open",e),e&&e.data&&(t.trainingData=JSON.parse(e.data))}))})),e.addCommand("Save data...",(function(e){t.hideMenu(),showSaveDialog(t.type,"data",t.trainingData,!1,(function(){console.log("Saved")}))})),e.addSeparator(),e.addCommand("Resend Training Data",(function(e){t.hideMenu(),t.resendTrainingData=!0,t.sendingTrainingDataIndex=0})),e.addCommand("Update Inference Map",(function(e){t.hideMenu(),t.createBackgroundMap()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"refresh",value:function(){this.createBackgroundMap()}},{key:"createBackgroundMap",value:function(){var t,e,i=this;!this.isTraining&&this.outElement&&this.outElement.classify&&function(){var s=10;i.backgroundMap.noStroke(),i.backgroundMap.background(255);var n=[];for(t=0;t<i.canvasSize;t+=10)for(e=0;e<i.canvasSize;e+=10)n.push([e+5-i.canvasSize/2,t+5-i.canvasSize/2]);if(i.outElement.classifyMultiple)i.outElement.classifyMultiple(n,(function(t){i.backgroundMap.push();for(var e=0,n=0;n<i.canvasSize;n+=10)for(var a=0;a<i.canvasSize;a+=10)i.backgroundMap.fill(i.color[t[e][0].label]),i.backgroundMap.rect(a,n,s,s),e++;i.backgroundMap.pop()}));else for(var a in n){var r=n[a];i.outElement.classify(r,(function(t){var e=t.data[0]+i.canvasSize/2-5,n=t.data[1]+i.canvasSize/2-5;i.backgroundMap.fill(i.color[t.label]),i.backgroundMap.rect(e,n,s,s)}))}}()}},{key:"doProcess",value:function(){if(this.resenndTrainingData)if(this.sendingTrainingDataIndex>=this.trainingData.length)this.resenndTrainingData=!1;else{var t=this.trainingData[this.sendingTrainingDataIndex++];this.output=t,this.outputIsReady=!0}return this.busy=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){if(h(p(i.prototype),"draw",this).call(this,t),this.canvas.background(255),this.canvas.textSize(10),this.isTraining||this.canvas.image(this.backgroundMap,0,0),this.canvas.push(),this.canvas.translate(this.canvasSize/2,this.canvasSize/2),this.activeData){var e=this.activeData,s=e.data[0],n=e.data[1];if(e.distances)for(var a in e.distances){var r=e.distances[a];this.canvas.strokeWeight(5),this.canvas.stroke(this.color[r.label]),this.canvas.line(s,n,r.rdata[0],r.rdata[1]),this.canvas.strokeWeight(1),this.canvas.stroke(0),this.canvas.line(s,n,r.rdata[0],r.rdata[1])}}for(var o in this.trainingData){var l=this.trainingData[o],u=l.data[0],c=l.data[1];this.canvas.fill(this.color[l.label]),this.canvas.stroke(0),this.canvas.ellipse(u,c,16,16),this.canvas.noStroke(),this.canvas.fill(0),this.canvas.textAlign(this.p5.CENTER,this.p5.CENTER),this.canvas.text(l.label,u,c)}if(this.activeData){var m=this.activeData,d=m.data[0],g=m.data[1];m.label&&(this.canvas.fill(this.color[m.label]),this.canvas.stroke(0),this.canvas.ellipse(d,g,16,16),this.canvas.noStroke(),this.canvas.fill(0),this.canvas.textAlign(this.p5.CENTER,this.p5.CENTER),this.canvas.text(m.label,d,g))}this.canvas.pop()}},{key:"mousePressed",value:function(){if(!h(p(i.prototype),"mousePressed",this).call(this))return!1;if(this.mlx.mouseX>=this.x+this.offScreenX&&this.mlx.mouseX<=this.x+this.offScreenX+this.canvasSize&&this.mlx.mouseY>=this.y+this.offScreenY&&this.mlx.mouseY<=this.y+this.offScreenY+this.canvasSize){this.pmouseX=this.mlx.mouseX-this.offScreenX-this.x,this.pmouseY=this.mlx.mouseY-this.offScreenY-this.y;var t=this.mlx.mouseX-this.offScreenX-this.x-this.canvasSize/2,e=this.mlx.mouseY-this.offScreenY-this.y-this.canvasSize/2;return this.isTraining?(this.output={label:this.currentLabel,data:[t,e]},this.trainingData.push(this.output)):(this.output=[t,e],this.activeData={label:null,data:[t,e]},this.data.push(this.activeData)),this.outElement&&(this.outputIsReady=!0),!1}return!0}},{key:"mouseReleased",value:function(){this.activeData&&(this.activeData=null)}},{key:"mouseMoved",value:function(){}},{key:"mouseDragged",value:function(){if(!h(p(i.prototype),"mousePressed",this).call(this))return!1;if(this.mlx.mouseX>=this.x+this.offScreenX&&this.mlx.mouseX<=this.x+this.offScreenX+this.canvasSize&&this.mlx.mouseY>=this.y+this.offScreenY&&this.mlx.mouseY<=this.y+this.offScreenY+this.canvasSize){this.pmouseX=this.mlx.mouseX-this.offScreenX-this.x,this.pmouseY=this.mlx.mouseY-this.offScreenY-this.y;var t=this.mlx.mouseX-this.offScreenX-this.x-this.canvasSize/2,e=this.mlx.mouseY-this.offScreenY-this.y-this.canvasSize/2;return this.isTraining||this.activeData&&(this.activeData.data[0]=t,this.activeData.data[1]=e,this.output=[t,e],this.outputIsReady=!0),!1}return!0}}]),i}(d),y=function(t){"use strict";l(i,t);var e=c(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="CSVFile",s.inType="none",s.outType="tensor",s.title="CSV File Input",s.createElementMenu(),s.needMouse=!0,s.h=110,s.w=200,s.isTraining=!0,s.resendTrainingData=!0,s.trainingData=[],s.activeRow=null,s.contentX=0,s.contentY=s.mlx.mlxCaptionHeight,s.contentW=s.w-1,s.contentH=s.h-s.mlx.mlxCaptionHeight,s.divX=s.contentX+1,s.divY=s.contentY,s.divW=s.contentW-1,s.divH=s.contentH-28,s.div=t.p5.createDiv("Drop CSV here!"),s.div.size(s.divW,s.divH),s.div.position(s.x+s.divX,s.y+s.divY+s.mlx.mlxNavBarHeight),s.div.style("background-color","#CCC"),s.div.style("text-align","center"),s.div.style("padding","5px"),s.div.style("user-select","none"),s.div.elt.addEventListener("dragover",s.dragHover.bind(o(s))),s.div.elt.addEventListener("dragleave",s.dragOut.bind(o(s))),s.div.elt.addEventListener("drop",s.drop.bind(o(s))),s.label=s.mlx.createLabel(o(s),"waiting file ...",10,s.h-24-3,s.w-20,24),s.trainCheckbox=s.mlx.createCheckBox(o(s),"train",(function(t,e){s.isTraining=e}),s.isTraining,s.w-60,s.h-20-6,50,20),s.trainCheckbox.showBox=!0,s.data=[],s.output=[],s.ready=!1,s}return r(i,[{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.trainingData=this.trainingData,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.trainingData=t.trainingData}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();e.addCommand("Clear",(function(e){t.hideMenu(),t.trainingData=[],t.activateUI()})),e.addSeparator(),e.addCommand("Load data...",(function(e){t.hideMenu(),showOpenDialog(t.type,"data",(function(e){console.log("Open",e),e&&e.data&&(t.trainingData=JSON.parse(e.data))})),t.activateUI()})),e.addCommand("Save data...",(function(e){t.hideMenu(),showSaveDialog(t.type,"data",t.trainingData,!1,(function(){console.log("Saved")})),t.activateUI()})),e.addSeparator(),e.addCommand("Resend Data",(function(e){t.hideMenu(),t.resendTrainingData=!0,t.activateUI()})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"inactivateUI",value:function(){this.div.style("display","none")}},{key:"activateUI",value:function(){this.div.style("display","block")}},{key:"dragHover",value:function(t){this.div.style("border","3px solid darkseagreen"),t.stopPropagation(),t.preventDefault()}},{key:"dragOut",value:function(t){this.div.style("border","none"),t.stopPropagation(),t.preventDefault()}},{key:"readFile",value:function(t){return new Promise((function(e,i){t.file((function(t){var s=new FileReader;s.onload=function(t){e(t.target.result)},s.onerror=function(t){i(t)},s.readAsText(t,"UTF-8")}),(function(t){return i(t)}))}))}},{key:"drop",value:function(t){var e=this;this.div.style("border","none"),this.data=[],this.output=[],this.trainingData=[],t.stopPropagation(),t.preventDefault();var i=this,s=t.dataTransfer.items;if(1==s.length){var n=s[0].webkitGetAsEntry();n&&n.isFile&&this.readFile(n).then((function(t){return e.label.setText("Loaded file : "+n.name),g({trim:!0,checkType:!0}).fromString(t)})).then((function(t){var i=Object.keys(t[0]),s=i[i.length-1],n=t.map((function(t){return{label:t[s],data:Object.values(t).slice(0,-1)}}));e.trainingData=n,e.div.style("text-align","left"),e.div.html("Total Cols : ".concat(i.length,"<br>\n                            Target Col : ").concat(s)),e.ready=!0})).catch((function(t){e.div.html("Wrong format CSV"),i.label.setText("Err:"+t.message)}))}}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.divX,s=this.y+this.divY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale)}},{key:"update",value:function(){h(p(i.prototype),"update",this).call(this),this.inElement&&this.inElement.outElement||this.ready&&this.label.setText("Ready"),this.setPosition(this.x,this.y)}},{key:"doProcess",value:function(){return this.resendTrainingData&&this.outElement&&(this.isTraining?this.output=this.trainingData:this.output=this.trainingData.map((function(t){return t.data})),this.outputIsReady=!0,this.resendTrainingData=!1),this.busy=!1,this.alreadyRunInLoop=!0,!0}},{key:"draw",value:function(t){h(p(i.prototype),"draw",this).call(this,t)}}]),i}(d),E=function(t){"use strict";l(i,t);var e=c(i);function i(t){var s;return a(this,i),(s=e.call(this,t)).category="Input",s.type="Image",s.title="Image",s.inType="none",s.outType="image",s.imageName="",s.autoResize=!0,s.resizable=!0,s.createElementMenu(),s.replaceImage=null,s.backgroundImage=null,s.contentX=s.mlx.mlxPadding,s.contentY=s.mlx.mlxCaptionHeight+s.mlx.mlxPadding,s.contentW=200,s.contentH=200,s.contentAspectRatio=1,s.divX=s.contentX,s.divY=s.contentY,s.divW=s.contentW,s.divH=s.contentH,s.setElementSizeByContentSize(),s.h+=18,s.div=t.p5.createDiv(),s.div.size(s.divW,s.divH),s.div.position(s.x+s.divX,s.y+s.divY+s.mlx.mlxNavBarHeight),s.div.style("background-color","#FF000000"),s.div.style("text-align","center"),s.div.style("font-size","x-small"),s.div.style("display","flex"),s.div.style("vertical-align","text-bottom"),s.div.style("align-items","center"),s.div.html("<p style='margin-top:auto; margin-left:auto; margin-right:auto; margin-bottom:10px;'>Drop file here...</p>"),s.div.drop((function(t){console.log("Got file"),"image"===t.type?(s.output=null,s.outputIsReady=!1,s.img=null,s.div.html(""),s.imageName=t.name,s.labelName.setText(s.imageName),s.img=s.p5.createImg(t.data,"test").hide(),s.divW=0,s.divH=0,s.imgAspectRatio=1,s.outElement&&s.outElement.clearResults()):console.log("Not an image file!")})),s.labelName=s.mlx.createLabel(o(s),s.imageName,s.mlx.mlxPadding,s.divY+s.divH,s.w-2*s.mlx.mlxPadding,24),s.ready=!0,s.busy=!1,s}return r(i,[{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.autoResize=this.autoResize,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.autoResize=t.autoResize,this.autoResizeMenu.value=this.autoResize,this.setContentSizeByElementWidth(),this.adjustDivSize()}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.autoResizeMenu=e.addCheckedMenu("Auto resize",this.autoResize,(function(e,i){t.hideMenu(),t.autoResize=i,t.divW=0,t.divH=0})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"doProcess",value:function(){return!!this.img&&(this.busy=!1,this.output=this.img,this.outputIsReady=!0,this.alreadyRunInLoop=!0,!0)}},{key:"update",value:function(){h(p(i.prototype),"update",this).call(this),this.setPosition(this.x,this.y),0==this.divW&&this.img&&this.img.width&&this.img.height&&(this.imgAspectRatio=this.img.width/this.img.height,this.autoResize?this.contentAspectRatio=this.imgAspectRatio:this.contentAspectRatio=1,this.contentH=this.contentW/this.contentAspectRatio,this.contentScale=0,this.divW=this.contentW,this.divH=this.contentH,this.div.size(this.divW,this.divH),this.div.position(this.x+this.contentX,this.y+this.contentY+this.mlx.mlxNavBarHeight),this.labelName.yy=this.divY+this.divH,this.setElementSizeByContentSize(),this.h+=18),this.img}},{key:"setPosition",value:function(t,e){this.x=t,this.y=e;var i=this.x+this.divX,s=this.y+this.divY+this.mlx.mlxNavBarHeight/this.mlx.userScale;i=i+this.mlx.userTranslateX+this.mlx.userScaleX/this.mlx.userScale-this.mlx.userScaleX,s=s+this.mlx.userTranslateY+this.mlx.userScaleY/this.mlx.userScale-this.mlx.userScaleY,this.div.position(i*this.mlx.userScale,s*this.mlx.userScale),this.div.size(this.divW*this.mlx.userScale,this.divH*this.mlx.userScale)}},{key:"resizeByMouse",value:function(){h(p(i.prototype),"resizeByMouse",this).call(this),this.h+=18,this.adjustDivSize()}},{key:"adjustDivSize",value:function(){this.divW=this.contentW,this.divH=this.contentH,this.labelName.yy=this.divY+this.divH,this.labelName.resize(this.w-2*this.mlx.mlxPadding,this.labelName.h),this.div.size(this.divW,this.divH),this.div.position(this.x+this.contentX,this.y+this.contentY)}},{key:"draw",value:function(t){h(p(i.prototype),"draw",this).call(this,t),t.fill(211),t.noStroke(),this.backgroundImage?t.image(this.backgroundImage,this.x+this.divX,this.y+this.divY,this.divW,this.divH):t.rect(this.x+this.divX,this.y+this.divY,this.divW,this.divH);var e=this.img;if(this.replaceImage&&(e=this.replaceImage),e){var s=0,n=0;if(!this.noDraw){if(t.push(),e.width/this.divW>e.height/this.divH){var a=this.divW/this.imgAspectRatio,r=this.divW/e.width;n=(this.divH-a)/2,t.translate(0,0+n),t.scale(r),this.contentScale=r,t.image(e,(this.x+this.contentX)/this.contentScale,(this.y+this.contentY)/this.contentScale)}else{var o=this.imgAspectRatio*this.divH,l=this.divH/e.height;s=(this.divW-o)/2,t.translate(0+s,0),t.scale(l),this.contentScale=l,t.image(e,(this.x+this.contentX)/this.contentScale,(this.y+this.contentY)/this.contentScale)}t.pop()}this.extraDraw&&this.divW&&this.contentScale&&(t.push(),this.extraDraw.doExtraDraw(t,this.extraDraw),t.pop())}}}]),i}(d),_=function(t){"use strict";l(i,t);var e=c(i);function i(t){var r;return a(this,i),(r=e.call(this,t)).category="Input",r.type="VideoPixels",r.needMouse=!0,r.inType="none",r.outType="tensor",r.title="Video Pixels",r.videoSize=10,r.contentAspectRatio=1,r.contentX=r.mlx.mlxPadding,r.contentY=r.mlx.mlxCaptionHeight+r.mlx.mlxPadding,r.contentW=280,r.contentH=r.contentW/r.contentAspectRatio,r.contentScale=1,r.setElementSizeByContentSize(),r.h+=45,r.slider=r.mlx.createHorizontalSlider(o(r),(function(t){r.videoSize=r.p5.floor(t),console.log(r.videoSize)}),r.videoSize,5,64,r.contentX,r.mlx.mlxCaptionHeight+r.contentH+2*r.mlx.mlxPadding,r.contentW,32),r.resizable=!1,r.flip=!0,r.createElementMenu(),r.constraints={audio:!1,video:{facingMode:"user"}},window.peer=new Peer,window.conn=void 0,peer.on("open",function(){var t=n(s.mark((function t(e){return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.peerId=e,console.log("ready peer Id",e),conn=peer.connect("c351eb39-1ca1-45d2-93d5-77e9c7993c68",{reliable:!0}),conn.on("open",(function(){console.log("Connected to: "+conn.peer),window.conn=conn}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.videoCapture=t.p5.createCapture(r.constraints,(function(){console.log("video capture ready"),r.videoRawWidth=r.videoCapture._pixelsState.width,r.videoRawHeight=r.videoCapture._pixelsState.height,r.contentAspectRatio=r.videoRawWidth/r.videoRawHeight,r.videoWidth=r.w-2*r.mlx.mlxPadding,r.videoHeight=r.videoWidth/r.contentAspectRatio,r.videoCapture.size(r.videoSize,r.videoSize),r.videoCapture.hide(),r.contentW=r.videoWidth,r.contentH=r.videoHeight,r.output=r.videoCapture,r.outputIsReady=!0,r.ready=!0,r.busy=!1})),r}return r(i,[{key:"save",value:function(){var t=h(p(i.prototype),"save",this).call(this);return t.flip=this.flip,t.videoSize=this.videoSize,t}},{key:"load",value:function(t){h(p(i.prototype),"load",this).call(this,t),this.flip=t.flip,this.videoSize=t.videoSize,this.flipMenu.value=this.flip}},{key:"createElementMenu",value:function(){var t=this,e=this._createMenu();this.flipMenu=e.addCheckedMenu("Flip",this.flip,(function(e,i){t.hideMenu(),t.flip=i})),e.addSeparator(),e.addCommand("Delete",(function(e){t.hideMenu(),t.mlx.removeElement(t)}))}},{key:"remove",value:function(){this.videoCapture&&(this.videoCapture.remove(),this.videoCapture=null),h(p(i.prototype),"remove",this).call(this)}},{key:"doProcess",value:function(){this.busy=!0,this.outputIsReady=!1,this.videoData=[];for(var t=0;t<this.videoCapture.height;t++){for(var e=[],i=0;i<this.videoCapture.width;i++){var s=4*(i+t*this.videoCapture.width),n=this.videoCapture.pixels[s+0],a=this.videoCapture.pixels[s+1],r=this.videoCapture.pixels[s+2],o=[];o.push(n/255),o.push(a/255),o.push(r/255),e.push(o)}this.videoData.push(e)}return this.output=this.videoData,this.busy=!1,this.outputIsReady=!0,this.alreadyRunInLoop=!0,console.log(this.videoCapture.width,this.videoCapture.height,this.videoCapture.pixels),window.conn&&window.conn.send(JSON.stringify({pixels:Array.from(this.videoCapture.pixels)})),!0}},{key:"draw",value:function(t){if(h(p(i.prototype),"draw",this).call(this,t),this.ready){t.push(),this.flip&&(t.translate(2*(this.x+this.contentX)+this.contentW,0),t.scale(-1,1));var e=this.contentW/this.videoSize;this.videoCapture.width==this.videoSize&&this.videoCapture.height==this.videoSize||this.videoCapture.size(this.videoSize,this.videoSize),this.videoCapture.loadPixels();for(var s=0;s<this.videoCapture.width;s++)for(var n=0;n<this.videoCapture.height;n++){var a=4*(s+n*this.videoCapture.width),r=this.videoCapture.pixels[a+0],o=this.videoCapture.pixels[a+1],l=this.videoCapture.pixels[a+2];this.p5.noStroke(),this.p5.fill(r,o,l),this.p5.rect(this.x+this.contentX+s*e,this.y+this.contentY+n*e,e,e)}t.pop(),this.extraDraw&&this.extraDraw.doExtraDraw(t,this.extraDraw)}}}]),i}(d);t.exports={mlxVideoCapture:v,mlxDrawCanvas:f,mlxMouseInput:x,mlxImage:E,mlxVideoPixels:_,mlxCSVFileInput:y}},44068:function(t,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mlblock",function(){return i(13212)}])},89214:function(){},27790:function(){},52361:function(){},94616:function(){},6567:function(){}},function(t){t.O(0,[774,808,764,450,653,888,179],(function(){return e=44068,t(t.s=e);var e}));var e=t.O();_N_E=e}]);